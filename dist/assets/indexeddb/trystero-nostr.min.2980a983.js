!function(){var e=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire55a5;e.register("1UDrq",(function(n,t){var r,a;r=n.exports,a=function(){return Dn},Object.defineProperty(r,"joinRoom",{get:a,set:undefined,enumerable:!0,configurable:!0});var i,o,u,c,f,s,l,d,h,v,y,p,g,m,w,b,E=e("hnmIs"),k=e("9Klpk"),x=e("3bWnf"),A=e("eT7f3"),S=e("kb0qF"),_=e("bgoEC"),I=e("7j4mF"),P=e("5ENmm"),B=e("6Wo7Q"),T=e("rJmE6"),H=e("fSF4h"),U=e("bWNdT"),R=e("32Euv"),C=Object.freeze({__proto__:null,default:{}}),D=BigInt(0),z=BigInt(1),O=BigInt(2),N=BigInt(3),L=BigInt(8),j=Object.freeze({a:D,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:z,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),M=function(e,n){return(e+n/O)/n},Z=BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),V=function(e){var n=j.n,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-z*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),a=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=t,o=BigInt("0x100000000000000000000000000000000"),u=M(i*e,n),c=M(-r*e,n),f=pe(e-u*t-c*a,n),s=pe(-u*r-c*i,n),l=f>o,d=s>o;if(l&&(f=n-f),d&&(s=n-s),f>o||s>o)throw Error("splitScalarEndo: Endomorphism failed, k="+e);return{k1neg:l,k1:f,k2neg:d,k2:s}},q=32;function W(e){var n=j.a,t=j.b,r=pe(e*e),a=pe(r*e);return pe(a+n*e+t)}var K=j.a===D,F=function(e){"use strict";(0,S.default)(t,e);var n=(0,U.default)(t);function t(e){return(0,k.default)(this,t),n.call(this,e)}return t}((0,H.default)(Error));function J(e){if(!(e instanceof G))throw new TypeError("JacobianPoint expected")}var G=function(){"use strict";function e(n,t,r){(0,k.default)(this,e),this.x=n,this.y=t,this.z=r}return(0,x.default)(e,[{key:"equals",value:function(e){J(e);var n=this,t=n.x,r=n.y,a=n.z,i=e.x,o=e.y,u=e.z,c=pe(a*a),f=pe(u*u),s=pe(t*f),l=pe(i*c),d=pe(pe(r*u)*f),h=pe(pe(o*a)*c);return s===l&&d===h}},{key:"negate",value:function(){return new e(this.x,pe(-this.y),this.z)}},{key:"double",value:function(){var n=this,t=n.x,r=n.y,a=n.z,i=pe(t*t),o=pe(r*r),u=pe(o*o),c=t+o,f=pe(O*(pe(c*c)-i-u)),s=pe(N*i),l=pe(s*s),d=pe(l-O*f);return new e(d,pe(s*(f-d)-L*u),pe(O*r*a))}},{key:"add",value:function(n){J(n);var t=this,r=t.x,a=t.y,i=t.z,o=n.x,u=n.y,c=n.z;if(o===D||u===D)return this;if(r===D||a===D)return n;var f=pe(i*i),s=pe(c*c),l=pe(r*s),d=pe(o*f),h=pe(pe(a*c)*s),v=pe(pe(u*i)*f),y=pe(d-l),p=pe(v-h);if(y===D)return p===D?this.double():e.ZERO;var g=pe(y*y),m=pe(y*g),w=pe(l*g),b=pe(p*p-m-O*w);return new e(b,pe(p*(w-b)-h*m),pe(i*c*y))}},{key:"subtract",value:function(e){return this.add(e.negate())}},{key:"multiplyUnsafe",value:function(n){var t=e.ZERO;if("bigint"==(void 0===n?"undefined":(0,T.default)(n))&&n===D)return t;var r=ye(n);if(r===z)return this;if(!K){for(var a=t,i=this;r>D;)r&z&&(a=a.add(i)),i=i.double(),r>>=z;return a}for(var o=V(r),u=o.k1neg,c=o.k1,f=o.k2neg,s=o.k2,l=t,d=t,h=this;c>D||s>D;)c&z&&(l=l.add(h)),s&z&&(d=d.add(h)),h=h.double(),c>>=z,s>>=z;return u&&(l=l.negate()),f&&(d=d.negate()),d=new e(pe(d.x*Z),d.y,d.z),l.add(d)}},{key:"precomputeWindow",value:function(e){for(var n=K?128/e+1:256/e+1,t=[],r=this,a=r,i=0;i<n;i++){a=r,t.push(a);for(var o=1;o<Math.pow(2,e-1);o++)a=a.add(r),t.push(a);r=a.double()}return t}},{key:"wNAF",value:function(n,t){!t&&this.equals(e.BASE)&&(t=Q.BASE);var r=t&&t._WINDOW_SIZE||1;if(256%r)throw Error("Point#wNAF: Invalid precomputation window, must be power of 2");var a=t&&Y.get(t);a||(a=this.precomputeWindow(r),t&&1!==r&&(a=e.normalizeZ(a),Y.set(t,a)));for(var i=e.ZERO,o=e.BASE,u=1+(K?128/r:256/r),c=Math.pow(2,r-1),f=BigInt(Math.pow(2,r)-1),s=Math.pow(2,r),l=BigInt(r),d=0;d<u;d++){var h=d*c,v=Number(n&f);n>>=l,v>c&&(v-=s,n+=z);var y=h,p=h+Math.abs(v)-1,g=d%2!=0,m=v<0;0===v?o=o.add(X(g,a[y])):i=i.add(X(m,a[p]))}return{p:i,f:o}}},{key:"multiply",value:function(n,t){var r,a,i=ye(n);if(K){var o=V(i),u=o.k1neg,c=o.k1,f=o.k2neg,s=o.k2,l=this.wNAF(c,t),d=l.p,h=l.f,v=this.wNAF(s,t),y=v.p,p=v.f;d=X(u,d),y=new e(pe((y=X(f,y)).x*Z),y.y,y.z),r=d.add(y),a=h.add(p)}else{var g=this.wNAF(i,t);r=g.p,a=g.f}return e.normalizeZ([r,a])[0]}},{key:"toAffine",value:function(n){var t=this,r=t.x,a=t.y,i=t.z,o=this.equals(e.ZERO);null==n&&(n=o?L:me(i));var u=n,c=pe(u*u),f=pe(c*u),s=pe(r*c),l=pe(a*f),d=pe(i*u);if(o)return Q.ZERO;if(d!==z)throw Error("invZ was invalid");return new Q(s,l)}}],[{key:"fromAffine",value:function(n){if(!(n instanceof Q))throw new TypeError("JacobianPoint#fromAffine: expected Point");return n.equals(Q.ZERO)?e.ZERO:new e(n.x,n.y,z)}},{key:"toAffineBatch",value:function(e){var n=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j.P,t=Array(e.length),r=me(e.reduce((function(e,r,a){return r===D?e:(t[a]=e,pe(e*r,n))}),z),n);return e.reduceRight((function(e,r,a){return r===D?e:(t[a]=pe(e*t[a],n),pe(e*r,n))}),r),t}(e.map((function(e){return e.z})));return e.map((function(e,t){return e.toAffine(n[t])}))}},{key:"normalizeZ",value:function(n){return e.toAffineBatch(n).map(e.fromAffine)}}]),e}();function X(e,n){var t=n.negate();return e?t:n}G.BASE=new G(j.Gx,j.Gy,z),G.ZERO=new G(D,z,D);var Y=new WeakMap,Q=function(){"use strict";function e(n,t){(0,k.default)(this,e),this.x=n,this.y=t}return(0,x.default)(e,[{key:"_setWindowSize",value:function(e){this._WINDOW_SIZE=e,Y.delete(this)}},{key:"hasEvenY",value:function(){return this.y%O===D}},{key:"toRawBytes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return de(this.toHex(e))}},{key:"toHex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=ce(this.x);return e?"".concat(this.hasEvenY()?"02":"03").concat(n):"04".concat(n).concat(ce(this.y))}},{key:"toHexX",value:function(){return this.toHex(!0).slice(2)}},{key:"toRawX",value:function(){return this.toRawBytes(!0).slice(1)}},{key:"assertValidity",value:function(){var e="Point is not on elliptic curve",n=this.x,t=this.y;if(!be(n)||!be(t))throw Error(e);var r=pe(t*t);if(pe(r-W(n))!==D)throw Error(e)}},{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y}},{key:"negate",value:function(){return new e(this.x,pe(-this.y))}},{key:"double",value:function(){return G.fromAffine(this).double().toAffine()}},{key:"add",value:function(e){return G.fromAffine(this).add(G.fromAffine(e)).toAffine()}},{key:"subtract",value:function(e){return this.add(e.negate())}},{key:"multiply",value:function(e){return G.fromAffine(this).multiply(e,this).toAffine()}},{key:"multiplyAndAddUnsafe",value:function(n,t,r){var a=G.fromAffine(this),i=t===D||t===z||this!==e.BASE?a.multiplyUnsafe(t):a.multiply(t),o=G.fromAffine(n).multiplyUnsafe(r),u=i.add(o);return u.equals(G.ZERO)?void 0:u.toAffine()}}],[{key:"fromCompressedHex",value:function(n){var t=32===n.length,r=he(t?n:n.subarray(1));if(!be(r))throw Error("Point is not on curve");var a=function(e){var n=j.P,t=BigInt(6),r=BigInt(11),a=BigInt(22),i=BigInt(23),o=BigInt(44),u=BigInt(88),c=e*e*e%n,f=c*c*e%n,s=ge(f,N)*f%n,l=ge(s,N)*f%n,d=ge(l,O)*c%n,h=ge(d,r)*d%n,v=ge(h,a)*h%n,y=ge(v,o)*v%n,p=ge(y,u)*y%n,g=ge(p,o)*v%n,m=ge(g,N)*f%n,w=ge(m,i)*h%n,b=ge(w,t)*c%n,E=ge(b,O);if(E*E%n!==e)throw Error("Cannot find square root");return E}(W(r)),i=(a&z)===z;t?i&&(a=pe(-a)):!(1&~n[0])!==i&&(a=pe(-a));var o=new e(r,a);return o.assertValidity(),o}},{key:"fromUncompressedHex",value:function(n){var t=new e(he(n.subarray(1,33)),he(n.subarray(33,65)));return t.assertValidity(),t}},{key:"fromHex",value:function(e){var n=ve(e),t=n.length,r=n[0];if(32===t)return this.fromCompressedHex(n);if(33===t&&(2===r||3===r))return this.fromCompressedHex(n);if(65===t&&4===r)return this.fromUncompressedHex(n);throw Error("Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not "+t)}},{key:"fromPrivateKey",value:function(n){return e.BASE.multiply(Ee(n))}},{key:"fromSignature",value:function(n,t,r){var a=function(e){if(e instanceof ne)return e.assertValidity(),e;try{return ne.fromDER(e)}catch(n){return ne.fromCompact(e)}}(t),i=a.r,o=a.s;if(![0,1,2,3].includes(r))throw Error("Cannot recover: invalid recovery bit");var u=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=function(e){var n=8*e.length-256,t=he(e);return n>0?t>>BigInt(n):t}(e);if(n)return t;var r=j.n;return t>=r?t-r:t}(ve(n)),c=j.n,f=2===r||3===r?i+c:i,s=me(f,c),l=pe(-u*s,c),d=pe(o*s,c),h=1&r?"03":"02",v=e.fromHex(h+ce(f)),y=e.BASE.multiplyAndAddUnsafe(v,l,d);if(!y)throw Error("Cannot recover signature: point at infinify");return y.assertValidity(),y}}]),e}();function $(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function ee(e){if(e.length<2||2!==e[0])throw Error("Invalid signature integer tag: "+ae(e));var n=e[1],t=e.subarray(2,n+2);if(!n||t.length!==n)throw Error("Invalid signature integer: wrong length");if(0===t[0]&&t[1]<=127)throw Error("Invalid signature integer: trailing length");return{data:he(t),left:e.subarray(n+2)}}Q.BASE=new Q(j.Gx,j.Gy),Q.ZERO=new Q(D,D);var ne=function(){"use strict";function e(n,t){(0,k.default)(this,e),this.r=n,this.s=t,this.assertValidity()}return(0,x.default)(e,[{key:"assertValidity",value:function(){var e=this.r,n=this.s;if(!we(e))throw Error("Invalid Signature: r must be 0 < r < n");if(!we(n))throw Error("Invalid Signature: s must be 0 < s < n")}},{key:"hasHighS",value:function(){var e=j.n>>z;return this.s>e}},{key:"normalizeS",value:function(){return this.hasHighS()?new e(this.r,pe(-this.s,j.n)):this}},{key:"toDERRawBytes",value:function(){return de(this.toDERHex())}},{key:"toDERHex",value:function(){var e=$(se(this.s)),n=$(se(this.r)),t=e.length/2,r=n.length/2,a=se(t),i=se(r);return"30".concat(se(r+t+4),"02").concat(i).concat(n,"02").concat(a).concat(e)}},{key:"toRawBytes",value:function(){return this.toDERRawBytes()}},{key:"toHex",value:function(){return this.toDERHex()}},{key:"toCompactRawBytes",value:function(){return de(this.toCompactHex())}},{key:"toCompactHex",value:function(){return ce(this.r)+ce(this.s)}}],[{key:"fromCompact",value:function(n){var t=n instanceof Uint8Array,r="Signature.fromCompact";if("string"!=typeof n&&!t)throw new TypeError(r+": Expected string or Uint8Array");var a=t?ae(n):n;if(128!==a.length)throw Error(r+": Expected 64-byte hex");return new e(le(a.slice(0,64)),le(a.slice(64,128)))}},{key:"fromDER",value:function(n){var t=n instanceof Uint8Array;if("string"!=typeof n&&!t)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");var r=function(e){if(e.length<2||48!=e[0])throw Error("Invalid signature tag: "+ae(e));if(e[1]!==e.length-2)throw Error("Invalid signature: incorrect length");var n=ee(e.subarray(2)),t=n.data,r=ee(n.left),a=r.data,i=r.left;if(i.length)throw Error("Invalid signature: left bytes after parsing: "+ae(i));return{r:t,s:a}}(t?n:de(n));return new e(r.r,r.s)}},{key:"fromHex",value:function(e){return this.fromDER(e)}}]),e}();function te(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];if(!n.every((function(e){return e instanceof Uint8Array})))throw Error("Uint8Array list expected");if(1===n.length)return n[0];for(var r=n.reduce((function(e,n){return e+n.length}),0),a=new Uint8Array(r),i=0,o=0;i<n.length;i++){var u=n[i];a.set(u,o),o+=u.length}return a}var re=Array.from({length:256},(function(e,n){return n.toString(16).padStart(2,"0")}));function ae(e){if(!(e instanceof Uint8Array))throw Error("Expected Uint8Array");for(var n="",t=0;t<e.length;t++)n+=re[e[t]];return n}var ie,oe,ue=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function ce(e){if("bigint"!=(void 0===e?"undefined":(0,T.default)(e)))throw Error("Expected bigint");if(!(D<=e&&e<ue))throw Error("Expected number 0 <= n < 2^256");return e.toString(16).padStart(64,"0")}function fe(e){var n=de(ce(e));if(32!==n.length)throw Error("Error: expected 32 bytes");return n}function se(e){var n=e.toString(16);return 1&n.length?"0"+n:n}function le(e){if("string"!=typeof e)throw new TypeError("hexToNumber: expected string, got "+(void 0===e?"undefined":(0,T.default)(e)));return BigInt("0x"+e)}function de(e){if("string"!=typeof e)throw new TypeError("hexToBytes: expected string, got "+(void 0===e?"undefined":(0,T.default)(e)));if(e.length%2)throw Error("hexToBytes: received invalid unpadded hex"+e.length);for(var n=new Uint8Array(e.length/2),t=0;t<n.length;t++){var r=2*t,a=e.slice(r,r+2),i=Number.parseInt(a,16);if(Number.isNaN(i)||i<0)throw Error("Invalid byte sequence");n[t]=i}return n}function he(e){return le(ae(e))}function ve(e){return e instanceof Uint8Array?Uint8Array.from(e):de(e)}function ye(e){if("number"==typeof e&&Number.isSafeInteger(e)&&e>0)return BigInt(e);if("bigint"==(void 0===e?"undefined":(0,T.default)(e))&&we(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function pe(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j.P,t=e%n;return t>=D?t:n+t}function ge(e,n){for(var t=j.P,r=e;n-- >D;)r*=r,r%=t;return r}function me(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j.P;if(e===D||n<=D)throw Error("invert: expected positive integers, got n=".concat(e," mod=").concat(n));for(var t=pe(e,n),r=n,a=D,i=z;t!==D;){var o=r%t,u=a-i*(r/t);r=t,t=o,a=i,i=u}if(r!==z)throw Error("invert: does not exist");return pe(a,n)}function we(e){return D<e&&e<j.n}function be(e){return D<e&&e<j.P}function Ee(e){var n;if("bigint"==(void 0===e?"undefined":(0,T.default)(e)))n=e;else if("number"==typeof e&&Number.isSafeInteger(e)&&e>0)n=BigInt(e);else if("string"==typeof e){if(64!==e.length)throw Error("Expected 32 bytes of private key");n=le(e)}else{if(!(e instanceof Uint8Array))throw new TypeError("Expected valid private key");if(e.length!==q)throw Error("Expected 32 bytes of private key");n=he(e)}if(!we(n))throw Error("Expected private key: 0 < key < n");return n}function ke(e){return e instanceof Q?(e.assertValidity(),e):Q.fromHex(e)}function xe(e){return pe(he(e),j.n)}var Ae=function(){"use strict";function e(n,t){(0,k.default)(this,e),this.r=n,this.s=t,this.assertValidity()}return(0,x.default)(e,[{key:"assertValidity",value:function(){var e=this.r,n=this.s;if(!be(e)||!we(n))throw Error("Invalid signature")}},{key:"toHex",value:function(){return ce(this.r)+ce(this.s)}},{key:"toRawBytes",value:function(){return de(this.toHex())}}],[{key:"fromHex",value:function(n){var t=ve(n);if(64!==t.length)throw new TypeError("SchnorrSignature.fromHex: expected 64 bytes, not "+t.length);return new e(he(t.subarray(0,32)),he(t.subarray(32,64)))}}]),e}(),Se=function(){"use strict";function e(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:De.randomBytes();if((0,k.default)(this,e),null==n)throw new TypeError('sign: Expected valid message, not "'.concat(n,'"'));this.m=ve(n);var a=this.getScalar(Ee(t)),i=a.x,o=a.scalar;if(this.px=i,this.d=o,this.rand=ve(r),32!==this.rand.length)throw new TypeError("sign: Expected 32 bytes of aux randomness")}return(0,x.default)(e,[{key:"getScalar",value:function(e){var n=Q.fromPrivateKey(e),t=n.hasEvenY()?e:j.n-e;return{point:n,scalar:t,x:n.toRawX()}}},{key:"initNonce",value:function(e,n){return fe(e^he(n))}},{key:"finalizeNonce",value:function(e){var n=pe(he(e),j.n);if(n===D)throw Error("sign: Creation of signature failed. k is zero");var t=this.getScalar(n);return{R:t.point,rx:t.x,k:t.scalar}}},{key:"finalizeSig",value:function(e,n,t,r){return new Ae(e.x,pe(n+t*r,j.n)).toRawBytes()}},{key:"error",value:function(){throw Error("sign: Invalid signature produced")}},{key:"calc",value:function(){var e=this;return(0,E.default)((function(){var n,t,r,a,i,o,u,c,f,s,l,d,h,v,y;return(0,R.__generator)(this,(function(p){switch(p.label){case 0:return n=e.m,t=e.d,r=e.px,a=e.rand,i=De.taggedHash,h=e.initNonce,v=[t],[4,i(Re.aux,a)];case 1:return o=h.apply(e,v.concat([p.sent()])),y=e.finalizeNonce,[4,i(Re.nonce,o,r,n)];case 2:return u=y.apply(e,[p.sent()]),c=u.R,f=u.rx,s=u.k,[4,i(Re.challenge,f,r,n)];case 3:return l=xe.apply(void 0,[p.sent()]),[4,Pe(d=e.finalizeSig(c,s,l,t),n,r)];case 4:return[2,(p.sent()||e.error(),d)]}}))}))()}},{key:"calcSync",value:function(){var e=this,n=e.m,t=e.d,r=e.px,a=e.rand,i=De.taggedHashSync,o=this.initNonce(t,i(Re.aux,a)),u=this.finalizeNonce(i(Re.nonce,o,r,n)),c=u.R,f=u.rx,s=u.k,l=xe(i(Re.challenge,f,r,n)),d=this.finalizeSig(c,s,l,t);return function(e,n,t){try{var r=_e(e,n,t),a=r.r,i=r.s,o=r.m,u=r.P,c=xe(De.taggedHashSync(Re.challenge,fe(a),u.toRawX(),o));return Ie(a,u,i,c)}catch(e){if(e instanceof F)throw e;return!1}}(d,n,r)||this.error(),d}}]),e}();function _e(e,n,t){var r=e instanceof Ae,a=r?e:Ae.fromHex(e);return r&&a.assertValidity(),(0,I.default)((0,_.default)({},a),{m:ve(n),P:ke(t)})}function Ie(e,n,t,r){var a=Q.BASE.multiplyAndAddUnsafe(n,Ee(t),pe(-r,j.n));return!(!a||!a.hasEvenY()||a.x!==e)}function Pe(e,n,t){return Be.apply(this,arguments)}function Be(){return Be=(0,E.default)((function(e,n,t){var r,a,i,o,u,c;return(0,R.__generator)(this,(function(f){switch(f.label){case 0:return f.trys.push([0,2,,3]),r=_e(e,n,t),a=r.r,i=r.s,o=r.m,u=r.P,[4,De.taggedHash(Re.challenge,fe(a),u.toRawX(),o)];case 1:return c=xe.apply(void 0,[f.sent()]),[2,Ie(a,u,i,c)];case 2:return f.sent(),[2,!1];case 3:return[2]}}))})),Be.apply(this,arguments)}var Te,He=function(e,n,t){return(0,E.default)((function(){return(0,R.__generator)(this,(function(r){return[2,new Se(e,n,t).calc()]}))}))()};Q.BASE._setWindowSize(8);var Ue={node:C,web:"object"==typeof self&&"crypto"in self?self.crypto:void 0},Re={challenge:"BIP0340/challenge",aux:"BIP0340/aux",nonce:"BIP0340/nonce"},Ce={},De=(Te={bytesToHex:ae,hexToBytes:de,concatBytes:te,mod:pe,invert:me,isValidPrivateKey:function(e){try{return Ee(e),!0}catch(e){return!1}},_bigintTo32Bytes:fe,_normalizePrivateKey:Ee,hashToPrivateKey:function(e){if((e=ve(e)).length<40||e.length>1024)throw Error("Expected valid bytes of private key as per FIPS 186");return fe(pe(he(e),j.n-z)+z)}},(0,A.default)(Te,"randomBytes",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(Ue.web)return Ue.web.getRandomValues(new Uint8Array(e));if(Ue.node){var n=Ue.node.randomBytes;return Uint8Array.from(n(e))}throw Error("The environment doesn't have randomBytes function")})),(0,A.default)(Te,"randomPrivateKey",(function(){return De.hashToPrivateKey(De.randomBytes(40))})),(0,A.default)(Te,"precompute",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Q.BASE,t=n===Q.BASE?n:new Q(n.x,n.y);return t._setWindowSize(e),t.multiply(N),t})),(0,A.default)(Te,"sha256",(function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return(0,E.default)((function(){var e,t,r,a;return(0,R.__generator)(this,(function(i){switch(i.label){case 0:return Ue.web?[4,Ue.web.subtle.digest("SHA-256",te.apply(void 0,(0,B.default)(n)))]:[3,2];case 1:return e=i.sent(),[2,new Uint8Array(e)];case 2:if(Ue.node)return t=Ue.node,r=t.createHash,a=r("sha256"),[2,(n.forEach((function(e){return a.update(e)})),Uint8Array.from(a.digest()))];throw Error("The environment doesn't have sha256 function")}}))}))()})),(0,A.default)(Te,"hmacSha256",(function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];return(0,E.default)((function(){var n,r,a,i,o,u;return(0,R.__generator)(this,(function(c){switch(c.label){case 0:return Ue.web?[4,Ue.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"])]:[3,3];case 1:return n=c.sent(),r=te.apply(void 0,(0,B.default)(t)),[4,Ue.web.subtle.sign("HMAC",n,r)];case 2:return a=c.sent(),[2,new Uint8Array(a)];case 3:if(Ue.node)return i=Ue.node,o=i.createHmac,u=o("sha256",e),[2,(t.forEach((function(e){return u.update(e)})),Uint8Array.from(u.digest()))];throw Error("The environment doesn't have hmac-sha256 function")}}))}))()})),(0,A.default)(Te,"sha256Sync",void 0),(0,A.default)(Te,"hmacSha256Sync",void 0),(0,A.default)(Te,"taggedHash",(function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];return(0,E.default)((function(){var n,r,a;return(0,R.__generator)(this,(function(i){switch(i.label){case 0:return void 0!==(r=Ce[e])?[3,2]:[4,De.sha256(Uint8Array.from(e,(function(e){return e.charCodeAt(0)})))];case 1:a=i.sent(),r=te(a,a),Ce[e]=r,i.label=2;case 2:return[2,(n=De).sha256.apply(n,[r].concat((0,B.default)(t)))]}}))}))()})),(0,A.default)(Te,"taggedHashSync",(function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];if("function"!=typeof ie)throw new F("sha256Sync is undefined, you need to set it");var a=Ce[e];if(void 0===a){var i=ie(Uint8Array.from(e,(function(e){return e.charCodeAt(0)})));a=te(i,i),Ce[e]=a}return ie.apply(void 0,[a].concat((0,B.default)(t)))})),(0,A.default)(Te,"_JacobianPoint",G),Te);Object.defineProperties(De,{sha256Sync:{configurable:!1,get:function(){return ie},set:function(e){ie||(ie=e)}},hmacSha256Sync:{configurable:!1,get:function(){return oe},set:function(e){oe||(oe=e)}}});var ze,Oe,Ne=Math.floor,Le=Math.random,je=Math.sin,Me="Trystero",Ze=function(e,n){return Array(e).fill().map(n)},Ve=function(e){return Ze(e,(function(){return"0123456789AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz"[Ne(62*Le())]})).join("")},qe=Ve(20),We=Promise.all.bind(Promise),Ke="undefined"!=typeof window,Fe=Object.entries,Je=Object.fromEntries,Ge=Object.keys,Xe=function(){},Ye=function(e){return Error("".concat(Me,": ").concat(e))},Qe=new TextEncoder,$e=new TextDecoder,en=function(e){return Qe.encode(e)},nn=function(e){return $e.decode(e)},tn=function(e){return e.reduce((function(e,n){return e+n.toString(16).padStart(2,"0")}),"")},rn=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return n.join("@")},an=JSON.stringify,on=JSON.parse,un=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_SAFE_INTEGER;return e.split("").reduce((function(e,n){return e+n.charCodeAt(0)}),0)%n},cn={},fn="AES-GCM",sn={},ln=(ze=(0,E.default)((function(e){var n,t,r;return(0,R.__generator)(this,(function(a){switch(a.label){case 0:return(n=sn[e])?[3,2]:(t=Array.from,r=Uint8Array.bind,[4,crypto.subtle.digest("SHA-1",en(e))]);case 1:n=sn[e]=t.apply(Array,[new(r.apply(Uint8Array,[void 0,a.sent()]))]).map((function(e){return e.toString(36)})).join(""),a.label=2;case 2:return[2,n]}}))})),function(e){return ze.apply(this,arguments)}),dn=function(){var e=(0,E.default)((function(e,n){var t,r,a,i,o,u;return(0,R.__generator)(this,(function(c){switch(c.label){case 0:return t=crypto.getRandomValues(new Uint8Array(16)),a=t.join(",")+"$",o=(i=crypto.subtle).encrypt,u=[{name:fn,iv:t}],[4,e];case 1:return[4,o.apply(i,u.concat([c.sent(),en(n)]))];case 2:return[2,a+(r=c.sent(),btoa(String.fromCharCode.apply(null,new Uint8Array(r))))]}}))}));return function(n,t){return e.apply(this,arguments)}}(),hn=function(){var e=(0,E.default)((function(e,n){var t,r,a,i,o,u;return(0,R.__generator)(this,(function(c){switch(c.label){case 0:return t=(0,P.default)(n.split("$"),2),r=t[0],a=t[1],o=(i=crypto.subtle).decrypt,u=[{name:fn,iv:new Uint8Array(r.split(","))}],[4,e];case 1:return[4,o.apply(i,u.concat([c.sent(),function(e){var n=atob(e);return new Uint8Array(n.length).map((function(e,t){return n.charCodeAt(t)})).buffer}(a)]))];case 2:return[2,nn.apply(void 0,[c.sent()])]}}))}));return function(n,t){return e.apply(this,arguments)}}(),vn="icegatheringstatechange",yn="offer",pn=function(e,n){var t=n.rtcConfig,r=n.rtcPolyfill,a=n.turnConfig,i=new(r||RTCPeerConnection)((0,_.default)({iceServers:gn.concat(a||[])},t)),o={},u=!1,c=!1,f=null,s=function(e){e.binaryType="arraybuffer",e.bufferedAmountLowThreshold=65535,e.onmessage=function(e){var n;return null===(n=o.data)||void 0===n?void 0:n.call(o,e.data)},e.onopen=function(){var e;return null===(e=o.connect)||void 0===e?void 0:e.call(o)},e.onclose=function(){var e;return null===(e=o.close)||void 0===e?void 0:e.call(o)},e.onerror=function(e){var n;return null===(n=o.error)||void 0===n?void 0:n.call(o,e)}},l=function(e){return Promise.race([new Promise((function(n){var t=function(){"complete"===e.iceGatheringState&&(e.removeEventListener(vn,t),n())};e.addEventListener(vn,t),t()})),new Promise((function(e){return setTimeout(e,5e3)}))]).then((function(){return{type:e.localDescription.type,sdp:e.localDescription.sdp.replace(/a=ice-options:trickle\s\n/g,"")}}))};return e?(f=i.createDataChannel("data"),s(f)):i.ondatachannel=function(e){var n=e.channel;f=n,s(n)},i.onnegotiationneeded=(0,E.default)((function(){var e,n,t,r;return(0,R.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,4,5]),u=!0,[4,i.setLocalDescription()];case 1:return a.sent(),[4,l(i)];case 2:return n=a.sent(),null===(e=o.signal)||void 0===e||e.call(o,n),[3,5];case 3:return t=a.sent(),null===(r=o.error)||void 0===r||r.call(o,t),[3,5];case 4:return u=!1,[7];case 5:return[2]}}))})),i.onconnectionstatechange=function(){var e;["disconnected","failed","closed"].includes(i.connectionState)&&(null===(e=o.close)||void 0===e||e.call(o))},i.ontrack=function(e){var n,t;null===(n=o.track)||void 0===n||n.call(o,e.track,e.streams[0]),null===(t=o.stream)||void 0===t||t.call(o,e.streams[0])},i.onremovestream=function(e){var n;return null===(n=o.stream)||void 0===n?void 0:n.call(o,e.stream)},e&&(i.canTrickleIceCandidates||i.onnegotiationneeded()),{created:Date.now(),connection:i,get channel(){return f},get isDead(){return"closed"===i.connectionState},signal:function(n){return(0,E.default)((function(){var t,r,a,s,d;return(0,R.__generator)(this,(function(h){switch(h.label){case 0:if("open"===(null==f?void 0:f.readyState)&&!(null===(t=n.sdp)||void 0===t?void 0:t.includes("a=rtpmap")))return[3,14];h.label=1;case 1:return h.trys.push([1,13,,14]),n.type!==yn?[3,8]:u||"stable"!==i.signalingState&&!c?e?[2]:[4,We([i.setLocalDescription({type:"rollback"}),i.setRemoteDescription(n)])]:[3,3];case 2:return h.sent(),[3,5];case 3:return[4,i.setRemoteDescription(n)];case 4:h.sent(),h.label=5;case 5:return[4,i.setLocalDescription()];case 6:return h.sent(),[4,l(i)];case 7:return a=h.sent(),[2,(null===(r=o.signal)||void 0===r||r.call(o,a),a)];case 8:if("answer"!==n.type)return[3,12];c=!0,h.label=9;case 9:return h.trys.push([9,,11,12]),[4,i.setRemoteDescription(n)];case 10:return h.sent(),[3,12];case 11:return c=!1,[7];case 12:return[3,14];case 13:return s=h.sent(),null===(d=o.error)||void 0===d||d.call(o,s),[3,14];case 14:return[2]}}))}))()},sendData:function(e){return f.send(e)},destroy:function(){null==f||f.close(),i.close(),u=!1,c=!1},setHandlers:function(e){return Object.assign(o,e)},offerPromise:e?new Promise((function(e){return o.signal=function(n){n.type===yn&&e(n)}})):Promise.resolve(),addStream:function(e){return e.getTracks().forEach((function(n){return i.addTrack(n,e)}))},removeStream:function(e){return i.getSenders().filter((function(n){return e.getTracks().includes(n.track)})).forEach((function(e){return i.removeTrack(e)}))},addTrack:function(e,n){return i.addTrack(e,n)},removeTrack:function(e){var n=i.getSenders().find((function(n){return n.track===e}));n&&i.removeTrack(n)},replaceTrack:function(e,n){var t=i.getSenders().find((function(n){return n.track===e}));if(t)return t.replaceTrack(n)}}},gn=(0,B.default)(Ze(3,(function(e,n){return"stun:stun".concat(n||"",".l.google.com:19302")}))).concat(["stun:stun.cloudflare.com:3478"]).map((function(e){return{urls:e}})),mn=Object.getPrototypeOf(Uint8Array),wn=16369,bn=255,En="bufferedamountlow",kn=function(e){return"@_"+e},xn={},An="EVENT",Sn=De.randomPrivateKey(),_n=tn(function(e){return Q.fromPrivateKey(e).toRawX()}(Sn)),In={},Pn={},Bn={},Tn=function(){return Math.floor(Date.now()/1e3)},Hn=function(e){return null!==(Oe=(i=Bn)[o=e])&&void 0!==Oe?Oe:i[o]=un(e,1e4)+2e4},Un=function(){var e=(0,E.default)((function(e,n){var t,r,a,i,o,u;return(0,R.__generator)(this,(function(c){switch(c.label){case 0:return t={kind:Hn(e),content:n,pubkey:_n,created_at:Tn(),tags:[["x",e]]},a=Uint8Array.bind,[4,crypto.subtle.digest("SHA-256",en(an([0,t.pubkey,t.created_at,t.kind,t.tags,t.content])))];case 1:return r=tn.apply(void 0,[new(a.apply(Uint8Array,[void 0,c.sent()]))]),i=[An],o=[(0,_.default)({},t)],u={id:r},[4,He(r,Sn)];case 2:return[2,an.apply(void 0,[i.concat([I.default.apply(void 0,o.concat([(u.sig=tn.apply(void 0,[c.sent()]),u)]))])])]}}))}));return function(n,t){return e.apply(this,arguments)}}(),Rn=function(e,n){return In[e]=n,an(["REQ",e,{kinds:[Hn(n)],since:Tn(),"#x":[n]}])},Cn=function(e){return delete In[e],an(["CLOSE",e])},Dn=function(e){var n,t,r,a=e.init,i=e.subscribe,o=e.announce,w={},b=!1;return function(e,k,x){var A,S,H=e.appId;if(null===(S=w[H])||void 0===S?void 0:S[k])return w[H][k];var U={},C={},D=rn(Me,H,k),z=ln(D),O=ln(rn(D,qe)),N=function(){var e=(0,E.default)((function(e,n,t){var r,a,i;return(0,R.__generator)(this,(function(o){switch(o.label){case 0:return a=(r=crypto.subtle).importKey,i=["raw"],[4,crypto.subtle.digest({name:"SHA-256"},en("".concat(e,":").concat(n,":").concat(t)))];case 1:return[2,a.apply(r,i.concat([o.sent(),{name:fn},!1,["encrypt","decrypt"]]))]}}))}));return function(n,t,r){return e.apply(this,arguments)}}()(e.password||"",H,k),L=function(e){return function(){var n=(0,E.default)((function(n){var t;return(0,R.__generator)(this,(function(r){switch(r.label){case 0:return t={type:n.type},[4,e(N,n.sdp)];case 1:return[2,(t.sdp=r.sent(),t)]}}))}));return function(e){return n.apply(this,arguments)}}()},j=L(hn),M=L(dn),Z=function(){return pn(!0,e)},V=function(e,n,t){var r;C[n]?C[n]!==e&&e.destroy():(C[n]=e,Q(e,n),null===(r=U[n])||void 0===r||r.forEach((function(e,n){n!==t&&e.destroy()})),delete U[n])},q=function(e,n){C[n]===e&&delete C[n]},W=function(e){return(A=t).push.apply(A,(0,B.default)(Ze(e,Z))),We(t.splice(0,e).map((function(e){return e.offerPromise.then(M).then((function(n){return{peer:e,offer:n}}))})))},K=function(n,t){return null==x?void 0:x({error:"incorrect password (".concat(e.password,") when decrypting ").concat(t),appId:H,peerId:n,roomId:k})},F=function(n){return function(){var t=(0,E.default)((function(t,r,a){var i,o,f,s,l,d,h,v,y,p,g,m,w,b,E,k,x,A,S,_,I,B,T,H,N,L;return(0,R.__generator)(this,(function(R){switch(R.label){case 0:return[4,We([z,O])];case 1:if(i=P.default.apply(void 0,[R.sent(),2]),o=i[0],f=i[1],t!==o&&t!==f)return[2];if(s="string"==typeof r?on(r):r,l=s.peerId,d=s.offer,h=s.answer,v=s.peer,l===qe||C[l])return[3,16];if(l&&!d&&!h)return[3,14];if(!d)return[3,8];if((null===(y=U[l])||void 0===y?void 0:y[n])&&qe>l)return[2];(p=pn(!1,e)).setHandlers({connect:function(){return V(p,l,n)},close:function(){return q(p,l)}}),R.label=2;case 2:return R.trys.push([2,4,,5]),[4,j(d)];case 3:return g=R.sent(),[3,5];case 4:return R.sent(),[2,void K(l,"offer")];case 5:return p.isDead?[2]:[4,We([ln(rn(D,l)),p.signal(g)])];case 6:return m=P.default.apply(void 0,[R.sent(),2]),w=m[0],b=m[1],E=[w],k={peerId:qe},[4,M(b)];case 7:return a.apply(void 0,E.concat([an.apply(void 0,[(k.answer=R.sent(),k)])])),[3,13];case 8:if(!h)return[3,13];R.label=9;case 9:return R.trys.push([9,11,,12]),[4,j(h)];case 10:return x=R.sent(),[3,12];case 11:return R.sent(),[2,void K(l,"answer")];case 12:v?(v.setHandlers({connect:function(){return V(v,l,n)},close:function(){return q(v,l)}}),v.signal(x)):(S=null===(A=U[l])||void 0===A?void 0:A[n])&&!S.isDead&&S.signal(x),R.label=13;case 13:return[3,16];case 14:return(null===(_=U[l])||void 0===_?void 0:_[n])?[2]:[4,We([W(1),ln(rn(D,l))])];case 15:I=P.default.apply(void 0,[R.sent(),2]),B=(0,P.default)(I[0],1),T=B[0],H=T.peer,N=T.offer,L=I[1],(u=U)[c=l]||(u[c]=[]),U[l][n]=H,setTimeout((function(){return function(e,n){var t;if(!C[e]){var r=null===(t=U[e])||void 0===t?void 0:t[n];r&&(delete U[e][n],r.destroy())}}(l,n)}),.9*G[n]),H.setHandlers({connect:function(){return V(H,l,n)},close:function(){return q(H,l)}}),a(L,an({peerId:qe,offer:N})),R.label=16;case 16:return[2]}}))}));return function(e,n,r){return t.apply(this,arguments)}}()};if(!e)throw Ye("requires a config map as the first argument");if(!H&&!e.firebaseApp)throw Ye("config map is missing appId field");if(!k)throw Ye("roomId argument required");if(!b){var J=a(e);t=Ze(20,Z),n=Array.isArray(J)?J:[J],b=!0,r=setInterval((function(){return t=t.filter((function(e){var n=Date.now()-e.created<57333;return n||e.destroy(),n}))}),59052.99)}var G=n.map((function(){return 5333})),X=[],Y=n.map(function(){var e=(0,E.default)((function(e,n){var t;return(0,R.__generator)(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return t=[r.sent()],[4,z];case 2:return t=t.concat(r.sent()),[4,O];case 3:return[2,i.apply(void 0,t.concat([r.sent(),F(n),W]))]}}))}));return function(n,t){return e.apply(this,arguments)}}());We([z,O]).then((function(e){var t=(0,P.default)(e,2),r=t[0],a=t[1],i=function(){var e=(0,E.default)((function(e,n){var t;return(0,R.__generator)(this,(function(u){switch(u.label){case 0:return[4,o(e,r,a)];case 1:return"number"==typeof(t=u.sent())&&(G[n]=t),X[n]=setTimeout((function(){return i(e,n)}),G[n]),[2]}}))}));return function(n,t){return e.apply(this,arguments)}}();Y.forEach(function(){var e=(0,E.default)((function(e,t){return(0,R.__generator)(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return r.sent(),[4,n[t]];case 2:return i.apply(void 0,[r.sent(),t]),[2]}}))}));return function(n,t){return e.apply(this,arguments)}}())}));var Q=Xe;return(f=w)[s=H]||(f[s]={}),w[H][k]=function(e,n,t){var r={},a={},i={},o={},u={},c={},f={},s={onPeerJoin:Xe,onPeerLeave:Xe,onPeerStream:Xe,onPeerTrack:Xe},w=function(e,n){return(e?Array.isArray(e)?e:[e]:Ge(r)).flatMap((function(e){var t=r[e];return t?n(e,t):(console.warn("".concat(Me,": no peer with id ").concat(e," found")),[])}))},b=function(e){r[e]&&(delete r[e],delete o[e],delete u[e],s.onPeerLeave(e),n(e))},k=function(e){if(a[e])return i[e];if(!e)throw Ye("action type argument is required");var n=en(e);if(n.byteLength>12)throw Ye('action type string "'.concat(e,'" (').concat(n.byteLength,"b) exceeds byte limit (12). Hint: choose a shorter name."));var t=new Uint8Array(12);t.set(n);var o=0;return a[e]={onComplete:Xe,onProgress:Xe,setOnComplete:function(n){return a[e]=(0,I.default)((0,_.default)({},a[e]),{onComplete:n})},setOnProgress:function(n){return a[e]=(0,I.default)((0,_.default)({},a[e]),{onProgress:n})},send:function(e,n,a,i){return(0,E.default)((function(){var u,c,f,s,l,d,h,v,y,p,g;return(0,R.__generator)(this,(function(m){switch(m.label){case 0:if(a&&"object"!=typeof a)throw Ye("action meta argument must be an object");if("undefined"===(u=void 0===e?"undefined":(0,T.default)(e)))throw Ye("action data cannot be undefined");if(c="string"!==u,f=e instanceof Blob,s=f||e instanceof ArrayBuffer||e instanceof mn,a&&!s)throw Ye("action meta argument can only be used with binary data");return s?(p=Uint8Array.bind,f?[4,e.arrayBuffer()]:[3,2]):[3,4];case 1:return g=m.sent(),[3,3];case 2:g=e,m.label=3;case 3:return y=new(p.apply(Uint8Array,[void 0,g])),[3,5];case 4:y=en(c?an(e):e),m.label=5;case 5:return l=y,d=a?en(an(a)):null,h=Math.ceil(l.byteLength/wn)+(a?1:0)||1,v=Ze(h,(function(e,n){var r=n===h-1,i=a&&0===n,u=new Uint8Array(15+(i?d.byteLength:r?l.byteLength-wn*(h-(a?2:1)):wn));return u.set(t),u.set([o],12),u.set([r|i<<1|s<<2|c<<3],13),u.set([Math.round((n+1)/h*bn)],14),u.set(a?i?d:l.subarray((n-1)*wn,n*wn):l.subarray(n*wn,(n+1)*wn),15),u})),[2,(o=o+1&bn,We(w(n,function(){var e=(0,E.default)((function(e,n){var t,o,u;return(0,R.__generator)(this,(function(c){switch(c.label){case 0:t=n.channel,o=0,c.label=1;case 1:return o<h?(u=v[o],t.bufferedAmount>t.bufferedAmountLowThreshold?[4,new Promise((function(e){var n=function(){t.removeEventListener(En,n),e()};t.addEventListener(En,n)}))]:[3,3]):[3,5];case 2:c.sent(),c.label=3;case 3:if(!r[e])return[3,5];n.sendData(u),o++,null==i||i(u[14]/bn,e,a),c.label=4;case 4:return[3,1];case 5:return[2]}}))}));return function(n,t){return e.apply(this,arguments)}}())))]}}))}))()}},(l=i)[d=e]||(l[d]=[a[e].send,a[e].setOnComplete,a[e].setOnProgress])},x=function(e,n){var t=new Uint8Array(n),r=nn(t.subarray(0,12)).replaceAll("\0",""),i=(0,P.default)(t.subarray(12,13),1)[0],u=(0,P.default)(t.subarray(13,14),1)[0],c=(0,P.default)(t.subarray(14,15),1)[0],f=t.subarray(15),s=!!(1&u),l=!!(2&u),d=!!(4&u),w=!!(8&u);if(a[r]){(h=o)[v=e]||(h[v]={}),(y=o[e])[p=r]||(y[p]={});var b=(g=o[e][r])[m=i]||(g[m]={chunks:[]});if(l?b.meta=on(nn(f)):b.chunks.push(f),a[r].onProgress(c/bn,e,b.meta),s){var E=new Uint8Array(b.chunks.reduce((function(e,n){return e+n.byteLength}),0));if(b.chunks.reduce((function(e,n){return E.set(n,e),e+n.byteLength}),0),delete o[e][r][i],d)a[r].onComplete(E,e,b.meta);else{var k=nn(E);a[r].onComplete(w?on(k):k,e)}}}else console.warn("".concat(Me,": received message with unregistered type (").concat(r,")"))},A=function(){var e=(0,E.default)((function(){return(0,R.__generator)(this,(function(e){switch(e.label){case 0:return[4,K("")];case 1:return e.sent(),[4,new Promise((function(e){return setTimeout(e,99)}))];case 2:return e.sent(),Fe(r).forEach((function(e){var n=(0,P.default)(e,2),t=n[0];n[1].destroy(),delete r[t]})),t(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),S=(0,P.default)(k(kn("ping")),2),B=S[0],H=S[1],U=(0,P.default)(k(kn("pong")),2),C=U[0],D=U[1],z=(0,P.default)(k(kn("signal")),2),O=z[0],N=z[1],L=(0,P.default)(k(kn("stream")),2),j=L[0],M=L[1],Z=(0,P.default)(k(kn("track")),2),V=Z[0],q=Z[1],W=(0,P.default)(k(kn("leave")),2),K=W[0],F=W[1];return Q=function(e,n){var t;r[n]||(r[n]=e,e.setHandlers({data:function(e){return x(n,e)},stream:function(e){s.onPeerStream(e,n,c[n]),delete c[n]},track:function(e,t){s.onPeerTrack(e,t,n,f[n]),delete f[n]},signal:function(e){return O(e,n)},close:function(){return b(n)},error:function(e){console.error(e),b(n)}}),s.onPeerJoin(n),null===(t=e.drainEarlyData)||void 0===t||t.call(e,(function(e){return x(n,e)})))},H((function(e,n){return C("",n)})),D((function(e,n){var t;null===(t=u[n])||void 0===t||t.call(u),delete u[n]})),N((function(e,n){var t;return null===(t=r[n])||void 0===t?void 0:t.signal(e)})),M((function(e,n){return c[n]=e})),q((function(e,n){return f[n]=e})),F((function(e,n){return b(n)})),Ke&&addEventListener("beforeunload",A),{makeAction:k,leave:A,ping:function(e){return(0,E.default)((function(){var n;return(0,R.__generator)(this,(function(t){switch(t.label){case 0:if(!e)throw Ye("ping() must be called with target peer ID");return n=Date.now(),B("",e),[4,new Promise((function(n){return u[e]=n}))];case 1:return[2,(t.sent(),Date.now()-n)]}}))}))()},getPeers:function(){return Je(Fe(r).map((function(e){var n=(0,P.default)(e,2);return[n[0],n[1].connection]})))},addStream:function(e,n,t){return w(n,function(){var n=(0,E.default)((function(n,r){return(0,R.__generator)(this,(function(a){switch(a.label){case 0:return t?[4,j(t,n)]:[3,2];case 1:a.sent(),a.label=2;case 2:return r.addStream(e),[2]}}))}));return function(e,t){return n.apply(this,arguments)}}())},removeStream:function(e,n){return w(n,(function(n,t){return t.removeStream(e)}))},addTrack:function(e,n,t,r){return w(t,function(){var t=(0,E.default)((function(t,a){return(0,R.__generator)(this,(function(i){switch(i.label){case 0:return r?[4,V(r,t)]:[3,2];case 1:i.sent(),i.label=2;case 2:return a.addTrack(e,n),[2]}}))}));return function(e,n){return t.apply(this,arguments)}}())},removeTrack:function(e,n){return w(n,(function(n,t){return t.removeTrack(e)}))},replaceTrack:function(e,n,t,r){return w(t,function(){var t=(0,E.default)((function(t,a){return(0,R.__generator)(this,(function(i){switch(i.label){case 0:return r?[4,V(r,t)]:[3,2];case 1:i.sent(),i.label=2;case 2:return a.replaceTrack(e,n),[2]}}))}));return function(e,n){return t.apply(this,arguments)}}())},onPeerJoin:function(e){return s.onPeerJoin=e},onPeerLeave:function(e){return s.onPeerLeave=e},onPeerStream:function(e){return s.onPeerStream=e},onPeerTrack:function(e){return s.onPeerTrack=e}}}(0,(function(e){return delete C[e]}),(function(){delete w[H][k],X.forEach(clearTimeout),Y.forEach(function(){var e=(0,E.default)((function(e){return(0,R.__generator)(this,(function(n){switch(n.label){case 0:return[4,e];case 1:return[2,n.sent()()]}}))}));return function(n){return e.apply(this,arguments)}}()),clearInterval(r)}))}}({init:function(e){return function(e,n,t){return(e.relayUrls||function(e,n){for(var t=(0,B.default)(e),r=function(){var e=1e4*je(n++);return e-Ne(e)},a=t.length;a;){var i,o=Ne(r()*a--);i=[t[o],t[a]],t[a]=i[0],t[o]=i[1]}return t}(n,un(e.appId))).slice(0,e.relayUrls?e.relayUrls.length:e.relayRedundancy||5)}(e,zn).map((function(e){var n=function(e,n){var t={},r=function(){var a=new WebSocket(e);a.onclose=function(){var n;null!==(n=(w=cn)[b=e])&&void 0!==n||(w[b]=3333),setTimeout(r,cn[e]),cn[e]*=2},a.onmessage=function(e){return n(e.data)},t.socket=a,t.url=a.url,t.ready=new Promise((function(n){return a.onopen=function(){n(t),cn[e]=3333}})),t.send=function(e){1===a.readyState&&a.send(e)}};return r(),t}(e,(function(e){var t,r=(0,P.default)(on(e),4),a=r[0],i=r[1],o=r[2],u=r[3];if(a===An)null===(t=Pn[i])||void 0===t||t.call(Pn,In[i],o.content);else{var c="".concat(Me,": relay failure from ").concat(n.url," - ");"NOTICE"===a?console.warn(c+i):"OK"!==a||o||console.warn(c+u)}}));return xn[e]=n,n.ready}))},subscribe:function(e,n,t,r){var a=Ve(64),i=Ve(64);return Pn[a]=Pn[i]=function(n,t){return r(n,t,function(){var n=(0,E.default)((function(n,t){var r;return(0,R.__generator)(this,(function(a){switch(a.label){case 0:return r=e.send,[4,Un(n,t)];case 1:return[2,r.apply(e,[a.sent()])]}}))}));return function(e,t){return n.apply(this,arguments)}}())},e.send(Rn(a,n)),e.send(Rn(i,t)),function(){e.send(Cn(a)),e.send(Cn(i)),delete Pn[a],delete Pn[i]}},announce:function(e,n){return(0,E.default)((function(){var t;return(0,R.__generator)(this,(function(r){switch(r.label){case 0:return t=e.send,[4,Un(n,an({peerId:qe}))];case 1:return[2,t.apply(e,[r.sent()])]}}))}))()}}),zn=(xn,["eu.purplerelay.com","ftp.halifax.rwth-aachen.de/nostr","multiplexer.huszonegy.world","nostr.cool110.xyz","nostr.data.haus","nostr.grooveix.com","nostr.huszonegy.world","nostr.mom","nostr.sathoarder.com","nostr.vulpem.com","relay.fountain.fm","relay.nostraddress.com","relay.nostromo.social","relay.snort.social","relay.verified-nostr.com","yabu.me/v2"].map((function(e){return"wss://"+e})))}))}();
