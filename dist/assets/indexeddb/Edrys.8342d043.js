!function(){function t(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n=e.parcelRequire55a5;n.register("9WzNc",(function(e,r){t(e.exports,"default",(function(){return u}));var i=n("jwduU");function o(t,e,n){return o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=(0,i.default)(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n||t):o.value}},o(t,e,n)}function u(t,e,n){return o(t,e,n)}})),n.register("jwduU",(function(e,r){t(e.exports,"default",(function(){return o}));var i=n("div3d");function o(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=(0,i.default)(t)););return t}})),n.register("auvHb",(function(e,r){t(e.exports,"uint8_to_base64",(function(){return l})),t(e.exports,"base64_to_unit8",(function(){return f})),t(e.exports,"Sync",(function(){return h}));var i=n("9Klpk"),o=n("3bWnf"),u=n("eT7f3"),a=n("7OeKL"),c=n("edmAk"),s=n("ie2ZQ");function l(t){return(0,s.encode)(t)}function f(t){return(0,s.decode)(t)}function d(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="",r=0;r<t;r++)n+=e.charAt(Math.floor(Math.random()*e.length));return n}var h=function(){"use strict";function t(e,n,r,o){var s,l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],f=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],h=this;(0,i.default)(this,t),(0,u.default)(this,"isConnected",!1),(0,u.default)(this,"replyOnReceive",!1);try{(s=window.localStorage.getItem("lia-token"))||(s=d(),window.localStorage.setItem("lia-token",s))}catch(t){console.warn("cannot write to localStorage"),s=d()}this.token=s,this.urlCounter=0,this.cbConnection=e,this.cbRelay=n,this.onConnect=r,this.onReceive=o,this.replyOnReceive=l;var v=this,g=function(t){var e=null;function n(){return 200*(t.db.getPeers().length+1)+2e3}function r(){if(t.isConnected)try{t.broadcast(!0,t.db.encode()),e=window.setTimeout(r,n())}catch(t){e=null}}return function(){e&&window.clearTimeout(e),e=window.setTimeout(r,n())}}(v);this.gossip=g;var p=a.throttle((function(){v.broadcast(!0,v.db.encode()),g()}),1e3);this.db=new(0,c.CRDT)(s,f?function(t,e){if(v.db){switch(e){case"cursor":h.sync("update",{cmd:"cursor",param:t});break;case"peer":h.sync("update",{cmd:"peer",param:t});break;case"code":h.sync("update",{cmd:"code",param:t});break;case"quiz":h.sync("update",{cmd:"quiz",param:t});break;case"survey":h.sync("update",{cmd:"survey",param:t});break;case"chat":h.sync("update",{cmd:"chat",param:t});break;case"exit":try{e=null,h.broadcast(!0,t),h.destroy()}catch(t){}break;default:console.warn("Sync unknown origin",e)}e&&p()}}:void 0)}return(0,o.default)(t,[{key:"connect",value:function(t){this.room=t.room,this.course=t.course,this.password=t.password,this.isConnected=!0}},{key:"destroy",value:function(){this.db.destroy(),this.cbConnection("disconnect",this.token),this.isConnected=!1}},{key:"disconnect",value:function(){this.db.removePeer()}},{key:"uniqueID",value:function(){return"string"==typeof this.room&&(this.room.startsWith('"')&&this.room.endsWith('"')||this.room.startsWith("'")&&this.room.endsWith("'"))?this.room:this.course&&this.room?JSON.stringify({course:this.course,room:this.room,pw:a.getHashCode(this.password||"")}):(console.warn("Sync: no uniqueID"),null)}},{key:"sendToLia",value:function(t){this.cbRelay(t)}},{key:"sync",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.cbConnection(t,e)}},{key:"sendDisconnectError",value:function(t){this.sync("error",t)}},{key:"sendConnect",value:function(){this.sync("connect",this.token),this.onConnect&&this.onConnect()}},{key:"pubsubSend",value:function(t,e){var n,r=JSON.stringify({topic:t,message:e}),i=new TextEncoder;this.broadcast(!1,i.encode(r)),this.replyOnReceive&&(null===(n=this.onReceive)||void 0===n||n.call(this,t,e))}},{key:"pubsubReceive",value:function(t){try{var e,n=(new TextDecoder).decode(t),r=JSON.parse(n);null===(e=this.onReceive)||void 0===e||e.call(this,r.topic,r.message)}catch(t){console.warn("Sync: pubsubReceive",t.message)}}},{key:"broadcast",value:function(t,e){console.warn("broadcast needs to be implemented")}},{key:"load",value:function(t,e){try{for(var n=this,r=function(r){var i=document.createElement("script");i.async=!1,i.defer=!0,i.src=t[r],n.urlCounter++;var o=n;i.onload=function(){console.log("successfully loaded =>",t),o.urlCounter--,0==o.urlCounter&&e.init(!0)},i.onerror=function(n){console.warn("could not load =>",t,n),o.urlCounter=0,e.init(!1,"could not load => ".concat(t))},document.head.appendChild(i)},i=0;i<t.length;i++)r(i)}catch(t){console.error("load: ",t),e.init(!1,t.message)}}},{key:"publish",value:function(t){switch(t.message.cmd){case"update":break;case"join":this.db.init(t.message.param),this.gossip();break;case"chat":this.db.addChatMessage(t.message.param);break;case"quiz":var e,n;"quiz"===(null===(e=t.track)||void 0===e?void 0:e[0][0])&&"id"===(null===(n=t.track)||void 0===n?void 0:n[1][0])?this.db.addQuiz(t.track[0][1],t.track[1][1],t.message.param):console.warn("SyncTX wrong event ->",t);break;case"survey":var r,i;"survey"===(null===(r=t.track)||void 0===r?void 0:r[0][0])&&"id"===(null===(i=t.track)||void 0===i?void 0:i[1][0])?this.db.addSurvey(t.track[0][1],t.track[1][1],t.message.param):console.warn("SyncTX wrong event ->",t);break;case"code":var o,u;"code"===(null===(o=t.track)||void 0===o?void 0:o[0][0])&&"id"===(null===(u=t.track)||void 0===u?void 0:u[1][0])?this.db.updateCode(t.track[0][1],t.track[1][1],t.message.param.j,t.message.param.msg):console.warn("SyncTX wrong event ->",t);break;case"codes":var a;if("code"===(null===(a=t.track)||void 0===a?void 0:a[0][0])&&1===t.track.length)for(var c=0;c<t.message.param.length;c++)for(var s=0;s<t.message.param[c].length;s++)this.db.initCode(t.track[0][1],c,s,t.message.param[c][s]);else console.warn("SyncTX wrong event ->",t);break;case"cursor":var l;"code"==(null===(l=t.track)||void 0===l?void 0:l[0][0])&&this.db.setCursor(t.track[0][1],t.message.param);break;case"broadcast":this.broadcast(!0,t.message.param);default:console.warn("SyncTX unknown command:",t.message)}}},{key:"applyUpdate",value:function(t){this.db.applyUpdate(t)}}]),t}()})),n.register("edmAk",(function(e,r){t(e.exports,"CRDT",(function(){return f}));var i=n("9Klpk"),o=n("3bWnf"),u=n("bgoEC"),a=n("5ENmm"),c=n("bymyA"),s=n("7OeKL"),l=n("17n8H"),f=function(){"use strict";function t(e,n){var r=this;(0,i.default)(this,t),this.doc=new c.Doc,this.callback=n||function(t,e){console.warn("SyncDB: no callback provided")},this.length=0,this.peerID=e,this.peers=this.doc.getMap("peers"),this.cursors=this.doc.getMap("cursors"),this.codes=this.doc.getMap("c"),this.quizzes=new(0,l.YKeyValue)(this.doc.getArray("q")),this.surveys=new(0,l.YKeyValue)(this.doc.getArray("s")),this.chat=new(0,l.YKeyValue)(this.doc.getArray("chat")),n&&(this.peers.observe((function(t){var e=r.getPeers();n(e,"peer")})),this.cursors.observe((function(t){var e=r.getPeers();n(r.getCursors(e),"cursor")})),this.quizzes.on("change",(function(t){var e=r.getUpdates(r.quizzes,t);e&&n(e,"quiz")})),this.surveys.on("change",(function(t){var e=r.getUpdates(r.surveys,t);e&&n(e,"survey")})),this.chat.on("change",(function(t){var e,r=[],i=!0,o=!1,u=void 0;try{for(var c,s=t[Symbol.iterator]();!(i=(c=s.next()).done);i=!0){var l=(0,a.default)(c.value,2),f=l[0],d=l[1];"add"===d.action&&((e=d.newValue).id=parseInt(f),r.push(e))}}catch(t){o=!0,u=t}finally{try{i||null==s.return||s.return()}finally{if(o)throw u}}r.length>0&&n(r,"chat")})),this.codes.observeDeep((function(t){var e=new Set,i=!0,o=!1,u=void 0;try{for(var c,s=t[Symbol.iterator]();!(i=(c=s.next()).done);i=!0){var l=c.value.currentTarget.keys(),f=!0,d=!1,h=void 0;try{for(var v,g=l[Symbol.iterator]();!(f=(v=g.next()).done);f=!0){var p=v.value;try{var y=(0,a.default)(JSON.parse(p),1)[0];e.add(y)}catch(t){}}}catch(t){d=!0,h=t}finally{try{f||null==g.return||g.return()}finally{if(d)throw h}}}}catch(t){o=!0,u=t}finally{try{i||null==s.return||s.return()}finally{if(o)throw u}}e.size>0&&n(r.getCode(e),"code")}))),this.peers.set(e,!0)}return(0,o.default)(t,[{key:"init",value:function(t){var e=this;this.length=Math.max(this.length,t.length);var n=this;this.doc.transact((function(){for(var r=0;r<t.length;r++)n.initMap(e.quizzes,r,t[r].q),n.initMap(e.surveys,r,t[r].s),n.initText(r,t[r].c)}),this.peerID)}},{key:"encode",value:function(){return c.encodeStateAsUpdate(this.doc)}},{key:"destroy",value:function(){this.doc.destroy()}},{key:"applyUpdate",value:function(t){var e=this;this.doc.transact((function(){!1===e.peers.get(e.peerID)&&e.peers.set(e.peerID,!0),c.applyUpdate(e.doc,t)}))}},{key:"log",value:function(){console.warn("*********** PEERS ***********"),console.warn(this.peers.toJSON()),console.warn("*********** STATE ***********"),console.warn(this.doc.toJSON())}},{key:"initMap",value:function(t,e,n){if(0!==n.length)for(var r,i=0;i<n.length;i++){for(var o in(r=t.get(this.id(e,i)))||(r={}),n[i])r[o]=n[i][o];t.set(this.id(e,i),r)}}},{key:"initText",value:function(t,e){if(0!==e.length)for(var n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)this.initCode(t,n,r,e[n][r])}},{key:"diff",value:function(t){return c.encodeStateAsUpdate(this.doc,t)}},{key:"getCode",value:function(t){var e=[],n=!0,r=!1,i=void 0;try{for(var o,u=t[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var a=o.value;e.push({id:a,data:this.getAllTexts(a)})}}catch(t){r=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(r)throw i}}return e}},{key:"getCursors",value:function(t){var e=[],n=this.cursors.toJSON(),r=!0,i=!1,o=void 0;try{for(var u,a=t[Symbol.iterator]();!(r=(u=a.next()).done);r=!0){var c=u.value;c!==this.peerID&&void 0!==n[c]&&e.push(n[c])}}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return e}},{key:"getPeers",value:function(){var t=this.peers.toJSON();return t?Object.entries(t).filter((function(t){var e=(0,a.default)(t,2);return e[0],e[1]})).map((function(t){var e=(0,a.default)(t,2),n=e[0];return e[1],n})):[]}},{key:"removePeer",value:function(t){var e=this;this.doc.transact((function(){e.peers.set(t||e.peerID,!1)})),void 0===t&&this.callback(this.encode(),"exit")}},{key:"id",value:function(t,e,n){return void 0===n?JSON.stringify([t,e]):JSON.stringify([t,e,n])}},{key:"getMap",value:function(t,e,n){return this.doc.getMap(this.id(e,n))}},{key:"getAllMaps",value:function(t){for(var e=[],n=0;n<this.length;n++){for(var r=[],i=0;t.has(this.id(n,i));i++)r.push(t.get(this.id(n,i)));e.push(r)}return e}},{key:"getMaps",value:function(t,e){for(var n=[],r=0;e.has(this.id(t,r));r++)n.push(e.get(this.id(t,r)));return n}},{key:"getAllTexts",value:function(t){for(var e,n=[],r=0;this.codes.has(this.id(t,r,0));r++){for(var i=[],o=0;this.codes.has(this.id(t,r,o));o++)e=this.codes.get(this.id(t,r,o)),i.push((null==e?void 0:e.toString())||"");n.push(i)}return n}},{key:"addQuiz",value:function(t,e,n){this.addRecord(this.quizzes,t,e,n)}},{key:"addSurvey",value:function(t,e,n){this.addRecord(this.surveys,t,e,n)}},{key:"addRecord",value:function(t,e,n,r){var i=t.get(this.id(e,n));i||(i={}),i[this.peerID]=r,t.set(this.id(e,n),i)}},{key:"initCode",value:function(t,e,n,r){if(!this.codes.has(this.id(t,e,n))){var i=this.doc.clientID;this.doc.clientID=0;var o=new c.Text;o.insert(0,r),this.codes.set(this.id(t,e,n),o),this.doc.clientID=i}}},{key:"addChatMessage",value:function(t){this.chat.set(""+Date.now(),{color:this.getColor(),message:t,user:this.peerID})}},{key:"updateCode",value:function(t,e,n,r){var i=this;this.codes.has(this.id(t,e,n))&&this.doc.transact((function(){var o=i.codes.get(i.id(t,e,n));if(void 0!==o){var u=!0,a=!1,c=void 0;try{for(var s,l=r[Symbol.iterator]();!(u=(s=l.next()).done);u=!0){var f=s.value;switch(f.action){case"insert":o.insert(f.index,f.content);break;case"remove":o.delete(f.index,f.content.length);break;default:console.warn("Sync code, unknown action ->",f)}}}catch(t){a=!0,c=t}finally{try{u||null==l.return||l.return()}finally{if(a)throw c}}}}),"code")}},{key:"getColor",value:function(){return this.color||(this.color=s.getColorFor(this.peerID)),this.color}},{key:"setCursor",value:function(t,e){var n=this;this.doc.transact((function(){n.cursors.set(n.peerID,{id:n.peerID,section:t,project:e.project,file:e.file,state:e.state,color:n.getColor()})}),"cursor")}},{key:"removeCursor",value:function(){this.cursors.delete(this.peerID)}},{key:"getUpdates",value:function(t,e){var n=new Set,r=[],i=!0,o=!1,c=void 0;try{for(var s,l=e[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var f=(0,a.default)(s.value,2),d=f[0],h=f[1];switch(h.action){case"update":if(JSON.stringify(Object.keys(h.oldValue).sort())!==JSON.stringify(Object.keys(h.newValue).sort())){r.push([d,(0,u.default)({},h.oldValue,h.newValue)]);continue}case"add":try{var v=(0,a.default)(JSON.parse(d),1)[0];n.add(v)}catch(t){}}}}catch(t){o=!0,c=t}finally{try{i||null==l.return||l.return()}finally{if(o)throw c}}var g=[],p=!0,y=!1,k=void 0;try{for(var w,m=n[Symbol.iterator]();!(p=(w=m.next()).done);p=!0){var b=w.value;g.push({id:b,data:this.getMaps(b,t)})}}catch(t){y=!0,k=t}finally{try{p||null==m.return||m.return()}finally{if(y)throw k}}var _=!0,S=!1,x=void 0;try{for(var E,D=r[Symbol.iterator]();!(_=(E=D.next()).done);_=!0){var C=(0,a.default)(E.value,2),U=C[0],A=C[1];t.set(U,A)}}catch(t){S=!0,x=t}finally{try{_||null==D.return||D.return()}finally{if(S)throw x}}return g.length>0?g:null}}]),t}()})),n.register("bymyA",(function(r,i){t(r.exports,"Doc",(function(){return Y})),t(r.exports,"Text",(function(){return Pe})),t(r.exports,"applyUpdate",(function(){return ct})),t(r.exports,"encodeStateAsUpdate",(function(){return lt}));var o=n("f1evb"),u=n("9Klpk"),a=n("3bWnf"),c=n("eT7f3"),s=n("9WzNc"),l=n("div3d"),f=n("kb0qF"),d=n("bgoEC"),h=n("7j4mF"),v=n("5ENmm"),g=n("6Wo7Q"),p=n("bWNdT"),y=n("32Euv"),k=n("l6jCY"),w=n("7qPwo"),m=n("3db39"),b=n("lOVDE"),_=n("iwMp2"),S=n("i9WxE"),x=n("8C35u"),E=n("3bx5p"),D=n("jKUB9"),C=n("9eXpO"),U=n("hrH1s"),A=n("dNOud"),I=(A=n("dNOud"),n("iitZb")),T=n("b0TDd"),O=n("byQoJ"),V=(n("c01oj"),n("ktjib"),n("2EkIU")),N=n("7ke8k"),M=(k.Observable,function t(e,n){"use strict";(0,u.default)(this,t),this.clock=e,this.len=n}),R=function t(){"use strict";(0,u.default)(this,t),this.clients=new Map},B=function(t,e,n){return e.clients.forEach((function(e,r){for(var i=t.doc.store.clients.get(r),o=0;o<e.length;o++){var u=e[o];Ot(t,i,u.clock,u.len,n)}}))},L=function(t,e){var n=t.clients.get(e.client);return void 0!==n&&null!==function(t,e){for(var n=0,r=t.length-1;n<=r;){var i=m.floor((n+r)/2),o=t[i],u=o.clock;if(u<=e){if(e<u+o.len)return i;n=i+1}else r=i-1}return null}(n,e.clock)},j=function(t){t.clients.forEach((function(t){var e,n;for(t.sort((function(t,e){return t.clock-e.clock})),e=1,n=1;e<t.length;e++){var r=t[n-1],i=t[e];r.clock+r.len>=i.clock?r.len=m.max(r.len,i.clock+i.len-r.clock):(n<e&&(t[n]=i),n++)}t.length=n}))},P=function(t){for(var e=function(e){t[e].clients.forEach((function(r,i){if(!n.clients.has(i)){for(var o=r.slice(),u=e+1;u<t.length;u++)w.appendTo(o,t[u].clients.get(i)||[]);n.clients.set(i,o)}}))},n=new R,r=0;r<t.length;r++)e(r);return j(n),n},J=function(t,e,n,r){b.setIfUndefined(t.clients,e,(function(){return[]})).push(new M(n,r))},F=function(){return new R},W=function(t){var e=F();return t.clients.forEach((function(t,n){for(var r=[],i=0;i<t.length;i++){var o=t[i];if(o.deleted){var u=o.id.clock,a=o.length;if(i+1<t.length)for(var c=t[i+1];i+1<t.length&&c.deleted;c=t[1+ ++i])a+=c.length;r.push(new M(u,a))}}r.length>0&&e.clients.set(n,r)})),e},z=function(t,e){_.writeVarUint(t.restEncoder,e.clients.size),w.from(e.clients.entries()).sort((function(t,e){return e[0]-t[0]})).forEach((function(e){var n=(0,v.default)(e,2),r=n[0],i=n[1];t.resetDsCurVal(),_.writeVarUint(t.restEncoder,r);var o=i.length;_.writeVarUint(t.restEncoder,o);for(var u=0;u<o;u++){var a=i[u];t.writeDsClock(a.clock),t.writeDsLen(a.len)}}))},q=function(t){for(var e=function(e){t.resetDsCurVal();var r=S.readVarUint(t.restDecoder),i=S.readVarUint(t.restDecoder);if(i>0)for(var o=b.setIfUndefined(n.clients,r,(function(){return[]})),u=0;u<i;u++)o.push(new M(t.readDsClock(),t.readDsLen()))},n=new R,r=S.readVarUint(t.restDecoder),i=0;i<r;i++)e();return n},K=function(t,e,n){for(var r=new R,i=S.readVarUint(t.restDecoder),o=0;o<i;o++){t.resetDsCurVal();for(var u=S.readVarUint(t.restDecoder),a=S.readVarUint(t.restDecoder),c=n.clients.get(u)||[],s=Et(n,u),l=0;l<a;l++){var f=t.readDsClock(),d=f+t.readDsLen();if(f<s){s<d&&J(r,u,s,d-s);var h=Ct(c,f),v=c[h];for(!v.deleted&&v.id.clock<f&&(c.splice(h+1,0,vn(e,v,f-v.id.clock)),h++);h<c.length&&(v=c[h++]).id.clock<d;)v.deleted||(d<v.id.clock+v.length&&c.splice(h,0,vn(e,v,d-v.id.clock)),v.delete(e))}else J(r,u,f,d-f)}}if(r.clients.size>0){var g=new nt;return _.writeVarUint(g.restEncoder,0),z(g,r),g.toUint8Array()}return null},Q=x.uint32,Y=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r.guid,a=void 0===i?x.uuidv4():i,c=r.collectionid,s=void 0===c?null:c,l=r.gc,f=void 0===l||l,d=r.gcFilter,h=void 0===d?function(){return!0}:d,v=r.meta,g=void 0===v?null:v,p=r.autoLoad,y=void 0!==p&&p,k=r.shouldLoad,w=void 0===k||k;(0,u.default)(this,n),(t=e.call(this)).gc=f,t.gcFilter=h,t.clientID=Q(),t.guid=a,t.collectionid=s,t.share=new Map,t.store=new St,t._transaction=null,t._transactionCleanups=[],t.subdocs=new Set,t._item=null,t.shouldLoad=w,t.autoLoad=y,t.meta=g,t.isLoaded=!1,t.isSynced=!1,t.whenLoaded=E.create((function(e){t.on("load",(function(){t.isLoaded=!0,e((0,o.default)(t))}))}));var m=function(){return E.create((function(e){var n=function(r){void 0!==r&&!0!==r||(t.off("sync",n),e())};t.on("sync",n)}))};return t.on("sync",(function(e){!1===e&&t.isSynced&&(t.whenSynced=m()),t.isSynced=void 0===e||!0===e,t.isSynced&&!t.isLoaded&&t.emit("load",[])})),t.whenSynced=m(),t}return(0,a.default)(n,[{key:"load",value:function(){var t=this,e=this._item;null===e||this.shouldLoad||jt(e.parent.doc,(function(e){e.subdocsLoaded.add(t)}),null,!0),this.shouldLoad=!0}},{key:"getSubdocs",value:function(){return this.subdocs}},{key:"getSubdocGuids",value:function(){return new Set(w.from(this.subdocs).map((function(t){return t.guid})))}},{key:"transact",value:function(t){return jt(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)}},{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oe,n=this,r=b.setIfUndefined(this.share,t,(function(){var t=new e;return t._integrate(n,null),t})),i=r.constructor;if(e!==oe&&i!==e){if(i===oe){var o=new e;o._map=r._map,r._map.forEach((function(t){for(;null!==t;t=t.left)t.parent=o})),o._start=r._start;for(var u=o._start;null!==u;u=u.right)u.parent=o;return o._length=r._length,this.share.set(t,o),o._integrate(this,null),o}throw new Error("Type with the name ".concat(t," has already been defined with a different constructor"))}return r}},{key:"getArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(t,_e)}},{key:"getText",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(t,Pe)}},{key:"getMap",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(t,xe)}},{key:"getXmlElement",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(t,We)}},{key:"getXmlFragment",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(t,Fe)}},{key:"toJSON",value:function(){var t={};return this.share.forEach((function(e,n){t[n]=e.toJSON()})),t}},{key:"destroy",value:function(){var t=this;w.from(this.subdocs).forEach((function(t){return t.destroy()}));var e=this._item;if(null!==e){this._item=null;var r=e.content;r.doc=new n((0,h.default)((0,d.default)({guid:this.guid},r.opts),{shouldLoad:!1})),r.doc._item=e,jt(e.parent.doc,(function(n){var i=r.doc;e.deleted||n.subdocsAdded.add(i),n.subdocsRemoved.add(t)}),null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),(0,s.default)((0,l.default)(n.prototype),"destroy",this).call(this)}},{key:"on",value:function(t,e){(0,s.default)((0,l.default)(n.prototype),"on",this).call(this,t,e)}},{key:"off",value:function(t,e){(0,s.default)((0,l.default)(n.prototype),"off",this).call(this,t,e)}}]),n}(k.Observable),H=function(){"use strict";function t(e){(0,u.default)(this,t),this.restDecoder=e}return(0,a.default)(t,[{key:"resetDsCurVal",value:function(){}},{key:"readDsClock",value:function(){return S.readVarUint(this.restDecoder)}},{key:"readDsLen",value:function(){return S.readVarUint(this.restDecoder)}}]),t}(),G=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(){return(0,u.default)(this,n),e.apply(this,arguments)}return(0,a.default)(n,[{key:"readLeftID",value:function(){return wt(S.readVarUint(this.restDecoder),S.readVarUint(this.restDecoder))}},{key:"readRightID",value:function(){return wt(S.readVarUint(this.restDecoder),S.readVarUint(this.restDecoder))}},{key:"readClient",value:function(){return S.readVarUint(this.restDecoder)}},{key:"readInfo",value:function(){return S.readUint8(this.restDecoder)}},{key:"readString",value:function(){return S.readVarString(this.restDecoder)}},{key:"readParentInfo",value:function(){return 1===S.readVarUint(this.restDecoder)}},{key:"readTypeRef",value:function(){return S.readVarUint(this.restDecoder)}},{key:"readLen",value:function(){return S.readVarUint(this.restDecoder)}},{key:"readAny",value:function(){return S.readAny(this.restDecoder)}},{key:"readBuf",value:function(){return D.copyUint8Array(S.readVarUint8Array(this.restDecoder))}},{key:"readJSON",value:function(){return JSON.parse(S.readVarString(this.restDecoder))}},{key:"readKey",value:function(){return S.readVarString(this.restDecoder)}}]),n}(H),X=function(){"use strict";function t(e){(0,u.default)(this,t),this.dsCurrVal=0,this.restDecoder=e}return(0,a.default)(t,[{key:"resetDsCurVal",value:function(){this.dsCurrVal=0}},{key:"readDsClock",value:function(){return this.dsCurrVal+=S.readVarUint(this.restDecoder),this.dsCurrVal}},{key:"readDsLen",value:function(){var t=S.readVarUint(this.restDecoder)+1;return this.dsCurrVal+=t,t}}]),t}(),Z=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(t){var r;return(0,u.default)(this,n),(r=e.call(this,t)).keys=[],S.readVarUint(t),r.keyClockDecoder=new S.IntDiffOptRleDecoder(S.readVarUint8Array(t)),r.clientDecoder=new S.UintOptRleDecoder(S.readVarUint8Array(t)),r.leftClockDecoder=new S.IntDiffOptRleDecoder(S.readVarUint8Array(t)),r.rightClockDecoder=new S.IntDiffOptRleDecoder(S.readVarUint8Array(t)),r.infoDecoder=new S.RleDecoder(S.readVarUint8Array(t),S.readUint8),r.stringDecoder=new S.StringDecoder(S.readVarUint8Array(t)),r.parentInfoDecoder=new S.RleDecoder(S.readVarUint8Array(t),S.readUint8),r.typeRefDecoder=new S.UintOptRleDecoder(S.readVarUint8Array(t)),r.lenDecoder=new S.UintOptRleDecoder(S.readVarUint8Array(t)),r}return(0,a.default)(n,[{key:"readLeftID",value:function(){return new yt(this.clientDecoder.read(),this.leftClockDecoder.read())}},{key:"readRightID",value:function(){return new yt(this.clientDecoder.read(),this.rightClockDecoder.read())}},{key:"readClient",value:function(){return this.clientDecoder.read()}},{key:"readInfo",value:function(){return this.infoDecoder.read()}},{key:"readString",value:function(){return this.stringDecoder.read()}},{key:"readParentInfo",value:function(){return 1===this.parentInfoDecoder.read()}},{key:"readTypeRef",value:function(){return this.typeRefDecoder.read()}},{key:"readLen",value:function(){return this.lenDecoder.read()}},{key:"readAny",value:function(){return S.readAny(this.restDecoder)}},{key:"readBuf",value:function(){return S.readVarUint8Array(this.restDecoder)}},{key:"readJSON",value:function(){return S.readAny(this.restDecoder)}},{key:"readKey",value:function(){var t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];var e=this.stringDecoder.read();return this.keys.push(e),e}}]),n}(X),$=function(){"use strict";function t(){(0,u.default)(this,t),this.restEncoder=_.createEncoder()}return(0,a.default)(t,[{key:"toUint8Array",value:function(){return _.toUint8Array(this.restEncoder)}},{key:"resetDsCurVal",value:function(){}},{key:"writeDsClock",value:function(t){_.writeVarUint(this.restEncoder,t)}},{key:"writeDsLen",value:function(t){_.writeVarUint(this.restEncoder,t)}}]),t}(),tt=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(){return(0,u.default)(this,n),e.apply(this,arguments)}return(0,a.default)(n,[{key:"writeLeftID",value:function(t){_.writeVarUint(this.restEncoder,t.client),_.writeVarUint(this.restEncoder,t.clock)}},{key:"writeRightID",value:function(t){_.writeVarUint(this.restEncoder,t.client),_.writeVarUint(this.restEncoder,t.clock)}},{key:"writeClient",value:function(t){_.writeVarUint(this.restEncoder,t)}},{key:"writeInfo",value:function(t){_.writeUint8(this.restEncoder,t)}},{key:"writeString",value:function(t){_.writeVarString(this.restEncoder,t)}},{key:"writeParentInfo",value:function(t){_.writeVarUint(this.restEncoder,t?1:0)}},{key:"writeTypeRef",value:function(t){_.writeVarUint(this.restEncoder,t)}},{key:"writeLen",value:function(t){_.writeVarUint(this.restEncoder,t)}},{key:"writeAny",value:function(t){_.writeAny(this.restEncoder,t)}},{key:"writeBuf",value:function(t){_.writeVarUint8Array(this.restEncoder,t)}},{key:"writeJSON",value:function(t){_.writeVarString(this.restEncoder,JSON.stringify(t))}},{key:"writeKey",value:function(t){_.writeVarString(this.restEncoder,t)}}]),n}($),et=function(){"use strict";function t(){(0,u.default)(this,t),this.restEncoder=_.createEncoder(),this.dsCurrVal=0}return(0,a.default)(t,[{key:"toUint8Array",value:function(){return _.toUint8Array(this.restEncoder)}},{key:"resetDsCurVal",value:function(){this.dsCurrVal=0}},{key:"writeDsClock",value:function(t){var e=t-this.dsCurrVal;this.dsCurrVal=t,_.writeVarUint(this.restEncoder,e)}},{key:"writeDsLen",value:function(t){0===t&&C.unexpectedCase(),_.writeVarUint(this.restEncoder,t-1),this.dsCurrVal+=t}}]),t}(),nt=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(){var t;return(0,u.default)(this,n),(t=e.call(this)).keyMap=new Map,t.keyClock=0,t.keyClockEncoder=new _.IntDiffOptRleEncoder,t.clientEncoder=new _.UintOptRleEncoder,t.leftClockEncoder=new _.IntDiffOptRleEncoder,t.rightClockEncoder=new _.IntDiffOptRleEncoder,t.infoEncoder=new _.RleEncoder(_.writeUint8),t.stringEncoder=new _.StringEncoder,t.parentInfoEncoder=new _.RleEncoder(_.writeUint8),t.typeRefEncoder=new _.UintOptRleEncoder,t.lenEncoder=new _.UintOptRleEncoder,t}return(0,a.default)(n,[{key:"toUint8Array",value:function(){var t=_.createEncoder();return _.writeVarUint(t,0),_.writeVarUint8Array(t,this.keyClockEncoder.toUint8Array()),_.writeVarUint8Array(t,this.clientEncoder.toUint8Array()),_.writeVarUint8Array(t,this.leftClockEncoder.toUint8Array()),_.writeVarUint8Array(t,this.rightClockEncoder.toUint8Array()),_.writeVarUint8Array(t,_.toUint8Array(this.infoEncoder)),_.writeVarUint8Array(t,this.stringEncoder.toUint8Array()),_.writeVarUint8Array(t,_.toUint8Array(this.parentInfoEncoder)),_.writeVarUint8Array(t,this.typeRefEncoder.toUint8Array()),_.writeVarUint8Array(t,this.lenEncoder.toUint8Array()),_.writeUint8Array(t,_.toUint8Array(this.restEncoder)),_.toUint8Array(t)}},{key:"writeLeftID",value:function(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}},{key:"writeRightID",value:function(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}},{key:"writeClient",value:function(t){this.clientEncoder.write(t)}},{key:"writeInfo",value:function(t){this.infoEncoder.write(t)}},{key:"writeString",value:function(t){this.stringEncoder.write(t)}},{key:"writeParentInfo",value:function(t){this.parentInfoEncoder.write(t?1:0)}},{key:"writeTypeRef",value:function(t){this.typeRefEncoder.write(t)}},{key:"writeLen",value:function(t){this.lenEncoder.write(t)}},{key:"writeAny",value:function(t){_.writeAny(this.restEncoder,t)}},{key:"writeBuf",value:function(t){_.writeVarUint8Array(this.restEncoder,t)}},{key:"writeJSON",value:function(t){_.writeAny(this.restEncoder,t)}},{key:"writeKey",value:function(t){var e=this.keyMap.get(t);void 0===e?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(e)}}]),n}(et),rt=function(t,e,n){var r=new Map;n.forEach((function(t,n){Et(e,n)>t&&r.set(n,t)})),xt(e).forEach((function(t,e){n.has(e)||r.set(e,0)})),_.writeVarUint(t.restEncoder,r.size),w.from(r.entries()).sort((function(t,e){return e[0]-t[0]})).forEach((function(n){var r=(0,v.default)(n,2),i=r[0],o=r[1];!function(t,e,n,r){r=m.max(r,e[0].id.clock);var i=Ct(e,r);_.writeVarUint(t.restEncoder,e.length-i),t.writeClient(n),_.writeVarUint(t.restEncoder,r);var o=e[i];o.write(t,r-o.id.clock);for(var u=i+1;u<e.length;u++)e[u].write(t,0)}(t,e.clients.get(i),i,o)}))},it=function(t,e){for(var n=b.create(),r=S.readVarUint(t.restDecoder),i=0;i<r;i++){var o=S.readVarUint(t.restDecoder),u=new Array(o),a=t.readClient(),c=S.readVarUint(t.restDecoder);n.set(a,{i:0,refs:u});for(var s=0;s<o;s++){var l=t.readInfo();switch(U.BITS5&l){case 0:var f=t.readLen();u[s]=new Ye(wt(a,c),f),c+=f;break;case 10:var d=S.readVarUint(t.restDecoder);u[s]=new kn(wt(a,c),d),c+=d;break;default:var h=0==(l&(U.BIT7|U.BIT8)),v=new gn(wt(a,c),null,(l&U.BIT8)===U.BIT8?t.readLeftID():null,null,(l&U.BIT7)===U.BIT7?t.readRightID():null,h?t.readParentInfo()?e.get(t.readString()):t.readLeftID():null,h&&(l&U.BIT6)===U.BIT6?t.readString():null,pn(t,l));u[s]=v,c+=v.length}}}return n},ot=function(t,e,n){var r=[],i=w.from(n.keys()).sort((function(t,e){return t-e}));if(0===i.length)return null;var o=function(){if(0===i.length)return null;for(var t=n.get(i[i.length-1]);t.refs.length===t.i;){if(i.pop(),!(i.length>0))return null;t=n.get(i[i.length-1])}return t},u=o();if(null===u)return null;for(var a=new St,c=new Map,s=function(t,e){var n=c.get(t);(null==n||n>e)&&c.set(t,e)},l=u.refs[u.i++],f=new Map,d=function(){var t=!0,e=!1,o=void 0;try{for(var u,c=function(){var t=u.value,e=t.id.client,r=n.get(e);r?(r.i--,a.clients.set(e,r.refs.slice(r.i)),n.delete(e),r.i=0,r.refs=[]):a.clients.set(e,[t]),i=i.filter((function(t){return t!==e}))},s=r[Symbol.iterator]();!(t=(u=s.next()).done);t=!0)c()}catch(t){e=!0,o=t}finally{try{t||null==s.return||s.return()}finally{if(e)throw o}}r.length=0};;){if(l.constructor!==kn){var h=b.setIfUndefined(f,l.id.client,(function(){return Et(e,l.id.client)}))-l.id.clock;if(h<0)r.push(l),s(l.id.client,l.id.clock-1),d();else{var v=l.getMissing(t,e);if(null!==v){r.push(l);var g=n.get(v)||{refs:[],i:0};if(g.refs.length!==g.i){l=g.refs[g.i++];continue}s(v,Et(e,v)),d()}else(0===h||h<l.length)&&(l.integrate(t,h),f.set(l.id.client,l.id.clock+l.length))}}if(r.length>0)l=r.pop();else if(null!==u&&u.i<u.refs.length)l=u.refs[u.i++];else{if(null===(u=o()))break;l=u.refs[u.i++]}}if(a.clients.size>0){var p=new nt;return rt(p,a,new Map),_.writeVarUint(p.restEncoder,0),{missing:c,update:p.toUint8Array()}}return null},ut=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Z(t);return jt(e,(function(t){t.local=!1;var e=!1,n=t.doc,i=n.store,o=it(r,n),u=ot(t,i,o),a=i.pendingStructs;if(a){var c=!0,s=!1,l=void 0;try{for(var f,d=a.missing[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var h=(0,v.default)(f.value,2),g=h[0];if(h[1]<Et(i,g)){e=!0;break}}}catch(t){s=!0,l=t}finally{try{c||null==d.return||d.return()}finally{if(s)throw l}}if(u){var p=!0,y=!1,k=void 0;try{for(var w,m=u.missing[Symbol.iterator]();!(p=(w=m.next()).done);p=!0){var b=(0,v.default)(w.value,2),_=b[0],x=b[1],E=a.missing.get(_);(null==E||E>x)&&a.missing.set(_,x)}}catch(t){y=!0,k=t}finally{try{p||null==m.return||m.return()}finally{if(y)throw k}}a.update=zt([a.update,u.update])}}else i.pendingStructs=u;var D=K(r,t,i);if(i.pendingDs){var C=new Z(S.createDecoder(i.pendingDs));S.readVarUint(C.restDecoder);var U=K(C,t,i);i.pendingDs=D&&U?zt([D,U]):D||U}else i.pendingDs=D;if(e){var A=i.pendingStructs.update;i.pendingStructs=null,at(t.doc,A)}}),n,!1)},at=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Z,i=S.createDecoder(e);ut(i,t,n,new r(i))},ct=function(t,e,n){return at(t,e,n,G)},st=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map;rt(t,e.store,n),z(t,W(e.store))},lt=function(t,e){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint8Array([0]),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new nt,r=ft(e);st(n,t,r);var i=[n.toUint8Array()];if(t.store.pendingDs&&i.push(t.store.pendingDs),t.store.pendingStructs&&i.push(qt(t.store.pendingStructs.update,e)),i.length>1){if(n.constructor===tt)return Ft(i.map((function(t,e){return 0===e?t:Ht(t)})));if(n.constructor===nt)return zt(i)}return i[0]}(t,e,new tt)},ft=function(t){return function(t){for(var e=new Map,n=S.readVarUint(t.restDecoder),r=0;r<n;r++){var i=S.readVarUint(t.restDecoder),o=S.readVarUint(t.restDecoder);e.set(i,o)}return e}(new H(S.createDecoder(t)))},dt=function t(){"use strict";(0,u.default)(this,t),this.l=[]},ht=function(){return new dt},vt=function(t,e){return t.l.push(e)},gt=function(t,e){var n=t.l,r=n.length;t.l=n.filter((function(t){return e!==t})),r===t.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},pt=function(t,e,n){return A.callAll(t.l,[e,n])},yt=function t(e,n){"use strict";(0,u.default)(this,t),this.client=e,this.clock=n},kt=function(t,e){return t===e||null!==t&&null!==e&&t.client===e.client&&t.clock===e.clock},wt=function(t,e){return new yt(t,e)},mt=function t(e,n){"use strict";(0,u.default)(this,t),this.ds=e,this.sv=n},bt=(function(t,e){new mt(t,e)}(F(),new Map),function(t,e){return void 0===e?!t.deleted:e.sv.has(t.id.client)&&(e.sv.get(t.id.client)||0)>t.id.clock&&!L(e.ds,t.id)}),_t=function(t,e){var n=b.setIfUndefined(t.meta,_t,I.create),r=t.doc.store;n.has(e)||(e.sv.forEach((function(e,n){e<Et(r,n)&&It(t,wt(n,e))})),B(t,e.ds,(function(t){})),n.add(e))},St=function t(){"use strict";(0,u.default)(this,t),this.clients=new Map,this.pendingStructs=null,this.pendingDs=null},xt=function(t){var e=new Map;return t.clients.forEach((function(t,n){var r=t[t.length-1];e.set(n,r.id.clock+r.length)})),e},Et=function(t,e){var n=t.clients.get(e);if(void 0===n)return 0;var r=n[n.length-1];return r.id.clock+r.length},Dt=function(t,e){var n=t.clients.get(e.id.client);if(void 0===n)n=[],t.clients.set(e.id.client,n);else{var r=n[n.length-1];if(r.id.clock+r.length!==e.id.clock)throw C.unexpectedCase()}n.push(e)},Ct=function(t,e){var n=0,r=t.length-1,i=t[r],o=i.id.clock;if(o===e)return r;for(var u=m.floor(e/(o+i.length-1)*r);n<=r;){if((o=(i=t[u]).id.clock)<=e){if(e<o+i.length)return u;n=u+1}else r=u-1;u=m.floor((n+r)/2)}throw C.unexpectedCase()},Ut=function(t,e){var n=t.clients.get(e.client);return n[Ct(n,e.clock)]},At=function(t,e,n){var r=Ct(e,n),i=e[r];return i.id.clock<n&&i instanceof gn?(e.splice(r+1,0,vn(t,i,n-i.id.clock)),r+1):r},It=function(t,e){var n=t.doc.store.clients.get(e.client);return n[At(t,n,e.clock)]},Tt=function(t,e,n){var r=e.clients.get(n.client),i=Ct(r,n.clock),o=r[i];return n.clock!==o.id.clock+o.length-1&&o.constructor!==Ye&&r.splice(i+1,0,vn(t,o,n.clock-o.id.clock+1)),o},Ot=function(t,e,n,r,i){if(0!==r){var o,u=n+r,a=At(t,e,n);do{u<(o=e[a++]).id.clock+o.length&&At(t,e,u),i(o)}while(a<e.length&&e[a].id.clock<u)}},Vt=function t(e,n,r){"use strict";(0,u.default)(this,t),this.doc=e,this.deleteSet=new R,this.beforeState=xt(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1},Nt=function(t,e){return!(0===e.deleteSet.clients.size&&!b.any(e.afterState,(function(t,n){return e.beforeState.get(n)!==t}))||(j(e.deleteSet),function(t,e){rt(t,e.doc.store,e.beforeState)}(t,e),z(t,e.deleteSet),0))},Mt=function(t,e,n){var r=e._item;(null===r||r.id.clock<(t.beforeState.get(r.id.client)||0)&&!r.deleted)&&b.setIfUndefined(t.changed,e,I.create).add(n)},Rt=function(t,e){for(var n=t[e],r=t[e-1],i=e;i>0&&r.deleted===n.deleted&&r.constructor===n.constructor&&r.mergeWith(n);n=r,r=t[--i-1])n instanceof gn&&null!==n.parentSub&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,r);var o=e-i;return o&&t.splice(e+1-o,o),o},Bt=function(t,e,n){var r=!0,i=!1,o=void 0;try{for(var u,a=t.clients.entries()[Symbol.iterator]();!(r=(u=a.next()).done);r=!0)for(var c=(0,v.default)(u.value,2),s=c[0],l=c[1],f=e.clients.get(s),d=l.length-1;d>=0;d--)for(var h=l[d],g=h.clock+h.len,p=Ct(f,h.clock),y=f[p];p<f.length&&y.id.clock<g;y=f[++p]){var k=f[p];if(h.clock+h.len<=k.id.clock)break;k instanceof gn&&k.deleted&&!k.keep&&n(k)&&k.gc(e,!1)}}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}},Lt=function(t,e){if(e<t.length){var n=t[e],r=n.doc,i=r.store,o=n.deleteSet,u=n._mergeStructs;try{j(o),n.afterState=xt(n.doc.store),r.emit("beforeObserverCalls",[n,r]);var a=[];n.changed.forEach((function(t,e){return a.push((function(){null!==e._item&&e._item.deleted||e._callObserver(n,t)}))})),a.push((function(){n.changedParentTypes.forEach((function(t,e){e._dEH.l.length>0&&(null===e._item||!e._item.deleted)&&((t=t.filter((function(t){return null===t.target._item||!t.target._item.deleted}))).forEach((function(t){t.currentTarget=e,t._path=null})),t.sort((function(t,e){return t.path.length-e.path.length})),pt(e._dEH,t,n))}))})),a.push((function(){return r.emit("afterTransaction",[n,r])})),(0,A.callAll)(a,[]),n._needFormattingCleanup&&Be(n)}finally{r.gc&&Bt(o,i,r.gcFilter),function(t,e){t.clients.forEach((function(t,n){for(var r=e.clients.get(n),i=t.length-1;i>=0;i--)for(var o=t[i],u=m.min(r.length-1,1+Ct(r,o.clock+o.len-1)),a=r[u];u>0&&a.id.clock>=o.clock;a=r[u])u-=1+Rt(r,u)}))}(o,i),n.afterState.forEach((function(t,e){var r=n.beforeState.get(e)||0;if(r!==t)for(var o=i.clients.get(e),u=m.max(Ct(o,r),1),a=o.length-1;a>=u;)a-=1+Rt(o,a)}));for(var c=u.length-1;c>=0;c--){var s=u[c].id,l=s.client,f=s.clock,d=i.clients.get(l),h=Ct(d,f);h+1<d.length&&Rt(d,h+1)>1||h>0&&Rt(d,h)}if(n.local||n.afterState.get(r.clientID)===n.beforeState.get(r.clientID)||(T.print(O.ORANGE,O.BOLD,"[yjs] ",O.UNBOLD,O.RED,"Changed the client-id because another client seems to be using it."),r.clientID=Q()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){var v=new tt;Nt(v,n)&&r.emit("update",[v.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){var g=new nt;Nt(g,n)&&r.emit("updateV2",[g.toUint8Array(),n.origin,r,n])}var p=n.subdocsAdded,y=n.subdocsLoaded,k=n.subdocsRemoved;(p.size>0||k.size>0||y.size>0)&&(p.forEach((function(t){t.clientID=r.clientID,null==t.collectionid&&(t.collectionid=r.collectionid),r.subdocs.add(t)})),k.forEach((function(t){return r.subdocs.delete(t)})),r.emit("subdocs",[{loaded:y,added:p,removed:k},r,n]),k.forEach((function(t){return t.destroy()}))),t.length<=e+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,t])):Lt(t,e+1)}}},jt=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=t._transactionCleanups,o=!1,u=null;null===t._transaction&&(o=!0,t._transaction=new Vt(t,n,r),i.push(t._transaction),1===i.length&&t.emit("beforeAllTransactions",[t]),t.emit("beforeTransaction",[t._transaction,t]));try{u=e(t._transaction)}finally{if(o){var a=t._transaction===i[0];t._transaction=null,a&&Lt(i,0)}}return u};k.Observable;var Pt=function(){"use strict";function t(e,n){(0,u.default)(this,t),this.gen=function(t){var e,n,r,i,o,u,a,c,s,l,f;return(0,y.__generator)(this,(function(d){switch(d.label){case 0:e=S.readVarUint(t.restDecoder),n=0,d.label=1;case 1:if(!(n<e))return[3,10];r=S.readVarUint(t.restDecoder),i=t.readClient(),o=S.readVarUint(t.restDecoder),u=0,d.label=2;case 2:return u<r?10!==(a=t.readInfo())?[3,4]:(c=S.readVarUint(t.restDecoder),[4,new kn(wt(i,o),c)]):[3,9];case 3:return d.sent(),o+=c,[3,8];case 4:return 0==(U.BITS5&a)?[3,6]:(s=0==(a&(U.BIT7|U.BIT8)),[4,l=new gn(wt(i,o),null,(a&U.BIT8)===U.BIT8?t.readLeftID():null,null,(a&U.BIT7)===U.BIT7?t.readRightID():null,s?t.readParentInfo()?t.readString():t.readLeftID():null,s&&(a&U.BIT6)===U.BIT6?t.readString():null,pn(t,a))]);case 5:return d.sent(),o+=l.length,[3,8];case 6:return f=t.readLen(),[4,new Ye(wt(i,o),f)];case 7:d.sent(),o+=f,d.label=8;case 8:return u++,[3,2];case 9:return n++,[3,1];case 10:return[2]}}))}(e),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}return(0,a.default)(t,[{key:"next",value:function(){do{this.curr=this.gen.next().value||null}while(this.filterSkips&&null!==this.curr&&this.curr.constructor===kn);return this.curr}}]),t}(),Jt=function t(e){"use strict";(0,u.default)(this,t),this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]},Ft=function(t){return zt(t,G,tt)},Wt=function(t,e){if(t.constructor===Ye){var n=t.id,r=n.client,i=n.clock;return new Ye(wt(r,i+e),t.length-e)}if(t.constructor===kn){var o=t.id,u=o.client,a=o.clock;return new kn(wt(u,a+e),t.length-e)}var c=t,s=c.id,l=s.client,f=s.clock;return new gn(wt(l,f+e),null,wt(l,f+e-1),null,c.rightOrigin,c.parent,c.parentSub,c.content.splice(e))},zt=function(t){var e=function(){if((o=o.filter((function(t){return null!==t.curr}))).sort((function(t,e){if(t.curr.id.client===e.curr.id.client){var n=t.curr.id.clock-e.curr.id.clock;return 0===n?t.curr.constructor===e.curr.constructor?0:t.curr.constructor===kn?1:-1:n}return e.curr.id.client-t.curr.id.client})),0===o.length)return"break";var t=o[0],e=t.curr.id.client;if(null!==u){for(var n=t.curr,r=!1;null!==n&&n.id.clock+n.length<=u.struct.id.clock+u.struct.length&&n.id.client>=u.struct.id.client;)n=t.next(),r=!0;if(null===n||n.id.client!==e||r&&n.id.clock>u.struct.id.clock+u.struct.length)return"continue";if(e!==u.struct.id.client)Qt(c,u.struct,u.offset),u={struct:n,offset:0},t.next();else if(u.struct.id.clock+u.struct.length<n.id.clock)if(u.struct.constructor===kn)u.struct.length=n.id.clock+n.length-u.struct.id.clock;else{Qt(c,u.struct,u.offset);var i=n.id.clock-u.struct.id.clock-u.struct.length,a=new kn(wt(e,u.struct.id.clock+u.struct.length),i);u={struct:a,offset:0}}else{var s=u.struct.id.clock+u.struct.length-n.id.clock;s>0&&(u.struct.constructor===kn?u.struct.length-=s:n=Wt(n,s)),u.struct.mergeWith(n)||(Qt(c,u.struct,u.offset),u={struct:n,offset:0},t.next())}}else u={struct:t.curr,offset:0},t.next();for(var l=t.curr;null!==l&&l.id.client===e&&l.id.clock===u.struct.id.clock+u.struct.length&&l.constructor!==kn;l=t.next())Qt(c,u.struct,u.offset),u={struct:l,offset:0}},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nt;if(1===t.length)return t[0];for(var i=t.map((function(t){return new n(S.createDecoder(t))})),o=i.map((function(t){return new Pt(t,!0)})),u=null,a=new r,c=new Jt(a);;){if("break"===e())break}null!==u&&(Qt(c,u.struct,u.offset),u=null),Yt(c);var s=i.map((function(t){return q(t)})),l=P(s);return z(a,l),a.toUint8Array()},qt=function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Z,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:nt,i=ft(e),o=new r,u=new Jt(o),a=new n(S.createDecoder(t)),c=new Pt(a,!1);c.curr;){var s=c.curr,l=s.id.client,f=i.get(l)||0;if(c.curr.constructor!==kn)if(s.id.clock+s.length>f)for(Qt(u,s,m.max(f-s.id.clock,0)),c.next();c.curr&&c.curr.id.client===l;)Qt(u,c.curr,0),c.next();else for(;c.curr&&c.curr.id.client===l&&c.curr.id.clock+c.curr.length<=f;)c.next();else c.next()}Yt(u);var d=q(a);return z(o,d),o.toUint8Array()},Kt=function(t){t.written>0&&(t.clientStructs.push({written:t.written,restEncoder:_.toUint8Array(t.encoder.restEncoder)}),t.encoder.restEncoder=_.createEncoder(),t.written=0)},Qt=function(t,e,n){t.written>0&&t.currClient!==e.id.client&&Kt(t),0===t.written&&(t.currClient=e.id.client,t.encoder.writeClient(e.id.client),_.writeVarUint(t.encoder.restEncoder,e.id.clock+n)),e.write(t.encoder,n),t.written++},Yt=function(t){Kt(t);var e=t.encoder.restEncoder;_.writeVarUint(e,t.clientStructs.length);for(var n=0;n<t.clientStructs.length;n++){var r=t.clientStructs[n];_.writeVarUint(e,r.written),_.writeUint8Array(e,r.restEncoder)}},Ht=function(t){return function(t,e,n,r){for(var i=new n(S.createDecoder(t)),o=new Pt(i,!1),u=new r,a=new Jt(u),c=o.curr;null!==c;c=o.next())Qt(a,e(c),0);Yt(a);var s=q(i);return z(u,s),u.toUint8Array()}(t,A.id,Z,tt)},Gt="You must not compute changes after the event-handler fired.",Xt=function(){"use strict";function t(e,n){(0,u.default)(this,t),this.target=e,this.currentTarget=e,this.transaction=n,this._changes=null,this._keys=null,this._delta=null,this._path=null}return(0,a.default)(t,[{key:"path",get:function(){return this._path||(this._path=Zt(this.currentTarget,this.target))}},{key:"deletes",value:function(t){return L(this.transaction.deleteSet,t.id)}},{key:"keys",get:function(){var t=this;if(null===this._keys){if(0===this.transaction.doc._transactionCleanups.length)throw C.create(Gt);var e=new Map,n=this.target;this.transaction.changed.get(n).forEach((function(r){if(null!==r){var i,o,u=n._map.get(r);if(t.adds(u)){for(var a=u.left;null!==a&&t.adds(a);)a=a.left;if(t.deletes(u)){if(null===a||!t.deletes(a))return;i="delete",o=w.last(a.content.getContent())}else null!==a&&t.deletes(a)?(i="update",o=w.last(a.content.getContent())):(i="add",o=void 0)}else{if(!t.deletes(u))return;i="delete",o=w.last(u.content.getContent())}e.set(r,{action:i,oldValue:o})}})),this._keys=e}return this._keys}},{key:"delta",get:function(){return this.changes.delta}},{key:"adds",value:function(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}},{key:"changes",get:function(){var t=this._changes;if(null===t){if(0===this.transaction.doc._transactionCleanups.length)throw C.create(Gt);var e=this.target,n=I.create(),r=I.create(),i=[];if(t={added:n,deleted:r,delta:i,keys:this.keys},this.transaction.changed.get(e).has(null)){for(var o=null,u=function(){o&&i.push(o)},a=e._start;null!==a;a=a.right)a.deleted?this.deletes(a)&&!this.adds(a)&&(null!==o&&void 0!==o.delete||(u(),o={delete:0}),o.delete+=a.length,r.add(a)):this.adds(a)?(null!==o&&void 0!==o.insert||(u(),o={insert:[]}),o.insert=o.insert.concat(a.content.getContent()),n.add(a)):(null!==o&&void 0!==o.retain||(u(),o={retain:0}),o.retain+=a.length);null!==o&&void 0===o.retain&&u()}this._changes=t}return t}}]),t}(),Zt=function(t,e){for(var n=[];null!==e._item&&e!==t;){if(null!==e._item.parentSub)n.unshift(e._item.parentSub);else{for(var r=0,i=e._item.parent._start;i!==e._item&&null!==i;)i.deleted||r++,i=i.right;n.unshift(r)}e=e._item.parent}return n},$t=0,te=function t(e,n){"use strict";(0,u.default)(this,t),e.marker=!0,this.p=e,this.index=n,this.timestamp=$t++},ee=function(t,e,n){t.p.marker=!1,t.p=e,e.marker=!0,t.index=n,t.timestamp=$t++},ne=function(t,e){if(null===t._start||0===e||null===t._searchMarker)return null;var n=0===t._searchMarker.length?null:t._searchMarker.reduce((function(t,n){return m.abs(e-t.index)<m.abs(e-n.index)?t:n})),r=t._start,i=0;for(null!==n&&(r=n.p,i=n.index,function(t){t.timestamp=$t++}(n));null!==r.right&&i<e;){if(!r.deleted&&r.countable){if(e<i+r.length)break;i+=r.length}r=r.right}for(;null!==r.left&&i>e;)!(r=r.left).deleted&&r.countable&&(i-=r.length);for(;null!==r.left&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)!(r=r.left).deleted&&r.countable&&(i-=r.length);return null!==n&&m.abs(n.index-i)<r.parent.length/80?(ee(n,r,i),n):function(t,e,n){if(t.length>=80){var r=t.reduce((function(t,e){return t.timestamp<e.timestamp?t:e}));return ee(r,e,n),r}var i=new te(e,n);return t.push(i),i}(t._searchMarker,r,i)},re=function(t,e,n){for(var r=t.length-1;r>=0;r--){var i=t[r];if(n>0){var o=i.p;for(o.marker=!1;o&&(o.deleted||!o.countable);)(o=o.left)&&!o.deleted&&o.countable&&(i.index-=o.length);if(null===o||!0===o.marker){t.splice(r,1);continue}i.p=o,o.marker=!0}(e<i.index||n>0&&e===i.index)&&(i.index=m.max(e,i.index+n))}},ie=function(t,e,n){for(var r=t,i=e.changedParentTypes;b.setIfUndefined(i,t,(function(){return[]})).push(n),null!==t._item;)t=t._item.parent;pt(r._eH,n,e)},oe=function(){"use strict";function t(){(0,u.default)(this,t),this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=ht(),this._dEH=ht(),this._searchMarker=null}return(0,a.default)(t,[{key:"parent",get:function(){return this._item?this._item.parent:null}},{key:"_integrate",value:function(t,e){this.doc=t,this._item=e}},{key:"_copy",value:function(){throw C.methodUnimplemented()}},{key:"clone",value:function(){throw C.methodUnimplemented()}},{key:"_write",value:function(t){}},{key:"_first",get:function(){for(var t=this._start;null!==t&&t.deleted;)t=t.right;return t}},{key:"_callObserver",value:function(t,e){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}},{key:"observe",value:function(t){vt(this._eH,t)}},{key:"observeDeep",value:function(t){vt(this._dEH,t)}},{key:"unobserve",value:function(t){gt(this._eH,t)}},{key:"unobserveDeep",value:function(t){gt(this._dEH,t)}},{key:"toJSON",value:function(){}}]),t}(),ue=function(t,e,n){e<0&&(e=t._length+e),n<0&&(n=t._length+n);for(var r=n-e,i=[],o=t._start;null!==o&&r>0;){if(o.countable&&!o.deleted){var u=o.content.getContent();if(u.length<=e)e-=u.length;else{for(var a=e;a<u.length&&r>0;a++)i.push(u[a]),r--;e=0}}o=o.right}return i},ae=function(t){for(var e=[],n=t._start;null!==n;){if(n.countable&&!n.deleted)for(var r=n.content.getContent(),i=0;i<r.length;i++)e.push(r[i]);n=n.right}return e},ce=function(t,e){for(var n=0,r=t._start;null!==r;){if(r.countable&&!r.deleted)for(var i=r.content.getContent(),o=0;o<i.length;o++)e(i[o],n++,t);r=r.right}},se=function(t,e){var n=[];return ce(t,(function(r,i){n.push(e(r,i,t))})),n},le=function(t,e){var n=ne(t,e),r=t._start;for(null!==n&&(r=n.p,e-=n.index);null!==r;r=r.right)if(!r.deleted&&r.countable){if(e<r.length)return r.content.getContent()[e];e-=r.length}},fe=function(t,e,n,r){var i=n,o=t.doc,u=o.clientID,a=o.store,c=null===n?e._start:n.right,s=[],l=function(){s.length>0&&((i=new gn(wt(u,Et(a,u)),i,i&&i.lastId,c,c&&c.id,e,null,new nn(s))).integrate(t,0),s=[])};r.forEach((function(n){if(null===n)s.push(n);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:s.push(n);break;default:switch(l(),n.constructor){case Uint8Array:case ArrayBuffer:(i=new gn(wt(u,Et(a,u)),i,i&&i.lastId,c,c&&c.id,e,null,new He(new Uint8Array(n)))).integrate(t,0);break;case Y:(i=new gn(wt(u,Et(a,u)),i,i&&i.lastId,c,c&&c.id,e,null,new Ze(n))).integrate(t,0);break;default:if(!(n instanceof oe))throw new Error("Unexpected content type in insert operation");(i=new gn(wt(u,Et(a,u)),i,i&&i.lastId,c,c&&c.id,e,null,new hn(n))).integrate(t,0)}}})),l()},de=function(){return C.create("Length exceeded!")},he=function(t,e,n,r){if(n>e._length)throw de();if(0===n)return e._searchMarker&&re(e._searchMarker,n,r.length),fe(t,e,null,r);var i=n,o=ne(e,n),u=e._start;for(null!==o&&(u=o.p,0==(n-=o.index)&&(n+=(u=u.prev)&&u.countable&&!u.deleted?u.length:0));null!==u;u=u.right)if(!u.deleted&&u.countable){if(n<=u.length){n<u.length&&It(t,wt(u.id.client,u.id.clock+n));break}n-=u.length}return e._searchMarker&&re(e._searchMarker,i,r.length),fe(t,e,u,r)},ve=function(t,e,n,r){if(0!==r){var i=n,o=r,u=ne(e,n),a=e._start;for(null!==u&&(a=u.p,n-=u.index);null!==a&&n>0;a=a.right)!a.deleted&&a.countable&&(n<a.length&&It(t,wt(a.id.client,a.id.clock+n)),n-=a.length);for(;r>0&&null!==a;)a.deleted||(r<a.length&&It(t,wt(a.id.client,a.id.clock+r)),a.delete(t),r-=a.length),a=a.right;if(r>0)throw de();e._searchMarker&&re(e._searchMarker,i,-o+r)}},ge=function(t,e,n){var r=e._map.get(n);void 0!==r&&r.delete(t)},pe=function(t,e,n,r){var i,o=e._map.get(n)||null,u=t.doc,a=u.clientID;if(null==r)i=new nn([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:i=new nn([r]);break;case Uint8Array:i=new He(r);break;case Y:i=new Ze(r);break;default:if(!(r instanceof oe))throw new Error("Unexpected content type");i=new hn(r)}new gn(wt(a,Et(u.store,a)),o,o&&o.lastId,null,null,e,n,i).integrate(t,0)},ye=function(t,e){var n=t._map.get(e);return void 0===n||n.deleted?void 0:n.content.getContent()[n.length-1]},ke=function(t){var e={};return t._map.forEach((function(t,n){t.deleted||(e[n]=t.content.getContent()[t.length-1])})),e},we=function(t,e){var n=t._map.get(e);return void 0!==n&&!n.deleted},me=function(t){return V.iteratorFilter(t.entries(),(function(t){return!t[1].deleted}))},be=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(t,r){var i;return(0,u.default)(this,n),(i=e.call(this,t,r))._transaction=r,i}return n}(Xt),_e=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(){var t;return(0,u.default)(this,n),(t=e.call(this))._prelimContent=[],t._searchMarker=[],t}return(0,a.default)(n,[{key:"_integrate",value:function(t,e){(0,s.default)((0,l.default)(n.prototype),"_integrate",this).call(this,t,e),this.insert(0,this._prelimContent),this._prelimContent=null}},{key:"_copy",value:function(){return new n}},{key:"clone",value:function(){var t=new n;return t.insert(0,this.toArray().map((function(t){return t instanceof oe?t.clone():t}))),t}},{key:"length",get:function(){return null===this._prelimContent?this._length:this._prelimContent.length}},{key:"_callObserver",value:function(t,e){(0,s.default)((0,l.default)(n.prototype),"_callObserver",this).call(this,t,e),ie(this,t,new be(this,t))}},{key:"insert",value:function(t,e){var n,r=this;null!==this.doc?jt(this.doc,(function(n){he(n,r,t,e)})):(n=this._prelimContent).splice.apply(n,[t,0].concat((0,g.default)(e)))}},{key:"push",value:function(t){var e,n=this;null!==this.doc?jt(this.doc,(function(e){!function(t,e,n){var r=(e._searchMarker||[]).reduce((function(t,e){return e.index>t.index?e:t}),{index:0,p:e._start}).p;if(r)for(;r.right;)r=r.right;fe(t,e,r,n)}(e,n,t)})):(e=this._prelimContent).push.apply(e,(0,g.default)(t))}},{key:"unshift",value:function(t){this.insert(0,t)}},{key:"delete",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this;null!==this.doc?jt(this.doc,(function(r){ve(r,n,t,e)})):this._prelimContent.splice(t,e)}},{key:"get",value:function(t){return le(this,t)}},{key:"toArray",value:function(){return ae(this)}},{key:"slice",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;return ue(this,t,e)}},{key:"toJSON",value:function(){return this.map((function(t){return t instanceof oe?t.toJSON():t}))}},{key:"map",value:function(t){return se(this,t)}},{key:"forEach",value:function(t){ce(this,t)}},{key:Symbol.iterator,value:function(){return e=this._start,n=null,r=0,t={},(0,c.default)(t,Symbol.iterator,(function(){return this})),(0,c.default)(t,"next",(function(){if(null===n){for(;null!==e&&e.deleted;)e=e.right;if(null===e)return{done:!0,value:void 0};n=e.content.getContent(),r=0,e=e.right}var t=n[r++];return n.length<=r&&(n=null),{done:!1,value:t}})),t;var t,e,n,r}},{key:"_write",value:function(t){t.writeTypeRef(un)}}],[{key:"from",value:function(t){var e=new n;return e.push(t),e}}]),n}(oe),Se=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(t,r,i){var o;return(0,u.default)(this,n),(o=e.call(this,t,r)).keysChanged=i,o}return n}(Xt),xe=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(t){var r;return(0,u.default)(this,n),(r=e.call(this))._prelimContent=null,r._prelimContent=void 0===t?new Map:new Map(t),r}return(0,a.default)(n,[{key:"_integrate",value:function(t,e){var r=this;(0,s.default)((0,l.default)(n.prototype),"_integrate",this).call(this,t,e),this._prelimContent.forEach((function(t,e){r.set(e,t)})),this._prelimContent=null}},{key:"_copy",value:function(){return new n}},{key:"clone",value:function(){var t=new n;return this.forEach((function(e,n){t.set(n,e instanceof oe?e.clone():e)})),t}},{key:"_callObserver",value:function(t,e){ie(this,t,new Se(this,t,e))}},{key:"toJSON",value:function(){var t={};return this._map.forEach((function(e,n){if(!e.deleted){var r=e.content.getContent()[e.length-1];t[n]=r instanceof oe?r.toJSON():r}})),t}},{key:"size",get:function(){return(0,g.default)(me(this._map)).length}},{key:"keys",value:function(){return V.iteratorMap(me(this._map),(function(t){return t[0]}))}},{key:"values",value:function(){return V.iteratorMap(me(this._map),(function(t){return t[1].content.getContent()[t[1].length-1]}))}},{key:"entries",value:function(){return V.iteratorMap(me(this._map),(function(t){return[t[0],t[1].content.getContent()[t[1].length-1]]}))}},{key:"forEach",value:function(t){var e=this;this._map.forEach((function(n,r){n.deleted||t(n.content.getContent()[n.length-1],r,e)}))}},{key:Symbol.iterator,value:function(){return this.entries()}},{key:"delete",value:function(t){var e=this;null!==this.doc?jt(this.doc,(function(n){ge(n,e,t)})):this._prelimContent.delete(t)}},{key:"set",value:function(t,e){var n=this;return null!==this.doc?jt(this.doc,(function(r){pe(r,n,t,e)})):this._prelimContent.set(t,e),e}},{key:"get",value:function(t){return ye(this,t)}},{key:"has",value:function(t){return we(this,t)}},{key:"clear",value:function(){var t=this;null!==this.doc?jt(this.doc,(function(e){t.forEach((function(t,n,r){ge(e,r,n)}))})):this._prelimContent.clear()}},{key:"_write",value:function(t){t.writeTypeRef(an)}}]),n}(oe),Ee=function(t,e){return t===e||"object"==typeof t&&"object"==typeof e&&t&&e&&N.equalFlat(t,e)},De=function(){"use strict";function t(e,n,r,i){(0,u.default)(this,t),this.left=e,this.right=n,this.index=r,this.currentAttributes=i}return(0,a.default)(t,[{key:"forward",value:function(){null===this.right&&C.unexpectedCase(),this.right.content.constructor===tn?this.right.deleted||Ie(this.currentAttributes,this.right.content):this.right.deleted||(this.index+=this.right.length),this.left=this.right,this.right=this.right.right}}]),t}(),Ce=function(t,e,n){for(;null!==e.right&&n>0;)e.right.content.constructor===tn?e.right.deleted||Ie(e.currentAttributes,e.right.content):e.right.deleted||(n<e.right.length&&It(t,wt(e.right.id.client,e.right.id.clock+n)),e.index+=e.right.length,n-=e.right.length),e.left=e.right,e.right=e.right.right;return e},Ue=function(t,e,n,r){var i=new Map,o=r?ne(e,n):null;if(o){var u=new De(o.p.left,o.p,o.index,i);return Ce(t,u,n-o.index)}var a=new De(null,e._start,0,i);return Ce(t,a,n)},Ae=function(t,e,n,r){for(;null!==n.right&&(!0===n.right.deleted||n.right.content.constructor===tn&&Ee(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();var i=t.doc,o=i.clientID;r.forEach((function(r,u){var a=n.left,c=n.right,s=new gn(wt(o,Et(i.store,o)),a,a&&a.lastId,c,c&&c.id,e,null,new tn(u,r));s.integrate(t,0),n.right=s,n.forward()}))},Ie=function(t,e){var n=e.key,r=e.value;null===r?t.delete(n):t.set(n,r)},Te=function(t,e){for(;null!==t.right&&(t.right.deleted||t.right.content.constructor===tn&&Ee(e[t.right.content.key]||null,t.right.content.value));)t.forward()},Oe=function(t,e,n,r){var i=t.doc,o=i.clientID,u=new Map;for(var a in r){var c=r[a],s=n.currentAttributes.get(a)||null;if(!Ee(s,c)){u.set(a,s);var l=n.left,f=n.right;n.right=new gn(wt(o,Et(i.store,o)),l,l&&l.lastId,f,f&&f.id,e,null,new tn(a,c)),n.right.integrate(t,0),n.forward()}}return u},Ve=function(t,e,n,r,i){n.currentAttributes.forEach((function(t,e){void 0===i[e]&&(i[e]=null)}));var o=t.doc,u=o.clientID;Te(n,i);var a=Oe(t,e,n,i),c=r.constructor===String?new rn(r):r instanceof oe?new hn(r):new $e(r),s=n.left,l=n.right,f=n.index;e._searchMarker&&re(e._searchMarker,n.index,c.getLength()),(l=new gn(wt(u,Et(o.store,u)),s,s&&s.lastId,l,l&&l.id,e,null,c)).integrate(t,0),n.right=l,n.index=f,n.forward(),Ae(t,e,n,a)},Ne=function(t,e,n,r,i){var o=t.doc,u=o.clientID;Te(n,i);var a=Oe(t,e,n,i);t:for(;null!==n.right&&(r>0||a.size>0&&(n.right.deleted||n.right.content.constructor===tn));){if(!n.right.deleted)if(n.right.content.constructor===tn){var c=n.right.content,s=c.key,l=c.value,f=i[s];if(void 0!==f){if(Ee(f,l))a.delete(s);else{if(0===r)break t;a.set(s,l)}n.right.delete(t)}else n.currentAttributes.set(s,l)}else r<n.right.length&&It(t,wt(n.right.id.client,n.right.id.clock+r)),r-=n.right.length;n.forward()}if(r>0){for(var d="";r>0;r--)d+="\n";n.right=new gn(wt(u,Et(o.store,u)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,e,null,new rn(d)),n.right.integrate(t,0),n.forward()}Ae(t,e,n,a)},Me=function(t,e,n,r,i){for(var o=e,u=b.create();o&&(!o.countable||o.deleted);){if(!o.deleted&&o.content.constructor===tn){var a=o.content;u.set(a.key,a)}o=o.right}for(var c=0,s=!1;e!==o;){if(n===e&&(s=!0),!e.deleted){var l=e.content;if(l.constructor===tn){var f=l.key,d=l.value,h=r.get(f)||null;u.get(f)===l&&h!==d||(e.delete(t),c++,s||(i.get(f)||null)!==d||h===d||(null===h?i.delete(f):i.set(f,h))),s||e.deleted||Ie(i,l)}}e=e.right}return c},Re=function(t){var e=0;return jt(t.doc,(function(n){for(var r=t._start,i=t._start,o=b.create(),u=b.copy(o);i;)!1===i.deleted&&(i.content.constructor===tn?Ie(u,i.content):(e+=Me(n,r,i,o,u),o=b.copy(u),r=i)),i=i.right})),e},Be=function(t){var e=new Set,n=t.doc,r=!0,i=!1,o=void 0;try{for(var u,a=t.afterState.entries()[Symbol.iterator]();!(r=(u=a.next()).done);r=!0){var c=(0,v.default)(u.value,2),s=c[0],l=c[1],f=t.beforeState.get(s)||0;l!==f&&Ot(t,n.store.clients.get(s),f,l,(function(t){t.deleted||t.content.constructor!==tn||t.constructor===Ye||e.add(t.parent)}))}}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}jt(n,(function(n){B(t,t.deleteSet,(function(t){if(!(t instanceof Ye||!t.parent._hasFormatting||e.has(t.parent))){var r=t.parent;t.content.constructor===tn?e.add(r):function(t,e){for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;for(var n=new Set;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===tn){var r=e.content.key;n.has(r)?e.delete(t):n.add(r)}e=e.left}}(n,t)}}));var r=!0,i=!1,o=void 0;try{for(var u,a=e[Symbol.iterator]();!(r=(u=a.next()).done);r=!0){var c=u.value;Re(c)}}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}}))},Le=function(t,e,n){for(var r=n,i=b.copy(e.currentAttributes),o=e.right;n>0&&null!==e.right;){if(!1===e.right.deleted)switch(e.right.content.constructor){case hn:case $e:case rn:n<e.right.length&&It(t,wt(e.right.id.client,e.right.id.clock+n)),n-=e.right.length,e.right.delete(t)}e.forward()}o&&Me(t,o,e.right,i,e.currentAttributes);var u=(e.left||e.right).parent;return u._searchMarker&&re(u._searchMarker,e.index,-r+n),e},je=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(t,r,i){var o;return(0,u.default)(this,n),(o=e.call(this,t,r)).childListChanged=!1,o.keysChanged=new Set,i.forEach((function(t){null===t?o.childListChanged=!0:o.keysChanged.add(t)})),o}return(0,a.default)(n,[{key:"changes",get:function(){if(null===this._changes){var t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}},{key:"delta",get:function(){var t=this;if(null===this._delta){var e=this.target.doc,n=[];jt(e,(function(e){for(var r=new Map,i=new Map,o=t.target._start,u=null,a={},c="",s=0,l=0,f=function(){if(null!==u){var t=null;switch(u){case"delete":l>0&&(t={delete:l}),l=0;break;case"insert":("object"==typeof c||c.length>0)&&(t={insert:c},r.size>0&&(t.attributes={},r.forEach((function(e,n){null!==e&&(t.attributes[n]=e)})))),c="";break;case"retain":s>0&&(t={retain:s},N.isEmpty(a)||(t.attributes=N.assign({},a))),s=0}t&&n.push(t),u=null}};null!==o;){switch(o.content.constructor){case hn:case $e:t.adds(o)?t.deletes(o)||(f(),u="insert",c=o.content.getContent()[0],f()):t.deletes(o)?("delete"!==u&&(f(),u="delete"),l+=1):o.deleted||("retain"!==u&&(f(),u="retain"),s+=1);break;case rn:t.adds(o)?t.deletes(o)||("insert"!==u&&(f(),u="insert"),c+=o.content.str):t.deletes(o)?("delete"!==u&&(f(),u="delete"),l+=o.length):o.deleted||("retain"!==u&&(f(),u="retain"),s+=o.length);break;case tn:var d=o.content,h=d.key,v=d.value;if(t.adds(o)){if(!t.deletes(o)){var g=r.get(h)||null;Ee(g,v)?null!==v&&o.delete(e):("retain"===u&&f(),Ee(v,i.get(h)||null)?delete a[h]:a[h]=v)}}else if(t.deletes(o)){i.set(h,v);var p=r.get(h)||null;Ee(p,v)||("retain"===u&&f(),a[h]=p)}else if(!o.deleted){i.set(h,v);var y=a[h];void 0!==y&&(Ee(y,v)?null!==y&&o.delete(e):("retain"===u&&f(),null===v?delete a[h]:a[h]=v))}o.deleted||("insert"===u&&f(),Ie(r,o.content))}o=o.right}for(f();n.length>0;){var k=n[n.length-1];if(void 0===k.retain||void 0!==k.attributes)break;n.pop()}})),this._delta=n}return this._delta}}]),n}(Xt),Pe=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(t){var r;return(0,u.default)(this,n),(r=e.call(this))._pending=void 0!==t?[function(){return r.insert(0,t)}]:[],r._searchMarker=[],r._hasFormatting=!1,r}return(0,a.default)(n,[{key:"length",get:function(){return this._length}},{key:"_integrate",value:function(t,e){(0,s.default)((0,l.default)(n.prototype),"_integrate",this).call(this,t,e);try{this._pending.forEach((function(t){return t()}))}catch(t){console.error(t)}this._pending=null}},{key:"_copy",value:function(){return new n}},{key:"clone",value:function(){var t=new n;return t.applyDelta(this.toDelta()),t}},{key:"_callObserver",value:function(t,e){(0,s.default)((0,l.default)(n.prototype),"_callObserver",this).call(this,t,e);var r=new je(this,t,e);ie(this,t,r),!t.local&&this._hasFormatting&&(t._needFormattingCleanup=!0)}},{key:"toString",value:function(){for(var t="",e=this._start;null!==e;)!e.deleted&&e.countable&&e.content.constructor===rn&&(t+=e.content.str),e=e.right;return t}},{key:"toJSON",value:function(){return this.toString()}},{key:"applyDelta",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).sanitize,n=void 0===e||e,r=this;null!==this.doc?jt(this.doc,(function(e){for(var i=new De(null,r._start,0,new Map),o=0;o<t.length;o++){var u=t[o];if(void 0!==u.insert){var a=n||"string"!=typeof u.insert||o!==t.length-1||null!==i.right||"\n"!==u.insert.slice(-1)?u.insert:u.insert.slice(0,-1);("string"!=typeof a||a.length>0)&&Ve(e,r,i,a,u.attributes||{})}else void 0!==u.retain?Ne(e,r,i,u.retain,u.attributes||{}):void 0!==u.delete&&Le(e,i,u.delete)}})):this._pending.push((function(){return r.applyDelta(t)}))}},{key:"toDelta",value:function(t,e,n){var r=[],i=new Map,o=this.doc,u="",a=this._start;function c(){if(u.length>0){var t={},e=!1;i.forEach((function(n,r){e=!0,t[r]=n}));var n={insert:u};e&&(n.attributes=t),r.push(n),u=""}}var s=function(){for(var o=function(){if(bt(a,t)||void 0!==e&&bt(a,e))switch(a.content.constructor){case rn:var o=i.get("ychange");void 0===t||bt(a,t)?void 0===e||bt(a,e)?void 0!==o&&(c(),i.delete("ychange")):void 0!==o&&o.user===a.id.client&&"added"===o.type||(c(),i.set("ychange",n?n("added",a.id):{type:"added"})):void 0!==o&&o.user===a.id.client&&"removed"===o.type||(c(),i.set("ychange",n?n("removed",a.id):{type:"removed"})),u+=a.content.str;break;case hn:case $e:c();var s={insert:a.content.getContent()[0]};if(i.size>0){var l={};s.attributes=l,i.forEach((function(t,e){l[e]=t}))}r.push(s);break;case tn:bt(a,t)&&(c(),Ie(i,a.content))}a=a.right};null!==a;)o();c()};return t||e?jt(o,(function(n){t&&_t(n,t),e&&_t(n,e),s()}),"cleanup"):s(),r}},{key:"insert",value:function(t,e,n){var r=this;if(!(e.length<=0)){var i=this.doc;null!==i?jt(i,(function(i){var o=Ue(i,r,t,!n);n||(n={},o.currentAttributes.forEach((function(t,e){n[e]=t}))),Ve(i,r,o,e,n)})):this._pending.push((function(){return r.insert(t,e,n)}))}}},{key:"insertEmbed",value:function(t,e,n){var r=this,i=this.doc;null!==i?jt(i,(function(i){var o=Ue(i,r,t,!n);Ve(i,r,o,e,n||{})})):this._pending.push((function(){return r.insertEmbed(t,e,n||{})}))}},{key:"delete",value:function(t,e){var n=this;if(0!==e){var r=this.doc;null!==r?jt(r,(function(r){Le(r,Ue(r,n,t,!0),e)})):this._pending.push((function(){return n.delete(t,e)}))}}},{key:"format",value:function(t,e,n){var r=this;if(0!==e){var i=this.doc;null!==i?jt(i,(function(i){var o=Ue(i,r,t,!1);null!==o.right&&Ne(i,r,o,e,n)})):this._pending.push((function(){return r.format(t,e,n)}))}}},{key:"removeAttribute",value:function(t){var e=this;null!==this.doc?jt(this.doc,(function(n){ge(n,e,t)})):this._pending.push((function(){return e.removeAttribute(t)}))}},{key:"setAttribute",value:function(t,e){var n=this;null!==this.doc?jt(this.doc,(function(r){pe(r,n,t,e)})):this._pending.push((function(){return n.setAttribute(t,e)}))}},{key:"getAttribute",value:function(t){return ye(this,t)}},{key:"getAttributes",value:function(){return ke(this)}},{key:"_write",value:function(t){t.writeTypeRef(cn)}}]),n}(oe),Je=function(){"use strict";function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};(0,u.default)(this,t),this._filter=n,this._root=e,this._currentNode=e._start,this._firstCall=!0}return(0,a.default)(t,[{key:Symbol.iterator,value:function(){return this}},{key:"next",value:function(){var t=this._currentNode,e=t&&t.content&&t.content.type;if(null!==t&&(!this._firstCall||t.deleted||!this._filter(e)))do{if(e=t.content.type,t.deleted||e.constructor!==We&&e.constructor!==Fe||null===e._start)for(;null!==t;){if(null!==t.right){t=t.right;break}t=t.parent===this._root?null:t.parent._item}else t=e._start}while(null!==t&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,null===t?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}]),t}(),Fe=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(){var t;return(0,u.default)(this,n),(t=e.call(this))._prelimContent=[],t}return(0,a.default)(n,[{key:"firstChild",get:function(){var t=this._first;return t?t.content.getContent()[0]:null}},{key:"_integrate",value:function(t,e){(0,s.default)((0,l.default)(n.prototype),"_integrate",this).call(this,t,e),this.insert(0,this._prelimContent),this._prelimContent=null}},{key:"_copy",value:function(){return new n}},{key:"clone",value:function(){var t=new n;return t.insert(0,this.toArray().map((function(t){return t instanceof oe?t.clone():t}))),t}},{key:"length",get:function(){return null===this._prelimContent?this._length:this._prelimContent.length}},{key:"createTreeWalker",value:function(t){return new Je(this,t)}},{key:"querySelector",value:function(t){t=t.toUpperCase();var e=new Je(this,(function(e){return e.nodeName&&e.nodeName.toUpperCase()===t})).next();return e.done?null:e.value}},{key:"querySelectorAll",value:function(t){return t=t.toUpperCase(),w.from(new Je(this,(function(e){return e.nodeName&&e.nodeName.toUpperCase()===t})))}},{key:"_callObserver",value:function(t,e){ie(this,t,new ze(this,e,t))}},{key:"toString",value:function(){return se(this,(function(t){return t.toString()})).join("")}},{key:"toJSON",value:function(){return this.toString()}},{key:"toDOM",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=t.createDocumentFragment();return void 0!==n&&n._createAssociation(r,this),ce(this,(function(i){r.insertBefore(i.toDOM(t,e,n),null)})),r}},{key:"insert",value:function(t,e){var n,r=this;null!==this.doc?jt(this.doc,(function(n){he(n,r,t,e)})):(n=this._prelimContent).splice.apply(n,[t,0].concat((0,g.default)(e)))}},{key:"insertAfter",value:function(t,e){var n=this;if(null!==this.doc)jt(this.doc,(function(r){var i=t&&t instanceof oe?t._item:t;fe(r,n,i,e)}));else{var r,i=this._prelimContent,o=null===t?0:i.findIndex((function(e){return e===t}))+1;if(0===o&&null!==t)throw C.create("Reference item not found");(r=i).splice.apply(r,[o,0].concat((0,g.default)(e)))}}},{key:"delete",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this;null!==this.doc?jt(this.doc,(function(r){ve(r,n,t,e)})):this._prelimContent.splice(t,e)}},{key:"toArray",value:function(){return ae(this)}},{key:"push",value:function(t){this.insert(this.length,t)}},{key:"unshift",value:function(t){this.insert(0,t)}},{key:"get",value:function(t){return le(this,t)}},{key:"slice",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;return ue(this,t,e)}},{key:"forEach",value:function(t){ce(this,t)}},{key:"_write",value:function(t){t.writeTypeRef(ln)}}]),n}(oe),We=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"UNDEFINED";return(0,u.default)(this,n),(t=e.call(this)).nodeName=r,t._prelimAttrs=new Map,t}return(0,a.default)(n,[{key:"nextSibling",get:function(){var t=this._item?this._item.next:null;return t?t.content.type:null}},{key:"prevSibling",get:function(){var t=this._item?this._item.prev:null;return t?t.content.type:null}},{key:"_integrate",value:function(t,e){var r=this;(0,s.default)((0,l.default)(n.prototype),"_integrate",this).call(this,t,e),this._prelimAttrs.forEach((function(t,e){r.setAttribute(e,t)})),this._prelimAttrs=null}},{key:"_copy",value:function(){return new n(this.nodeName)}},{key:"clone",value:function(){var t=new n(this.nodeName),e=this.getAttributes();return N.forEach(e,(function(e,n){"string"==typeof e&&t.setAttribute(n,e)})),t.insert(0,this.toArray().map((function(t){return t instanceof oe?t.clone():t}))),t}},{key:"toString",value:function(){var t=this.getAttributes(),e=[],r=[];for(var i in t)r.push(i);r.sort();for(var o=r.length,u=0;u<o;u++){var a=r[u];e.push(a+'="'+t[a]+'"')}var c=this.nodeName.toLocaleLowerCase(),f=e.length>0?" "+e.join(" "):"";return"<".concat(c).concat(f,">").concat((0,s.default)((0,l.default)(n.prototype),"toString",this).call(this),"</").concat(c,">")}},{key:"removeAttribute",value:function(t){var e=this;null!==this.doc?jt(this.doc,(function(n){ge(n,e,t)})):this._prelimAttrs.delete(t)}},{key:"setAttribute",value:function(t,e){var n=this;null!==this.doc?jt(this.doc,(function(r){pe(r,n,t,e)})):this._prelimAttrs.set(t,e)}},{key:"getAttribute",value:function(t){return ye(this,t)}},{key:"hasAttribute",value:function(t){return we(this,t)}},{key:"getAttributes",value:function(t){return t?function(t,e){var n={};return t._map.forEach((function(t,r){for(var i=t;null!==i&&(!e.sv.has(i.id.client)||i.id.clock>=(e.sv.get(i.id.client)||0));)i=i.left;null!==i&&bt(i,e)&&(n[r]=i.content.getContent()[i.length-1])})),n}(this,t):ke(this)}},{key:"toDOM",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=t.createElement(this.nodeName),i=this.getAttributes();for(var o in i){var u=i[o];"string"==typeof u&&r.setAttribute(o,u)}return ce(this,(function(i){r.appendChild(i.toDOM(t,e,n))})),void 0!==n&&n._createAssociation(r,this),r}},{key:"_write",value:function(t){t.writeTypeRef(sn),t.writeKey(this.nodeName)}}]),n}(Fe),ze=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(t,r,i){var o;return(0,u.default)(this,n),(o=e.call(this,t,i)).childListChanged=!1,o.attributesChanged=new Set,r.forEach((function(t){null===t?o.childListChanged=!0:o.attributesChanged.add(t)})),o}return n}(Xt),qe=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(t){var r;return(0,u.default)(this,n),(r=e.call(this)).hookName=t,r}return(0,a.default)(n,[{key:"_copy",value:function(){return new n(this.hookName)}},{key:"clone",value:function(){var t=new n(this.hookName);return this.forEach((function(e,n){t.set(n,e)})),t}},{key:"toDOM",value:function(){arguments.length>0&&void 0!==arguments[0]||document;var t,e=arguments.length>2?arguments[2]:void 0,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})[this.hookName];return(t=void 0!==n?n.createDom(this):document.createElement(this.hookName)).setAttribute("data-yjs-hook",this.hookName),void 0!==e&&e._createAssociation(t,this),t}},{key:"_write",value:function(t){t.writeTypeRef(fn),t.writeKey(this.hookName)}}]),n}(xe),Ke=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(){return(0,u.default)(this,n),e.apply(this,arguments)}return(0,a.default)(n,[{key:"nextSibling",get:function(){var t=this._item?this._item.next:null;return t?t.content.type:null}},{key:"prevSibling",get:function(){var t=this._item?this._item.prev:null;return t?t.content.type:null}},{key:"_copy",value:function(){return new n}},{key:"clone",value:function(){var t=new n;return t.applyDelta(this.toDelta()),t}},{key:"toDOM",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=arguments.length>2?arguments[2]:void 0,n=t.createTextNode(this.toString());return void 0!==e&&e._createAssociation(n,this),n}},{key:"toString",value:function(){return this.toDelta().map((function(t){var e=function(e){var r=[];for(var i in t.attributes[e])r.push({key:i,value:t.attributes[e][i]});r.sort((function(t,e){return t.key<e.key?-1:1})),n.push({nodeName:e,attrs:r})},n=[];for(var r in t.attributes)e(r);n.sort((function(t,e){return t.nodeName<e.nodeName?-1:1}));for(var i="",o=0;o<n.length;o++){var u=n[o];i+="<".concat(u.nodeName);for(var a=0;a<u.attrs.length;a++){var c=u.attrs[a];i+=" ".concat(c.key,'="').concat(c.value,'"')}i+=">"}i+=t.insert;for(var s=n.length-1;s>=0;s--)i+="</".concat(n[s].nodeName,">");return i})).join("")}},{key:"toJSON",value:function(){return this.toString()}},{key:"_write",value:function(t){t.writeTypeRef(dn)}}]),n}(Pe),Qe=function(){"use strict";function t(e,n){(0,u.default)(this,t),this.id=e,this.length=n}return(0,a.default)(t,[{key:"deleted",get:function(){throw C.methodUnimplemented()}},{key:"mergeWith",value:function(t){return!1}},{key:"write",value:function(t,e,n){throw C.methodUnimplemented()}},{key:"integrate",value:function(t,e){throw C.methodUnimplemented()}}]),t}(),Ye=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(){return(0,u.default)(this,n),e.apply(this,arguments)}return(0,a.default)(n,[{key:"deleted",get:function(){return!0}},{key:"delete",value:function(){}},{key:"mergeWith",value:function(t){return this.constructor===t.constructor&&(this.length+=t.length,!0)}},{key:"integrate",value:function(t,e){e>0&&(this.id.clock+=e,this.length-=e),Dt(t.doc.store,this)}},{key:"write",value:function(t,e){t.writeInfo(0),t.writeLen(this.length-e)}},{key:"getMissing",value:function(t,e){return null}}]),n}(Qe),He=function(){"use strict";function t(e){(0,u.default)(this,t),this.content=e}return(0,a.default)(t,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[this.content]}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new t(this.content)}},{key:"splice",value:function(t){throw C.methodUnimplemented()}},{key:"mergeWith",value:function(t){return!1}},{key:"integrate",value:function(t,e){}},{key:"delete",value:function(t){}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){t.writeBuf(this.content)}},{key:"getRef",value:function(){return 3}}]),t}(),Ge=function(){"use strict";function t(e){(0,u.default)(this,t),this.len=e}return(0,a.default)(t,[{key:"getLength",value:function(){return this.len}},{key:"getContent",value:function(){return[]}},{key:"isCountable",value:function(){return!1}},{key:"copy",value:function(){return new t(this.len)}},{key:"splice",value:function(e){var n=new t(this.len-e);return this.len=e,n}},{key:"mergeWith",value:function(t){return this.len+=t.len,!0}},{key:"integrate",value:function(t,e){J(t.deleteSet,e.id.client,e.id.clock,this.len),e.markDeleted()}},{key:"delete",value:function(t){}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){t.writeLen(this.len-e)}},{key:"getRef",value:function(){return 1}}]),t}(),Xe=function(t,e){return new Y((0,h.default)((0,d.default)({guid:t},e),{shouldLoad:e.shouldLoad||e.autoLoad||!1}))},Ze=function(){"use strict";function t(e){(0,u.default)(this,t),e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;var n={};this.opts=n,e.gc||(n.gc=!1),e.autoLoad&&(n.autoLoad=!0),null!==e.meta&&(n.meta=e.meta)}return(0,a.default)(t,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[this.doc]}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new t(Xe(this.doc.guid,this.opts))}},{key:"splice",value:function(t){throw C.methodUnimplemented()}},{key:"mergeWith",value:function(t){return!1}},{key:"integrate",value:function(t,e){this.doc._item=e,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}},{key:"delete",value:function(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){t.writeString(this.doc.guid),t.writeAny(this.opts)}},{key:"getRef",value:function(){return 9}}]),t}(),$e=function(){"use strict";function t(e){(0,u.default)(this,t),this.embed=e}return(0,a.default)(t,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[this.embed]}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new t(this.embed)}},{key:"splice",value:function(t){throw C.methodUnimplemented()}},{key:"mergeWith",value:function(t){return!1}},{key:"integrate",value:function(t,e){}},{key:"delete",value:function(t){}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){t.writeJSON(this.embed)}},{key:"getRef",value:function(){return 5}}]),t}(),tn=function(){"use strict";function t(e,n){(0,u.default)(this,t),this.key=e,this.value=n}return(0,a.default)(t,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[]}},{key:"isCountable",value:function(){return!1}},{key:"copy",value:function(){return new t(this.key,this.value)}},{key:"splice",value:function(t){throw C.methodUnimplemented()}},{key:"mergeWith",value:function(t){return!1}},{key:"integrate",value:function(t,e){var n=e.parent;n._searchMarker=null,n._hasFormatting=!0}},{key:"delete",value:function(t){}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){t.writeKey(this.key),t.writeJSON(this.value)}},{key:"getRef",value:function(){return 6}}]),t}(),en=function(){"use strict";function t(e){(0,u.default)(this,t),this.arr=e}return(0,a.default)(t,[{key:"getLength",value:function(){return this.arr.length}},{key:"getContent",value:function(){return this.arr}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new t(this.arr)}},{key:"splice",value:function(e){var n=new t(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}},{key:"mergeWith",value:function(t){return this.arr=this.arr.concat(t.arr),!0}},{key:"integrate",value:function(t,e){}},{key:"delete",value:function(t){}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){var n=this.arr.length;t.writeLen(n-e);for(var r=e;r<n;r++){var i=this.arr[r];t.writeString(void 0===i?"undefined":JSON.stringify(i))}}},{key:"getRef",value:function(){return 2}}]),t}(),nn=function(){"use strict";function t(e){(0,u.default)(this,t),this.arr=e}return(0,a.default)(t,[{key:"getLength",value:function(){return this.arr.length}},{key:"getContent",value:function(){return this.arr}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new t(this.arr)}},{key:"splice",value:function(e){var n=new t(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}},{key:"mergeWith",value:function(t){return this.arr=this.arr.concat(t.arr),!0}},{key:"integrate",value:function(t,e){}},{key:"delete",value:function(t){}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){var n=this.arr.length;t.writeLen(n-e);for(var r=e;r<n;r++){var i=this.arr[r];t.writeAny(i)}}},{key:"getRef",value:function(){return 8}}]),t}(),rn=function(){"use strict";function t(e){(0,u.default)(this,t),this.str=e}return(0,a.default)(t,[{key:"getLength",value:function(){return this.str.length}},{key:"getContent",value:function(){return this.str.split("")}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new t(this.str)}},{key:"splice",value:function(e){var n=new t(this.str.slice(e));this.str=this.str.slice(0,e);var r=this.str.charCodeAt(e-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,e-1)+"",n.str=""+n.str.slice(1)),n}},{key:"mergeWith",value:function(t){return this.str+=t.str,!0}},{key:"integrate",value:function(t,e){}},{key:"delete",value:function(t){}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){t.writeString(0===e?this.str:this.str.slice(e))}},{key:"getRef",value:function(){return 4}}]),t}(),on=[function(t){return new _e},function(t){return new xe},function(t){return new Pe},function(t){return new We(t.readKey())},function(t){return new Fe},function(t){return new qe(t.readKey())},function(t){return new Ke}],un=0,an=1,cn=2,sn=3,ln=4,fn=5,dn=6,hn=function(){"use strict";function t(e){(0,u.default)(this,t),this.type=e}return(0,a.default)(t,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[this.type]}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new t(this.type._copy())}},{key:"splice",value:function(t){throw C.methodUnimplemented()}},{key:"mergeWith",value:function(t){return!1}},{key:"integrate",value:function(t,e){this.type._integrate(t.doc,e)}},{key:"delete",value:function(t){for(var e=this.type._start;null!==e;)e.deleted?e.id.clock<(t.beforeState.get(e.id.client)||0)&&t._mergeStructs.push(e):e.delete(t),e=e.right;this.type._map.forEach((function(e){e.deleted?e.id.clock<(t.beforeState.get(e.id.client)||0)&&t._mergeStructs.push(e):e.delete(t)})),t.changed.delete(this.type)}},{key:"gc",value:function(t){for(var e=this.type._start;null!==e;)e.gc(t,!0),e=e.right;this.type._start=null,this.type._map.forEach((function(e){for(;null!==e;)e.gc(t,!0),e=e.left})),this.type._map=new Map}},{key:"write",value:function(t,e){this.type._write(t)}},{key:"getRef",value:function(){return 7}}]),t}(),vn=function(t,e,n){var r=e.id,i=r.client,o=r.clock,u=new gn(wt(i,o+n),e,wt(i,o+n-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(n));return e.deleted&&u.markDeleted(),e.keep&&(u.keep=!0),null!==e.redone&&(u.redone=wt(e.redone.client,e.redone.clock+n)),e.right=u,null!==u.right&&(u.right.left=u),t._mergeStructs.push(u),null!==u.parentSub&&null===u.right&&u.parent._map.set(u.parentSub,u),e.length=n,u},gn=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(t,r,i,o,a,c,s,l){var f;return(0,u.default)(this,n),(f=e.call(this,t,l.getLength())).origin=i,f.left=r,f.right=o,f.rightOrigin=a,f.parent=c,f.parentSub=s,f.redone=null,f.content=l,f.info=f.content.isCountable()?U.BIT2:0,f}return(0,a.default)(n,[{key:"marker",get:function(){return(this.info&U.BIT4)>0},set:function(t){(this.info&U.BIT4)>0!==t&&(this.info^=U.BIT4)}},{key:"keep",get:function(){return(this.info&U.BIT1)>0},set:function(t){this.keep!==t&&(this.info^=U.BIT1)}},{key:"countable",get:function(){return(this.info&U.BIT2)>0}},{key:"deleted",get:function(){return(this.info&U.BIT3)>0},set:function(t){this.deleted!==t&&(this.info^=U.BIT3)}},{key:"markDeleted",value:function(){this.info|=U.BIT3}},{key:"getMissing",value:function(t,e){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=Et(e,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=Et(e,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===yt&&this.id.client!==this.parent.client&&this.parent.clock>=Et(e,this.parent.client))return this.parent.client;if(this.origin&&(this.left=Tt(t,e,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=It(t,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===Ye||this.right&&this.right.constructor===Ye)this.parent=null;else if(this.parent){if(this.parent.constructor===yt){var r=Ut(e,this.parent);r.constructor===Ye?this.parent=null:this.parent=r.content.type}}else this.left&&this.left.constructor===n&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===n&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);return null}},{key:"integrate",value:function(t,e){if(e>0&&(this.id.clock+=e,this.left=Tt(t,t.doc.store,wt(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(e),this.length-=e),this.parent){if(!this.left&&(!this.right||null!==this.right.left)||this.left&&this.left.right!==this.right){var n,r=this.left;if(null!==r)n=r.right;else if(null!==this.parentSub)for(n=this.parent._map.get(this.parentSub)||null;null!==n&&null!==n.left;)n=n.left;else n=this.parent._start;for(var i=new Set,o=new Set;null!==n&&n!==this.right;){if(o.add(n),i.add(n),kt(this.origin,n.origin)){if(n.id.client<this.id.client)r=n,i.clear();else if(kt(this.rightOrigin,n.rightOrigin))break}else{if(null===n.origin||!o.has(Ut(t.doc.store,n.origin)))break;i.has(Ut(t.doc.store,n.origin))||(r=n,i.clear())}n=n.right}this.left=r}if(null!==this.left){var u=this.left.right;this.right=u,this.left.right=this}else{var a;if(null!==this.parentSub)for(a=this.parent._map.get(this.parentSub)||null;null!==a&&null!==a.left;)a=a.left;else a=this.parent._start,this.parent._start=this;this.right=a}null!==this.right?this.right.left=this:null!==this.parentSub&&(this.parent._map.set(this.parentSub,this),null!==this.left&&this.left.delete(t)),null===this.parentSub&&this.countable&&!this.deleted&&(this.parent._length+=this.length),Dt(t.doc.store,this),this.content.integrate(t,this),Mt(t,this.parent,this.parentSub),(null!==this.parent._item&&this.parent._item.deleted||null!==this.parentSub&&null!==this.right)&&this.delete(t)}else new Ye(this.id,this.length).integrate(t,0)}},{key:"next",get:function(){for(var t=this.right;null!==t&&t.deleted;)t=t.right;return t}},{key:"prev",get:function(){for(var t=this.left;null!==t&&t.deleted;)t=t.left;return t}},{key:"lastId",get:function(){return 1===this.length?this.id:wt(this.id.client,this.id.clock+this.length-1)}},{key:"mergeWith",value:function(t){var e=this;if(this.constructor===t.constructor&&kt(t.origin,this.lastId)&&this.right===t&&kt(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&null===this.redone&&null===t.redone&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){var n=this.parent._searchMarker;return n&&n.forEach((function(n){n.p===t&&(n.p=e,!e.deleted&&e.countable&&(n.index-=e.length))})),t.keep&&(this.keep=!0),this.right=t.right,null!==this.right&&(this.right.left=this),this.length+=t.length,!0}return!1}},{key:"delete",value:function(t){if(!this.deleted){var e=this.parent;this.countable&&null===this.parentSub&&(e._length-=this.length),this.markDeleted(),J(t.deleteSet,this.id.client,this.id.clock,this.length),Mt(t,e,this.parentSub),this.content.delete(t)}}},{key:"gc",value:function(t,e){if(!this.deleted)throw C.unexpectedCase();this.content.gc(t),e?function(t,e,n){var r=t.clients.get(e.id.client);r[Ct(r,e.id.clock)]=n}(t,this,new Ye(this.id,this.length)):this.content=new Ge(this.length)}},{key:"write",value:function(t,e){var n=e>0?wt(this.id.client,this.id.clock+e-1):this.origin,r=this.rightOrigin,i=this.parentSub,o=this.content.getRef()&U.BITS5|(null===n?0:U.BIT8)|(null===r?0:U.BIT7)|(null===i?0:U.BIT6);if(t.writeInfo(o),null!==n&&t.writeLeftID(n),null!==r&&t.writeRightID(r),null===n&&null===r){var u=this.parent;if(void 0!==u._item){var a=u._item;if(null===a){var c=function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=t.doc.share.entries()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var u=(0,v.default)(i.value,2),a=u[0];if(u[1]===t)return a}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}throw C.unexpectedCase()}(u);t.writeParentInfo(!0),t.writeString(c)}else t.writeParentInfo(!1),t.writeLeftID(a.id)}else u.constructor===String?(t.writeParentInfo(!0),t.writeString(u)):u.constructor===yt?(t.writeParentInfo(!1),t.writeLeftID(u)):C.unexpectedCase();null!==i&&t.writeString(i)}this.content.write(t,e)}}]),n}(Qe),pn=function(t,e){return yn[e&U.BITS5](t)},yn=[function(){C.unexpectedCase()},function(t){return new Ge(t.readLen())},function(t){for(var e=t.readLen(),n=[],r=0;r<e;r++){var i=t.readString();"undefined"===i?n.push(void 0):n.push(JSON.parse(i))}return new en(n)},function(t){return new He(t.readBuf())},function(t){return new rn(t.readString())},function(t){return new $e(t.readJSON())},function(t){return new tn(t.readKey(),t.readJSON())},function(t){return new hn(on[t.readTypeRef()](t))},function(t){for(var e=t.readLen(),n=[],r=0;r<e;r++)n.push(t.readAny());return new nn(n)},function(t){return new Ze(Xe(t.readString(),t.readAny()))},function(){C.unexpectedCase()}],kn=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(){return(0,u.default)(this,n),e.apply(this,arguments)}return(0,a.default)(n,[{key:"deleted",get:function(){return!0}},{key:"delete",value:function(){}},{key:"mergeWith",value:function(t){return this.constructor===t.constructor&&(this.length+=t.length,!0)}},{key:"integrate",value:function(t,e){C.unexpectedCase()}},{key:"write",value:function(t,e){t.writeInfo(10),_.writeVarUint(t.restEncoder,this.length-e)}},{key:"getMissing",value:function(t,e){return null}}]),n}(Qe),wn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:{};!0===wn["__ $YJS$ __"]&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),wn["__ $YJS$ __"]=!0})),n.register("7j4mF",(function(e,n){function r(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n.push.apply(n,r)}return n}(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})),t}t(e.exports,"default",(function(){return r}))})),n.register("l6jCY",(function(e,r){t(e.exports,"Observable",(function(){return l}));var i=n("9Klpk"),o=n("3bWnf"),u=n("6Wo7Q"),a=n("lOVDE"),c=n("iitZb"),s=n("7qPwo"),l=function(){"use strict";function t(){(0,i.default)(this,t),this._observers=a.create()}return(0,o.default)(t,[{key:"on",value:function(t,e){a.setIfUndefined(this._observers,t,c.create).add(e)}},{key:"once",value:function(t,e){var n=this,r=function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];n.off(t,r),e.apply(void 0,(0,u.default)(o))};this.on(t,r)}},{key:"off",value:function(t,e){var n=this._observers.get(t);void 0!==n&&(n.delete(e),0===n.size&&this._observers.delete(t))}},{key:"emit",value:function(t,e){return s.from((this._observers.get(t)||a.create()).values()).forEach((function(t){return t.apply(void 0,(0,u.default)(e))}))}},{key:"destroy",value:function(){this._observers=a.create()}}]),t}()})),n.register("lOVDE",(function(e,r){t(e.exports,"create",(function(){return o})),t(e.exports,"copy",(function(){return u})),t(e.exports,"setIfUndefined",(function(){return a})),t(e.exports,"map",(function(){return c})),t(e.exports,"any",(function(){return s}));var i=n("5ENmm"),o=function(){return new Map},u=function(t){var e=o();return t.forEach((function(t,n){e.set(n,t)})),e},a=function(t,e,n){var r=t.get(e);return void 0===r&&t.set(e,r=n()),r},c=function(t,e){var n=[],r=!0,o=!1,u=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){var s=(0,i.default)(a.value,2),l=s[0],f=s[1];n.push(e(f,l))}}catch(t){o=!0,u=t}finally{try{r||null==c.return||c.return()}finally{if(o)throw u}}return n},s=function(t,e){var n=!0,r=!1,o=void 0;try{for(var u,a=t[Symbol.iterator]();!(n=(u=a.next()).done);n=!0){var c=(0,i.default)(u.value,2),s=c[0];if(e(c[1],s))return!0}}catch(t){r=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return!1}})),n.register("iitZb",(function(e,n){t(e.exports,"create",(function(){return r})),t(e.exports,"from",(function(){return i}));var r=function(){return new Set},i=function(t){return new Set(t)}})),n.register("7qPwo",(function(e,r){t(e.exports,"last",(function(){return i})),t(e.exports,"appendTo",(function(){return o})),t(e.exports,"from",(function(){return u})),t(e.exports,"some",(function(){return a})),t(e.exports,"equalFlat",(function(){return c})),t(e.exports,"unfold",(function(){return s})),t(e.exports,"isArray",(function(){return l})),t(e.exports,"map",(function(){return f})),n("iitZb");var i=function(t){return t[t.length-1]},o=function(t,e){for(var n=0;n<e.length;n++)t.push(e[n])},u=Array.from,a=function(t,e){for(var n=0;n<t.length;n++)if(e(t[n],n,t))return!0;return!1},c=function(t,e){return t.length===e.length&&function(t,e){for(var n=0;n<t.length;n++)if(!e(t[n],n))return!1;return!0}(t,(function(t,n){return t===e[n]}))},s=function(t,e){for(var n=new Array(t),r=0;r<t;r++)n[r]=e(r,n);return n},l=Array.isArray,f=function(t,e){for(var n=Array(t.length),r=0;r<t.length;r++)n[r]=e(t[r],r,t);return n}})),n.register("3db39",(function(e,n){t(e.exports,"floor",(function(){return r})),t(e.exports,"ceil",(function(){return i})),t(e.exports,"abs",(function(){return o})),t(e.exports,"round",(function(){return u})),t(e.exports,"log10",(function(){return a})),t(e.exports,"min",(function(){return c})),t(e.exports,"max",(function(){return s})),t(e.exports,"exp10",(function(){return l})),t(e.exports,"isNegativeZero",(function(){return f}));var r=Math.floor,i=Math.ceil,o=Math.abs,u=(Math.imul,Math.round),a=Math.log10,c=(Math.log2,Math.log,Math.sqrt,function(t,e){return t<e?t:e}),s=function(t,e){return t>e?t:e},l=(Number.isNaN,Math.pow,function(t){return Math.pow(10,t)}),f=(Math.sign,function(t){return 0!==t?t<0:1/t<0})})),n.register("iwMp2",(function(e,r){t(e.exports,"createEncoder",(function(){return g})),t(e.exports,"encode",(function(){return p})),t(e.exports,"toUint8Array",(function(){return y})),t(e.exports,"write",(function(){return k})),t(e.exports,"writeUint8",(function(){return w})),t(e.exports,"writeVarUint",(function(){return m})),t(e.exports,"writeVarInt",(function(){return b})),t(e.exports,"writeVarUint8Array",(function(){return C})),t(e.exports,"writeVarString",(function(){return x})),t(e.exports,"writeBinaryEncoder",(function(){return E})),t(e.exports,"writeUint8Array",(function(){return D})),t(e.exports,"writeAny",(function(){return I})),t(e.exports,"RleEncoder",(function(){return T})),t(e.exports,"UintOptRleEncoder",(function(){return V})),t(e.exports,"IntDiffOptRleEncoder",(function(){return M})),t(e.exports,"StringEncoder",(function(){return R}));var i=n("9Klpk"),o=n("3bWnf"),u=n("kb0qF"),a=n("rJmE6"),c=n("bWNdT"),s=n("3db39"),l=n("duEab"),f=n("hrH1s"),d=n("ktjib"),h=n("7qPwo"),v=function t(){"use strict";(0,i.default)(this,t),this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]},g=function(){return new v},p=function(t){var e=g();return t(e),y(e)},y=function(t){for(var e=new Uint8Array(function(t){for(var e=t.cpos,n=0;n<t.bufs.length;n++)e+=t.bufs[n].length;return e}(t)),n=0,r=0;r<t.bufs.length;r++){var i=t.bufs[r];e.set(i,n),n+=i.length}return e.set(new Uint8Array(t.cbuf.buffer,0,t.cpos),n),e},k=function(t,e){var n=t.cbuf.length;t.cpos===n&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(2*n),t.cpos=0),t.cbuf[t.cpos++]=e},w=k,m=function(t,e){for(;e>f.BITS7;)k(t,f.BIT8|f.BITS7&e),e=s.floor(e/128);k(t,f.BITS7&e)},b=function(t,e){var n=s.isNegativeZero(e);for(n&&(e=-e),k(t,(e>f.BITS6?f.BIT8:0)|(n?f.BIT7:0)|f.BITS6&e),e=s.floor(e/64);e>0;)k(t,(e>f.BITS7?f.BIT8:0)|f.BITS7&e),e=s.floor(e/128)},_=new Uint8Array(3e4),S=_.length/3,x=d.utf8TextEncoder&&d.utf8TextEncoder.encodeInto?function(t,e){if(e.length<S){var n=d.utf8TextEncoder.encodeInto(e,_).written||0;m(t,n);for(var r=0;r<n;r++)k(t,_[r])}else C(t,d.encodeUtf8(e))}:function(t,e){var n=unescape(encodeURIComponent(e)),r=n.length;m(t,r);for(var i=0;i<r;i++)k(t,n.codePointAt(i))},E=function(t,e){return D(t,y(e))},D=function(t,e){var n=t.cbuf.length,r=t.cpos,i=s.min(n-r,e.length),o=e.length-i;t.cbuf.set(e.subarray(0,i),r),t.cpos+=i,o>0&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(s.max(2*n,o)),t.cbuf.set(e.subarray(i)),t.cpos=o)},C=function(t,e){m(t,e.byteLength),D(t,e)},U=function(t,e){!function(t,e){var n=t.cbuf.length;n-t.cpos<e&&(t.bufs.push(new Uint8Array(t.cbuf.buffer,0,t.cpos)),t.cbuf=new Uint8Array(2*s.max(n,e)),t.cpos=0)}(t,e);var n=new DataView(t.cbuf.buffer,t.cpos,e);return t.cpos+=e,n},A=new DataView(new ArrayBuffer(4)),I=function(t,e){switch(void 0===e?"undefined":(0,a.default)(e)){case"string":k(t,119),x(t,e);break;case"number":l.isInteger(e)&&s.abs(e)<=f.BITS31?(k(t,125),b(t,e)):(u=e,A.setFloat32(0,u),A.getFloat32(0)===u?(k(t,124),function(t,e){U(t,4).setFloat32(0,e,!1)}(t,e)):(k(t,123),function(t,e){U(t,8).setFloat64(0,e,!1)}(t,e)));break;case"bigint":k(t,122),function(t,e){U(t,8).setBigInt64(0,e,!1)}(t,e);break;case"object":if(null===e)k(t,126);else if(h.isArray(e)){k(t,117),m(t,e.length);for(var n=0;n<e.length;n++)I(t,e[n])}else if(e instanceof Uint8Array)k(t,116),C(t,e);else{k(t,118);var r=Object.keys(e);m(t,r.length);for(var i=0;i<r.length;i++){var o=r[i];x(t,o),I(t,e[o])}}break;case"boolean":k(t,e?120:121);break;default:k(t,127)}var u},T=function(t){"use strict";(0,u.default)(n,t);var e=(0,c.default)(n);function n(t){var r;return(0,i.default)(this,n),(r=e.call(this)).w=t,r.s=null,r.count=0,r}return(0,o.default)(n,[{key:"write",value:function(t){this.s===t?this.count++:(this.count>0&&m(this,this.count-1),this.count=1,this.w(this,t),this.s=t)}}]),n}(v),O=function(t){t.count>0&&(b(t.encoder,1===t.count?t.s:-t.s),t.count>1&&m(t.encoder,t.count-2))},V=function(){"use strict";function t(){(0,i.default)(this,t),this.encoder=new v,this.s=0,this.count=0}return(0,o.default)(t,[{key:"write",value:function(t){this.s===t?this.count++:(O(this),this.count=1,this.s=t)}},{key:"toUint8Array",value:function(){return O(this),y(this.encoder)}}]),t}(),N=function(t){if(t.count>0){var e=2*t.diff+(1===t.count?0:1);b(t.encoder,e),t.count>1&&m(t.encoder,t.count-2)}},M=function(){"use strict";function t(){(0,i.default)(this,t),this.encoder=new v,this.s=0,this.count=0,this.diff=0}return(0,o.default)(t,[{key:"write",value:function(t){this.diff===t-this.s?(this.s=t,this.count++):(N(this),this.count=1,this.diff=t-this.s,this.s=t)}},{key:"toUint8Array",value:function(){return N(this),y(this.encoder)}}]),t}(),R=function(){"use strict";function t(){(0,i.default)(this,t),this.sarr=[],this.s="",this.lensE=new V}return(0,o.default)(t,[{key:"write",value:function(t){this.s+=t,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(t.length)}},{key:"toUint8Array",value:function(){var t=new v;return this.sarr.push(this.s),this.s="",x(t,this.sarr.join("")),D(t,this.lensE.toUint8Array()),y(t)}}]),t}()})),n.register("duEab",(function(e,r){t(e.exports,"MAX_SAFE_INTEGER",(function(){return u})),t(e.exports,"isInteger",(function(){return a}));var i=n("3db39"),o=n("hrH1s"),u=Number.MAX_SAFE_INTEGER,a=(Number.MIN_SAFE_INTEGER,o.BITS31,o.BITS32,Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&i.floor(t)===t});Number.isNaN,Number.parseInt})),n.register("hrH1s",(function(e,n){t(e.exports,"BIT1",(function(){return r})),t(e.exports,"BIT2",(function(){return i})),t(e.exports,"BIT3",(function(){return o})),t(e.exports,"BIT4",(function(){return u})),t(e.exports,"BIT6",(function(){return a})),t(e.exports,"BIT7",(function(){return c})),t(e.exports,"BIT8",(function(){return s})),t(e.exports,"BITS5",(function(){return l})),t(e.exports,"BITS6",(function(){return f})),t(e.exports,"BITS7",(function(){return d})),t(e.exports,"BITS8",(function(){return h})),t(e.exports,"BITS21",(function(){return v})),t(e.exports,"BITS31",(function(){return g})),t(e.exports,"BITS32",(function(){return p}));var r=1,i=2,o=4,u=8,a=32,c=64,s=128,l=31,f=63,d=127,h=255,v=2097151,g=2147483647,p=4294967295})),n.register("ktjib",(function(e,r){t(e.exports,"fromCharCode",(function(){return o})),t(e.exports,"fromCamelCase",(function(){return c})),t(e.exports,"utf8TextEncoder",(function(){return s})),t(e.exports,"encodeUtf8",(function(){return l})),t(e.exports,"utf8TextDecoder",(function(){return f})),t(e.exports,"decodeUtf8",(function(){return d})),t(e.exports,"repeat",(function(){return h}));var i=n("7qPwo"),o=String.fromCharCode,u=(String.fromCodePoint,o(65535),/^\s*/g),a=/([A-Z])/g,c=function(t,e){return function(t){return t.replace(u,"")}(t.replace(a,(function(t){return"".concat(e).concat(function(t){return t.toLowerCase()}(t))})))},s="undefined"!=typeof TextEncoder?new TextEncoder:null,l=s?function(t){return s.encode(t)}:function(t){for(var e=unescape(encodeURIComponent(t)),n=e.length,r=new Uint8Array(n),i=0;i<n;i++)r[i]=e.codePointAt(i);return r},f="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});f&&1===f.decode(new Uint8Array).length&&(f=null);var d=f?function(t){return f.decode(t)}:function(t){for(var e=t.length,n="",r=0;e>0;){var i=e<1e4?e:1e4,o=t.subarray(r,r+i);r+=i,n+=String.fromCodePoint.apply(null,o),e-=i}return decodeURIComponent(escape(n))},h=function(t,e){return i.unfold(e,(function(){return t})).join("")}})),n.register("i9WxE",(function(e,r){t(e.exports,"createDecoder",(function(){return p})),t(e.exports,"hasContent",(function(){return y})),t(e.exports,"readVarUint8Array",(function(){return k})),t(e.exports,"readVarUint",(function(){return m})),t(e.exports,"readUint8",(function(){return w})),t(e.exports,"readVarInt",(function(){return b})),t(e.exports,"readVarString",(function(){return _})),t(e.exports,"readAny",(function(){return E})),t(e.exports,"RleDecoder",(function(){return D})),t(e.exports,"UintOptRleDecoder",(function(){return C})),t(e.exports,"IntDiffOptRleDecoder",(function(){return U})),t(e.exports,"StringDecoder",(function(){return A}));var i=n("9Klpk"),o=n("3bWnf"),u=n("kb0qF"),a=n("bWNdT"),c=n("hrH1s"),s=n("3db39"),l=n("duEab"),f=n("ktjib"),d=n("9eXpO"),h=(n("iwMp2"),d.create("Unexpected end of array")),v=d.create("Integer out of Range"),g=function t(e){"use strict";(0,i.default)(this,t),this.arr=e,this.pos=0},p=function(t){return new g(t)},y=function(t){return t.pos!==t.arr.length},k=function(t){return function(t,e){var n=new Uint8Array(t.arr.buffer,t.pos+t.arr.byteOffset,e);return t.pos+=e,n}(t,m(t))},w=function(t){return t.arr[t.pos++]},m=function(t){for(var e=0,n=1,r=t.arr.length;t.pos<r;){var i=t.arr[t.pos++];if(e+=(i&c.BITS7)*n,n*=128,i<c.BIT8)return e;if(e>l.MAX_SAFE_INTEGER)throw v}throw h},b=function(t){var e=t.arr[t.pos++],n=e&c.BITS6,r=64,i=(e&c.BIT7)>0?-1:1;if(0==(e&c.BIT8))return i*n;for(var o=t.arr.length;t.pos<o;){if(n+=((e=t.arr[t.pos++])&c.BITS7)*r,r*=128,e<c.BIT8)return i*n;if(n>l.MAX_SAFE_INTEGER)throw v}throw h},_=f.utf8TextDecoder?function(t){return f.utf8TextDecoder.decode(k(t))}:function(t){var e=m(t);if(0===e)return"";var n=String.fromCodePoint(w(t));if(--e<100)for(;e--;)n+=String.fromCodePoint(w(t));else for(;e>0;){var r=e<1e4?e:1e4,i=t.arr.subarray(t.pos,t.pos+r);t.pos+=r,n+=String.fromCodePoint.apply(null,i),e-=r}return decodeURIComponent(escape(n))},S=function(t,e){var n=new DataView(t.arr.buffer,t.arr.byteOffset+t.pos,e);return t.pos+=e,n},x=[function(t){},function(t){return null},b,function(t){return S(t,4).getFloat32(0,!1)},function(t){return S(t,8).getFloat64(0,!1)},function(t){return S(t,8).getBigInt64(0,!1)},function(t){return!1},function(t){return!0},_,function(t){for(var e=m(t),n={},r=0;r<e;r++)n[_(t)]=E(t);return n},function(t){for(var e=m(t),n=[],r=0;r<e;r++)n.push(E(t));return n},k],E=function(t){return x[127-w(t)](t)},D=function(t){"use strict";(0,u.default)(n,t);var e=(0,a.default)(n);function n(t,r){var o;return(0,i.default)(this,n),(o=e.call(this,t)).reader=r,o.s=null,o.count=0,o}return(0,o.default)(n,[{key:"read",value:function(){return 0===this.count&&(this.s=this.reader(this),y(this)?this.count=m(this)+1:this.count=-1),this.count--,this.s}}]),n}(g),C=function(t){"use strict";(0,u.default)(n,t);var e=(0,a.default)(n);function n(t){var r;return(0,i.default)(this,n),(r=e.call(this,t)).s=0,r.count=0,r}return(0,o.default)(n,[{key:"read",value:function(){if(0===this.count){this.s=b(this);var t=s.isNegativeZero(this.s);this.count=1,t&&(this.s=-this.s,this.count=m(this)+2)}return this.count--,this.s}}]),n}(g),U=function(t){"use strict";(0,u.default)(n,t);var e=(0,a.default)(n);function n(t){var r;return(0,i.default)(this,n),(r=e.call(this,t)).s=0,r.count=0,r.diff=0,r}return(0,o.default)(n,[{key:"read",value:function(){if(0===this.count){var t=b(this),e=1&t;this.diff=s.floor(t/2),this.count=1,e&&(this.count=m(this)+2)}return this.s+=this.diff,this.count--,this.s}}]),n}(g),A=function(){"use strict";function t(e){(0,i.default)(this,t),this.decoder=new C(e),this.str=_(this.decoder),this.spos=0}return(0,o.default)(t,[{key:"read",value:function(){var t=this.spos+this.decoder.read(),e=this.str.slice(this.spos,t);return this.spos=t,e}}]),t}()})),n.register("9eXpO",(function(e,n){t(e.exports,"create",(function(){return r})),t(e.exports,"methodUnimplemented",(function(){return i})),t(e.exports,"unexpectedCase",(function(){return o}));var r=function(t){return new Error(t)},i=function(){throw r("Method unimplemented")},o=function(){throw r("Unexpected case")}})),n.register("8C35u",(function(e,r){t(e.exports,"uint32",(function(){return o})),t(e.exports,"uuidv4",(function(){return u})),n("3db39"),n("hrH1s");var i=n("18TcP"),o=(Math.random,function(){return(0,i.getRandomValues)(new Uint32Array(1))[0]}),u=function(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(function(t){return(t^o()&15>>t/4).toString(16)}))}})),n.register("18TcP",(function(e,n){t(e.exports,"getRandomValues",(function(){return r})),crypto.subtle;var r=crypto.getRandomValues.bind(crypto)})),n.register("3bx5p",(function(e,r){t(e.exports,"create",(function(){return i})),n("c01oj");var i=function(t){return new Promise(t)};Promise.all.bind(Promise)})),n.register("c01oj",(function(e,r){t(e.exports,"getUnixTime",(function(){return i})),n("iWb4B"),n("3db39");var i=Date.now})),n.register("iWb4B",(function(e,r){t(e.exports,"prefix",(function(){return a}));var i=n("3db39"),o=["","k","M","G","T","P","E","Z","Y"],u=["","m","","n","p","f","a","z","y"],a=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0===t?0:i.log10(t),r=0;n<3*r&&e>-8;)e--,r--;for(;n>=3+3*r&&e<8;)e++,r++;var a=e<0?u[-e]:o[e];return{n:i.round(1e12*(r>0?t/i.exp10(3*r):t*i.exp10(-3*r)))/1e12,prefix:a}}})),n.register("jKUB9",(function(e,r){t(e.exports,"copyUint8Array",(function(){return o}));n("ktjib");var i=n("eYuQa"),o=(n("7qPwo"),n("3db39"),n("iwMp2"),n("i9WxE"),n("cwBhL").Buffer,i.isBrowser,i.isBrowser,function(t){var e=function(t){return new Uint8Array(t)}(t.byteLength);return e.set(t),e})})),n.register("eYuQa",(function(e,r){t(e.exports,"isBrowser",(function(){return h})),t(e.exports,"getVariable",(function(){return p})),t(e.exports,"supportsColor",(function(){return k}));var i,o=n("5ENmm"),u=n("lOVDE"),a=n("ktjib"),c=n("7bzB6"),s=n("a1im1"),l=n("dNOud"),f=n("84cK9"),d=void 0!==f&&f.release&&/node|io\.js/.test(f.release.name)&&"[object process]"===Object.prototype.toString.call(void 0!==f?f:0),h="undefined"!=typeof window&&"undefined"!=typeof document&&!d,v=("undefined"!=typeof navigator&&/Mac/.test(navigator.platform),[]),g=function(t){return function(){if(void 0===i)if(d){i=u.create();for(var t=f.argv,e=null,n=0;n<t.length;n++){var r=t[n];"-"===r[0]?(null!==e&&i.set(e,""),e=r):null!==e?(i.set(e,r),e=null):v.push(r)}null!==e&&i.set(e,"")}else"object"==typeof location?(i=u.create(),(location.search||"?").slice(1).split("&").forEach((function(t){if(0!==t.length){var e=(0,o.default)(t.split("="),2),n=e[0],r=e[1];i.set("--".concat(a.fromCamelCase(n,"-")),r),i.set("-".concat(a.fromCamelCase(n,"-")),r)}}))):i=u.create();return i}().has(t)},p=function(t){return d?c.undefinedToNull(f.env[t.toUpperCase()]):c.undefinedToNull(s.varStorage.getItem(t))},y=(g("--"+"production")||p("production"),d&&l.isOneOf(void 0,["true","1","2"])),k=!g("no-colors")&&(!d||f.stdout.isTTY||y)&&(!d||g("color")||y||null!==p("COLORTERM")||(p("TERM")||"").includes("color"))})),n.register("7bzB6",(function(e,n){t(e.exports,"undefinedToNull",(function(){return r}));var r=function(t){return void 0===t?null:t}})),n.register("a1im1",(function(e,r){t(e.exports,"varStorage",(function(){return a}));var i=n("9Klpk"),o=n("3bWnf"),u=new(function(){"use strict";function t(){(0,i.default)(this,t),this.map=new Map}return(0,o.default)(t,[{key:"setItem",value:function(t,e){this.map.set(t,e)}},{key:"getItem",value:function(t){return this.map.get(t)}}]),t}());try{"undefined"!=typeof localStorage&&localStorage&&(u=localStorage)}catch(t){}var a=u})),n.register("dNOud",(function(e,r){t(e.exports,"callAll",(function(){return u})),t(e.exports,"nop",(function(){return a})),t(e.exports,"id",(function(){return c})),t(e.exports,"isOneOf",(function(){return s}));var i=n("6Wo7Q"),o=n("7qPwo"),u=(n("7ke8k"),function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;try{for(var r;n<t.length;n++)(r=t)[n].apply(r,(0,i.default)(e))}finally{n<t.length&&u(t,e,n+1)}}),a=function(){},c=function(t){return t},s=function(t,e){return e.includes(t)};o.isArray})),n.register("7ke8k",(function(e,n){t(e.exports,"assign",(function(){return r})),t(e.exports,"forEach",(function(){return o})),t(e.exports,"length",(function(){return u})),t(e.exports,"isEmpty",(function(){return a})),t(e.exports,"hasProperty",(function(){return c})),t(e.exports,"equalFlat",(function(){return s}));var r=Object.assign,i=Object.keys,o=function(t,e){for(var n in t)e(t[n],n)},u=function(t){return i(t).length},a=function(t){for(var e in t)return!1;return!0},c=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s=function(t,e){return t===e||u(t)===u(e)&&function(t,e){for(var n in t)if(!e(t[n],n))return!1;return!0}(t,(function(t,n){return(void 0!==t||c(e,n))&&e[n]===t}))}})),n.register("84cK9",(function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(t){r=u}}();var c,s=[],l=!1,f=-1;function d(){l&&c&&(l=!1,c.length?s=c.concat(s):f=-1,s.length&&h())}function h(){if(!l){var t=a(d);l=!0;for(var e=s.length;e;){for(c=s,s=[];++f<e;)c&&c[f].run();f=-1,e=s.length}c=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function v(t,e){this.fun=t,this.array=e}function g(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new v(t,e)),1!==s.length||l||a(h)},v.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}})),n.register("b0TDd",(function(e,r){t(e.exports,"print",(function(){return g})),t(e.exports,"warn",(function(){return p})),t(e.exports,"BOLD",(function(){return n("byQoJ").BOLD})),t(e.exports,"UNBOLD",(function(){return n("byQoJ").UNBOLD})),t(e.exports,"RED",(function(){return n("byQoJ").RED})),t(e.exports,"ORANGE",(function(){return n("byQoJ").ORANGE})),n("9Klpk"),n("3bWnf");var i,o=n("eT7f3"),u=n("6Wo7Q"),a=n("eYuQa"),c=n("iitZb"),s=n("3h204"),l=n("FmvFl"),f=(n("eFhFn"),n("lOVDE")),d=(n("fh7Pr"),n("3db39"),n("byQoJ")),h=(d=n("byQoJ"),i={},(0,o.default)(i,d.BOLD,s.create("font-weight","bold")),(0,o.default)(i,d.UNBOLD,s.create("font-weight","normal")),(0,o.default)(i,d.BLUE,s.create("color","blue")),(0,o.default)(i,d.GREEN,s.create("color","green")),(0,o.default)(i,d.GREY,s.create("color","grey")),(0,o.default)(i,d.RED,s.create("color","red")),(0,o.default)(i,d.PURPLE,s.create("color","purple")),(0,o.default)(i,d.ORANGE,s.create("color","orange")),(0,o.default)(i,d.UNCOLOR,s.create("color","black")),i),v=a.supportsColor?function(t){for(var e=[],n=[],r=f.create(),i=[],o=0;o<t.length;o++){var u=t[o],a=h[u];if(void 0!==a)r.set(a.left,a.right);else{if(u.constructor!==String&&u.constructor!==Number)break;var c=l.mapToStyleString(r);o>0||c.length>0?(e.push("%c"+u),n.push(c)):e.push(u)}}for(o>0&&(i=n).unshift(e.join(""));o<t.length;o++){var s=t[o];s instanceof Symbol||i.push(s)}return i}:d.computeNoColorLoggingArgs,g=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r;(r=console).log.apply(r,(0,u.default)(v(e))),y.forEach((function(t){return t.print(e)}))},p=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r;(r=console).warn.apply(r,(0,u.default)(v(e))),e.unshift(d.ORANGE),y.forEach((function(t){return t.print(e)}))},y=c.create()})),n.register("3h204",(function(e,r){t(e.exports,"create",(function(){return u})),t(e.exports,"forEach",(function(){return a}));var i=n("9Klpk"),o=function t(e,n){"use strict";(0,i.default)(this,t),this.left=e,this.right=n},u=function(t,e){return new o(t,e)},a=function(t,e){return t.forEach((function(t){return e(t.left,t.right)}))}})),n.register("FmvFl",(function(e,r){t(e.exports,"append",(function(){return s})),t(e.exports,"addEventListener",(function(){return l})),t(e.exports,"element",(function(){return f})),t(e.exports,"text",(function(){return d})),t(e.exports,"mapToStyleString",(function(){return h}));var i=n("3h204"),o=n("lOVDE"),u="undefined"!=typeof document?document:{},a=function(t){return u.createElement(t)},c=("undefined"!=typeof DOMParser&&new DOMParser,function(t,e){return i.forEach(e,(function(e,n){!1===n?t.removeAttribute(e):!0===n?t.setAttribute(e,""):t.setAttribute(e,n)})),t}),s=function(t,e){return v(t,function(t){for(var e=u.createDocumentFragment(),n=0;n<t.length;n++)v(e,t[n]);return e}(e)),t},l=function(t,e,n){return t.addEventListener(e,n)},f=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return s(c(a(t),e),n)},d=function(t){return u.createTextNode(t)},h=function(t){return o.map(t,(function(t,e){return"".concat(e,":").concat(t,";")})).join("")},v=function(t,e){return t.appendChild(e)};u.ELEMENT_NODE,u.TEXT_NODE,u.CDATA_SECTION_NODE,u.COMMENT_NODE,u.DOCUMENT_NODE,u.DOCUMENT_TYPE_NODE,u.DOCUMENT_FRAGMENT_NODE})),n.register("eFhFn",(function(e,n){t(e.exports,"stringify",(function(){return r}));var r=JSON.stringify;JSON.parse})),n.register("fh7Pr",(function(e,r){t(e.exports,"enqueue",(function(){return c}));var i=n("9Klpk"),o=n("3bWnf"),u=[],a=function(){for(var t=0;t<u.length;t++)u[t]();u=[]},c=function(t){u.push(t),1===u.length&&setTimeout(a,0)},s=function(t){return function(){"use strict";function e(t){(0,i.default)(this,e),this._=t}return(0,o.default)(e,[{key:"destroy",value:function(){t(this._)}}]),e}()};s(clearTimeout),s(clearInterval),s((function(t){return"undefined"!=typeof requestAnimationFrame&&cancelAnimationFrame(t)})),s((function(t){return"undefined"!=typeof cancelIdleCallback&&cancelIdleCallback(t)}))})),n.register("byQoJ",(function(e,r){t(e.exports,"BOLD",(function(){return l})),t(e.exports,"UNBOLD",(function(){return f})),t(e.exports,"BLUE",(function(){return d})),t(e.exports,"GREY",(function(){return h})),t(e.exports,"GREEN",(function(){return v})),t(e.exports,"RED",(function(){return g})),t(e.exports,"PURPLE",(function(){return p})),t(e.exports,"ORANGE",(function(){return y})),t(e.exports,"UNCOLOR",(function(){return k})),t(e.exports,"computeNoColorLoggingArgs",(function(){return w})),t(e.exports,"createModuleLogger",(function(){return S}));var i=n("6Wo7Q"),o=n("rJmE6"),u=n("e2K8J"),a=n("c01oj"),c=n("eYuQa"),s=n("dNOud"),l=u.create(),f=u.create(),d=u.create(),h=u.create(),v=u.create(),g=u.create(),p=u.create(),y=u.create(),k=u.create(),w=function(t){for(var e=[],n=[],r=0;r<t.length;r++){var i=t[r];i.constructor===String||i.constructor===Number?e.push(i):i.constructor===Object&&n.push(JSON.stringify(i))}return n},m=[v,p,y,d],b=0,_=a.getUnixTime(),S=function(t,e){var n=m[b],r=c.getVariable("log"),u=null!==r&&("*"===r||"true"===r||new RegExp(r,"gi").test(e));return b=(b+1)%m.length,e+=": ",u?function(){for(var r=arguments.length,u=new Array(r),c=0;c<r;c++)u[c]=arguments[c];var s=a.getUnixTime(),l=s-_;_=s,t.apply(void 0,[n,e,k].concat((0,i.default)(u.map((function(t){return"string"==typeof t||"symbol"===(void 0===t?"undefined":(0,o.default)(t))?t:JSON.stringify(t)}))),[n," +"+l+"ms"]))}:s.nop}})),n.register("e2K8J",(function(e,r){t(e.exports,"create",(function(){return i})),n("rJmE6");var i=Symbol})),n.register("2EkIU",(function(e,r){t(e.exports,"iteratorFilter",(function(){return u})),t(e.exports,"iteratorMap",(function(){return a}));var i=n("eT7f3"),o=function(t){var e;return e={},(0,i.default)(e,Symbol.iterator,(function(){return this})),(0,i.default)(e,"next",t),e},u=function(t,e){return o((function(){var n;do{n=t.next()}while(!n.done&&!e(n.value));return n}))},a=function(t,e){return o((function(){var n=t.next(),r=n.done,i=n.value;return{done:r,value:r?void 0:e(i)}}))}})),n.register("17n8H",(function(e,r){t(e.exports,"YKeyValue",(function(){return c}));var i=n("9Klpk"),o=n("3bWnf"),u=n("kb0qF"),a=n("bWNdT"),c=function(t){"use strict";(0,u.default)(n,t);var e=(0,a.default)(n);function n(t){var r;(0,i.default)(this,n),(r=e.call(this)).yarray=t,r.doc=t.doc,r.map=new Map;var o=t.toArray();return r.doc.transact((function(){for(var e=o.length-1;e>=0;e--){var n=o[e];r.map.has(n.key)?t.delete(e):r.map.set(n.key,n)}})),t.observe((function(e,n){var i=new Map,o=Array.from(e.changes.added);e.changes.deleted.forEach((function(t){t.content.getContent().forEach((function(t){r.map.get(t.key)===t&&(r.map.delete(t.key),i.set(t.key,{action:"delete",oldValue:t.val}))}))}));var u=new Map;o.map((function(t){return t.content.getContent()})).flat().forEach((function(t){u.set(t.key,t)}));var a=new Set,c=t.toArray();r.doc.transact((function(e){for(var n=c.length-1;n>=0&&(u.size>0||a.size>0);n--){var o=c[n];if(a.has(o.key))a.delete(o.key),t.delete(n,1);else if(u.get(o.key)===o){var s=r.map.get(o.key);if(s)a.add(o.key),i.set(o.key,{action:"update",oldValue:s.val,newValue:o.val});else{var l=i.get(o.key);l&&"delete"===l.action?i.set(o.key,{action:"update",newValue:o.val,oldValue:l.oldValue}):i.set(o.key,{action:"add",newValue:o.val})}u.delete(o.key),r.map.set(o.key,o)}else u.has(o.key)&&(a.add(o.key),u.delete(o.key))}})),i.size>0&&r.emit("change",[i,n])})),r}return(0,o.default)(n,[{key:"set",value:function(t,e){var n=this;this.doc.transact((function(r){n.map.has(t)&&n.delete(t),n.yarray.push([{key:t,val:e}])}))}},{key:"delete",value:function(t){var e=0,n=!0,r=!1,i=void 0;try{for(var o,u=this.yarray[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){if(o.value.key===t){this.yarray.delete(e);break}e++}}catch(t){r=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(r)throw i}}}},{key:"get",value:function(t){var e=this.map.get(t);return e&&e.val}},{key:"has",value:function(t){return this.map.has(t)}}]),n}(n("l6jCY").Observable)})),n.register("ie2ZQ",(function(e,n){t(e.exports,"encode",(function(){return i})),t(e.exports,"decode",(function(){return u}));var r=String.fromCharCode,i=function(t){for(var e=[],n=0,i=t.length;n<i;n++)e.push(r(t[n]));return btoa(e.join(""))},o=function(t){return t.charCodeAt(0)},u=function(t){return Uint8Array.from(atob(t),o)}}))}();
