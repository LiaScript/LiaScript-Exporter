!function(){function t(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n=e.parcelRequire55a5;n.register("61A8y",(function(e,r){t(e.exports,"default",(function(){return u}));var i=n("g05cL");function o(t,e,n){return o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=(0,i.default)(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n||t):o.value}},o(t,e,n)}function u(t,e,n){return o(t,e,n)}})),n.register("g05cL",(function(e,r){t(e.exports,"default",(function(){return o}));var i=n("5gj45");function o(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=(0,i.default)(t)););return t}})),n.register("dDIEk",(function(e,r){t(e.exports,"uint8_to_base64",(function(){return l})),t(e.exports,"base64_to_unit8",(function(){return f})),t(e.exports,"Sync",(function(){return h}));var i=n("kxanC"),o=n("hWDD9"),u=n("dLRop"),c=n("vUD3z"),a=n("lmHkB"),s=n("bF0bi");function l(t){return(0,s.encode)(t)}function f(t){return(0,s.decode)(t)}function d(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="",r=0;r<t;r++)n+=e.charAt(Math.floor(Math.random()*e.length));return n}var h=function(){"use strict";function t(e,n){var r,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=this;(0,i.default)(this,t),(0,u.default)(this,"isConnected",!1);try{(r=window.localStorage.getItem("lia-token"))||(r=d(),window.localStorage.setItem("lia-token",r))}catch(t){console.warn("cannot write to localStorage"),r=d()}this.token=r,this.urlCounter=0,this.cbConnection=e,this.cbRelay=n;var l=this,f=function(t){var e=function(){return 2e3*(t.db.getPeers().length+1)},n=null;function r(){if(t.isConnected)try{t.broadcast(t.db.encode()),n=window.setTimeout(r,e())}catch(t){n=null}}return function(){n&&window.clearTimeout(n),n=window.setTimeout(r,e())}}(l);this.gossip=f;var h=c.throttle((function(){l.broadcast(l.db.encode()),f()}),1e3);this.db=new(0,a.CRDT)(r,o?function(t,e){if(l.db){switch(e){case"cursor":s.sync("update",{cmd:"cursor",param:t});break;case"peer":s.sync("update",{cmd:"peer",param:t});break;case"code":s.sync("update",{cmd:"code",param:t});break;case"quiz":s.sync("update",{cmd:"quiz",param:t});break;case"survey":s.sync("update",{cmd:"survey",param:t});break;case"exit":try{e=null,s.broadcast(t),s.destroy()}catch(t){}break;default:console.warn("Sync unknown origin",e)}e&&h()}}:void 0)}return(0,o.default)(t,[{key:"connect",value:function(t){this.room=t.room,this.course=t.course,this.password=t.password,this.isConnected=!0}},{key:"destroy",value:function(){this.db.destroy(),this.cbConnection("disconnect",this.token),this.isConnected=!1}},{key:"disconnect",value:function(){this.db.removePeer()}},{key:"uniqueID",value:function(){return"string"==typeof this.room&&(this.room.startsWith('"')&&this.room.endsWith('"')||this.room.startsWith("'")&&this.room.endsWith("'"))?this.room:this.course&&this.room?JSON.stringify({course:this.course,room:this.room}):(console.warn("Sync: no uniqueID"),null)}},{key:"sendToLia",value:function(t){this.cbRelay(t)}},{key:"sync",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.cbConnection(t,e)}},{key:"sendDisconnectError",value:function(t){this.sync("error",t)}},{key:"sendConnect",value:function(){this.sync("connect",this.token)}},{key:"update",value:function(){try{var t=this.db.getPeers();this.sync("update",{peers:t,data:this.db.toJSON(),cursors:this.db.getCursors(t)})}catch(t){console.warn("Sync Update ->",t)}}},{key:"broadcast",value:function(t){console.warn("broadcast needs to be implemented")}},{key:"load",value:function(t,e){try{for(var n=this,r=function(r){var i=document.createElement("script");i.async=!1,i.defer=!0,i.src=t[r],n.urlCounter++;var o=n;i.onload=function(){console.log("successfully loaded =>",t),o.urlCounter--,0==o.urlCounter&&e.init(!0)},i.onerror=function(n){console.warn("could not load =>",t,n),o.urlCounter=0,e.init(!1,"could not load => ".concat(t))},document.head.appendChild(i)},i=0;i<t.length;i++)r(i)}catch(t){console.error("load: ",t),e.init(!1,t.message)}}},{key:"publish",value:function(t){switch(t.message.cmd){case"update":break;case"join":this.db.init(t.message.param),this.gossip();break;case"quiz":var e,n;"quiz"===(null===(e=t.track)||void 0===e?void 0:e[0][0])&&"id"===(null===(n=t.track)||void 0===n?void 0:n[1][0])?this.db.addQuiz(t.track[0][1],t.track[1][1],t.message.param):console.warn("SyncTX wrong event ->",t);break;case"survey":var r,i;"survey"===(null===(r=t.track)||void 0===r?void 0:r[0][0])&&"id"===(null===(i=t.track)||void 0===i?void 0:i[1][0])?this.db.addSurvey(t.track[0][1],t.track[1][1],t.message.param):console.warn("SyncTX wrong event ->",t);break;case"code":var o,u;"code"===(null===(o=t.track)||void 0===o?void 0:o[0][0])&&"id"===(null===(u=t.track)||void 0===u?void 0:u[1][0])?this.db.updateCode(t.track[0][1],t.track[1][1],t.message.param.j,t.message.param.msg):console.warn("SyncTX wrong event ->",t);break;case"codes":var c;if("code"===(null===(c=t.track)||void 0===c?void 0:c[0][0])&&1===t.track.length)for(var a=0;a<t.message.param.length;a++)for(var s=0;s<t.message.param[a].length;s++)this.db.initCode(t.track[0][1],a,s,t.message.param[a][s]);else console.warn("SyncTX wrong event ->",t);break;case"cursor":var l;"code"==(null===(l=t.track)||void 0===l?void 0:l[0][0])&&this.db.setCursor(t.track[0][1],t.message.param);break;default:console.warn("SyncTX unknown command:",t.message)}}},{key:"applyUpdate",value:function(t){this.db.applyUpdate(t)}}]),t}()})),n.register("lmHkB",(function(e,r){t(e.exports,"CRDT",(function(){return s}));var i=n("kxanC"),o=n("hWDD9"),u=n("mBz5n"),c=n("fdj4S"),a=n("vUD3z"),s=function(){"use strict";function t(e,n){var r=this;(0,i.default)(this,t),this.doc=new c.Doc,this.callback=n||function(t,e){console.warn("SyncDB: no callback provided")},this.length=0,this.peerID=e,this.peers=this.doc.getMap("peers"),this.cursors=this.doc.getMap("cursors"),this.codes=this.doc.getMap("c"),this.quizzes=this.doc.getMap("q"),this.surveys=this.doc.getMap("s"),n&&(this.peers.observe((function(t){var e=r.getPeers();n(e,"peer")})),this.cursors.observe((function(t){var e=r.getPeers();n(r.getCursors(e),"cursor")})),this.quizzes.observeDeep((function(t){n(r.getQuiz(),"quiz")})),this.surveys.observeDeep((function(t){n(r.getSurvey(),"survey")})),this.codes.observeDeep((function(t){n(r.getCode(),"code")}))),this.peers.set(e,!0)}return(0,o.default)(t,[{key:"init",value:function(t){var e=this;this.length=Math.max(this.length,t.length);var n=this;this.doc.transact((function(){for(var r=0;r<t.length;r++)n.initMap(e.quizzes,r,t[r].q),n.initMap(e.surveys,r,t[r].s),n.initText(r,t[r].c)}),this.peerID)}},{key:"encode",value:function(){return c.encodeStateAsUpdate(this.doc)}},{key:"destroy",value:function(){this.doc.destroy()}},{key:"applyUpdate",value:function(t){var e=this;this.doc.transact((function(){!1===e.peers.get(e.peerID)&&e.peers.set(e.peerID,!0),c.applyUpdate(e.doc,t)}))}},{key:"log",value:function(){console.warn("*********** PEERS ***********"),console.warn(this.peers.toJSON()),console.warn("*********** STATE ***********"),console.warn(this.doc.toJSON())}},{key:"initMap",value:function(t,e,n){if(0!==n.length)for(var r,i=this.doc.clientID,o=0;o<n.length;o++)for(var u in(r=t.get(this.id(e,o)))||(this.doc.clientID=0,r=new c.Map,t.set(this.id(e,o),r),this.doc.clientID=i),n[o])r.set(u,n[o][u])}},{key:"initText",value:function(t,e){if(0!==e.length)for(var n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)this.initCode(t,n,r,e[n][r])}},{key:"diff",value:function(t){return c.encodeStateAsUpdate(this.doc,t)}},{key:"toJSON",value:function(){for(var t=[],e=0;e<this.length;e++)t.push({s:[],q:[],c:this.getAllTexts(e)});return t}},{key:"getCode",value:function(){for(var t=[],e=0;e<this.length;e++)t.push(this.getAllTexts(e));return t}},{key:"getQuiz",value:function(){for(var t=[],e=0;e<this.length;e++)t.push(this.getAllMaps(this.quizzes,e));return t}},{key:"getSurvey",value:function(){for(var t=[],e=0;e<this.length;e++)t.push(this.getAllMaps(this.surveys,e));return t}},{key:"getCursors",value:function(t){var e=[],n=this.cursors.toJSON(),r=!0,i=!1,o=void 0;try{for(var u,c=t[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var a=u.value;a!==this.peerID&&void 0!==n[a]&&e.push(n[a])}}catch(t){i=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return e}},{key:"getPeers",value:function(){var t=this.peers.toJSON();return t?Object.entries(t).filter((function(t){var e=(0,u.default)(t,2);return e[0],e[1]})).map((function(t){var e=(0,u.default)(t,2),n=e[0];return e[1],n})):[]}},{key:"removePeer",value:function(t){var e=this;this.doc.transact((function(){e.peers.set(t||e.peerID,!1)})),void 0===t&&this.callback(this.encode(),"exit")}},{key:"id",value:function(t,e,n){return void 0===n?t+":"+e:t+":"+e+","+n}},{key:"getMap",value:function(t,e,n){return this.doc.getMap(this.id(e,n))}},{key:"getAllMaps",value:function(t,e){for(var n,r=[],i=0;t.has(this.id(e,i));i++)n=t.get(this.id(e,i)),r.push(n.toJSON());return r}},{key:"getAllTexts",value:function(t){for(var e,n=[],r=0;this.codes.has(this.id(t,r,0));r++){for(var i=[],o=0;this.codes.has(this.id(t,r,o));o++)e=this.codes.get(this.id(t,r,o)),i.push((null==e?void 0:e.toString())||"");n.push(i)}return n}},{key:"addQuiz",value:function(t,e,n){this.addRecord(this.quizzes,t,e,n)}},{key:"addSurvey",value:function(t,e,n){this.addRecord(this.surveys,t,e,n)}},{key:"addRecord",value:function(t,e,n,r){var i=t.get(this.id(e,n));if(!i){var o=this.doc.clientID;this.doc.clientID=0,i=new c.Map,t.set(this.id(e,n),i),this.doc.clientID=o}i.has(this.peerID)||i.set(this.peerID,r)}},{key:"initCode",value:function(t,e,n,r){if(!this.codes.has(this.id(t,e,n))){var i=this.doc.clientID;this.doc.clientID=0;var o=new c.Text;o.insert(0,r),this.codes.set(this.id(t,e,n),o),this.doc.clientID=i}}},{key:"updateCode",value:function(t,e,n,r){var i=this;this.codes.has(this.id(t,e,n))&&this.doc.transact((function(){var o=i.codes.get(i.id(t,e,n));if(void 0!==o){var u=!0,c=!1,a=void 0;try{for(var s,l=r[Symbol.iterator]();!(u=(s=l.next()).done);u=!0){var f=s.value;switch(f.action){case"insert":o.insert(f.index,f.content);break;case"remove":o.delete(f.index,f.content.length);break;default:console.warn("Sync code, unknown action ->",f)}}}catch(t){c=!0,a=t}finally{try{u||null==l.return||l.return()}finally{if(c)throw a}}}}),"code")}},{key:"getColor",value:function(){return this.color||(this.color=a.getColorFor(this.peerID)),this.color}},{key:"setCursor",value:function(t,e){var n=this;this.doc.transact((function(){n.cursors.set(n.peerID,{id:n.peerID,section:t,project:e.project,file:e.file,state:e.state,color:n.getColor()})}),"cursor")}},{key:"removeCursor",value:function(){this.cursors.delete(this.peerID)}}]),t}()})),n.register("fdj4S",(function(r,i){t(r.exports,"Doc",(function(){return G})),t(r.exports,"Text",(function(){return Be})),t(r.exports,"Map",(function(){return _e})),t(r.exports,"applyUpdate",(function(){return ct})),t(r.exports,"encodeStateAsUpdate",(function(){return st}));var o=n("Yawv5"),u=n("kxanC"),c=n("hWDD9"),a=n("dLRop"),s=n("61A8y"),l=n("5gj45"),f=n("cksMj"),d=n("hxnqR"),h=n("iFdjt"),v=n("mBz5n"),g=n("9oGi2"),p=n("giCK6"),y=n("eQNFO"),k=n("l6A6q"),w=n("gJ9ip"),m=n("j4QyJ"),b=n("8lrtM"),_=n("5oPGD"),D=n("d9ERd"),S=n("cTGdB"),x=n("fBBhS"),E=n("1xlRH"),C=n("4ehDZ"),A=n("1rtpa"),U=n("3ODE7"),I=(U=n("3ODE7"),n("i4ULi")),T=n("ey6DQ"),O=(n("bNyGR"),n("jZVBM")),M=n("6J7QR"),V=(k.Observable,function t(e,n){"use strict";(0,u.default)(this,t),this.clock=e,this.len=n}),N=function t(){"use strict";(0,u.default)(this,t),this.clients=new Map},B=function(t,e,n){return e.clients.forEach((function(e,r){for(var i=t.doc.store.clients.get(r),o=0;o<e.length;o++){var u=e[o];Tt(t,i,u.clock,u.len,n)}}))},R=function(t,e){var n=t.clients.get(e.client);return void 0!==n&&null!==function(t,e){for(var n=0,r=t.length-1;n<=r;){var i=m.floor((n+r)/2),o=t[i],u=o.clock;if(u<=e){if(e<u+o.len)return i;n=i+1}else r=i-1}return null}(n,e.clock)},L=function(t){t.clients.forEach((function(t){var e,n;for(t.sort((function(t,e){return t.clock-e.clock})),e=1,n=1;e<t.length;e++){var r=t[n-1],i=t[e];r.clock+r.len>=i.clock?r.len=m.max(r.len,i.clock+i.len-r.clock):(n<e&&(t[n]=i),n++)}t.length=n}))},j=function(t){for(var e=function(e){t[e].clients.forEach((function(r,i){if(!n.clients.has(i)){for(var o=r.slice(),u=e+1;u<t.length;u++)w.appendTo(o,t[u].clients.get(i)||[]);n.clients.set(i,o)}}))},n=new N,r=0;r<t.length;r++)e(r);return L(n),n},J=function(t,e,n,r){b.setIfUndefined(t.clients,e,(function(){return[]})).push(new V(n,r))},P=function(){return new N},z=function(t){var e=P();return t.clients.forEach((function(t,n){for(var r=[],i=0;i<t.length;i++){var o=t[i];if(o.deleted){var u=o.id.clock,c=o.length;if(i+1<t.length)for(var a=t[i+1];i+1<t.length&&a.deleted;a=t[1+ ++i])c+=a.length;r.push(new V(u,c))}}r.length>0&&e.clients.set(n,r)})),e},F=function(t,e){_.writeVarUint(t.restEncoder,e.clients.size),e.clients.forEach((function(e,n){t.resetDsCurVal(),_.writeVarUint(t.restEncoder,n);var r=e.length;_.writeVarUint(t.restEncoder,r);for(var i=0;i<r;i++){var o=e[i];t.writeDsClock(o.clock),t.writeDsLen(o.len)}}))},W=function(t){for(var e=function(e){t.resetDsCurVal();var r=D.readVarUint(t.restDecoder),i=D.readVarUint(t.restDecoder);if(i>0)for(var o=b.setIfUndefined(n.clients,r,(function(){return[]})),u=0;u<i;u++)o.push(new V(t.readDsClock(),t.readDsLen()))},n=new N,r=D.readVarUint(t.restDecoder),i=0;i<r;i++)e();return n},q=function(t,e,n){for(var r=new N,i=D.readVarUint(t.restDecoder),o=0;o<i;o++){t.resetDsCurVal();for(var u=D.readVarUint(t.restDecoder),c=D.readVarUint(t.restDecoder),a=n.clients.get(u)||[],s=St(n,u),l=0;l<c;l++){var f=t.readDsClock(),d=f+t.readDsLen();if(f<s){s<d&&J(r,u,s,d-s);var h=Et(a,f),v=a[h];for(!v.deleted&&v.id.clock<f&&(a.splice(h+1,0,ln(e,v,f-v.id.clock)),h++);h<a.length&&(v=a[h++]).id.clock<d;)v.deleted||(d<v.id.clock+v.length&&a.splice(h,0,ln(e,v,d-v.id.clock)),v.delete(e))}else J(r,u,f,d-f)}}if(r.clients.size>0){var g=new et;return _.writeVarUint(g.restEncoder,0),F(g,r),g.toUint8Array()}return null},Q=S.uint32,G=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r.guid,c=void 0===i?S.uuidv4():i,a=r.collectionid,s=void 0===a?null:a,l=r.gc,f=void 0===l||l,d=r.gcFilter,h=void 0===d?function(){return!0}:d,v=r.meta,g=void 0===v?null:v,p=r.autoLoad,y=void 0!==p&&p,k=r.shouldLoad,w=void 0===k||k;return(0,u.default)(this,n),(t=e.call(this)).gc=f,t.gcFilter=h,t.clientID=Q(),t.guid=c,t.collectionid=s,t.share=new Map,t.store=new _t,t._transaction=null,t._transactionCleanups=[],t.subdocs=new Set,t._item=null,t.shouldLoad=w,t.autoLoad=y,t.meta=g,t.isLoaded=!1,t.whenLoaded=x.create((function(e){t.on("load",(function(){t.isLoaded=!0,e((0,o.default)(t))}))})),t}return(0,c.default)(n,[{key:"load",value:function(){var t=this,e=this._item;null===e||this.shouldLoad||Lt(e.parent.doc,(function(e){e.subdocsLoaded.add(t)}),null,!0),this.shouldLoad=!0}},{key:"getSubdocs",value:function(){return this.subdocs}},{key:"getSubdocGuids",value:function(){return new Set(Array.from(this.subdocs).map((function(t){return t.guid})))}},{key:"transact",value:function(t){Lt(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)}},{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:re,n=this,r=b.setIfUndefined(this.share,t,(function(){var t=new e;return t._integrate(n,null),t})),i=r.constructor;if(e!==re&&i!==e){if(i===re){var o=new e;o._map=r._map,r._map.forEach((function(t){for(;null!==t;t=t.left)t.parent=o})),o._start=r._start;for(var u=o._start;null!==u;u=u.right)u.parent=o;return o._length=r._length,this.share.set(t,o),o._integrate(this,null),o}throw new Error("Type with the name ".concat(t," has already been defined with a different constructor"))}return r}},{key:"getArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(t,me)}},{key:"getText",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(t,Be)}},{key:"getMap",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(t,_e)}},{key:"getXmlFragment",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(t,Le)}},{key:"toJSON",value:function(){var t={};return this.share.forEach((function(e,n){t[n]=e.toJSON()})),t}},{key:"destroy",value:function(){var t=this;w.from(this.subdocs).forEach((function(t){return t.destroy()}));var e=this._item;if(null!==e){this._item=null;var r=e.content;r.doc=new n((0,h.default)((0,d.default)({guid:this.guid},r.opts),{shouldLoad:!1})),r.doc._item=e,Lt(e.parent.doc,(function(n){var i=r.doc;e.deleted||n.subdocsAdded.add(i),n.subdocsRemoved.add(t)}),null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),(0,s.default)((0,l.default)(n.prototype),"destroy",this).call(this)}},{key:"on",value:function(t,e){(0,s.default)((0,l.default)(n.prototype),"on",this).call(this,t,e)}},{key:"off",value:function(t,e){(0,s.default)((0,l.default)(n.prototype),"off",this).call(this,t,e)}}]),n}(k.Observable),H=function(){"use strict";function t(e){(0,u.default)(this,t),this.restDecoder=e}return(0,c.default)(t,[{key:"resetDsCurVal",value:function(){}},{key:"readDsClock",value:function(){return D.readVarUint(this.restDecoder)}},{key:"readDsLen",value:function(){return D.readVarUint(this.restDecoder)}}]),t}(),K=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(){return(0,u.default)(this,n),e.apply(this,arguments)}return(0,c.default)(n,[{key:"readLeftID",value:function(){return kt(D.readVarUint(this.restDecoder),D.readVarUint(this.restDecoder))}},{key:"readRightID",value:function(){return kt(D.readVarUint(this.restDecoder),D.readVarUint(this.restDecoder))}},{key:"readClient",value:function(){return D.readVarUint(this.restDecoder)}},{key:"readInfo",value:function(){return D.readUint8(this.restDecoder)}},{key:"readString",value:function(){return D.readVarString(this.restDecoder)}},{key:"readParentInfo",value:function(){return 1===D.readVarUint(this.restDecoder)}},{key:"readTypeRef",value:function(){return D.readVarUint(this.restDecoder)}},{key:"readLen",value:function(){return D.readVarUint(this.restDecoder)}},{key:"readAny",value:function(){return D.readAny(this.restDecoder)}},{key:"readBuf",value:function(){return E.copyUint8Array(D.readVarUint8Array(this.restDecoder))}},{key:"readJSON",value:function(){return JSON.parse(D.readVarString(this.restDecoder))}},{key:"readKey",value:function(){return D.readVarString(this.restDecoder)}}]),n}(H),Z=function(){"use strict";function t(e){(0,u.default)(this,t),this.dsCurrVal=0,this.restDecoder=e}return(0,c.default)(t,[{key:"resetDsCurVal",value:function(){this.dsCurrVal=0}},{key:"readDsClock",value:function(){return this.dsCurrVal+=D.readVarUint(this.restDecoder),this.dsCurrVal}},{key:"readDsLen",value:function(){var t=D.readVarUint(this.restDecoder)+1;return this.dsCurrVal+=t,t}}]),t}(),X=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(t){var r;return(0,u.default)(this,n),(r=e.call(this,t)).keys=[],D.readVarUint(t),r.keyClockDecoder=new D.IntDiffOptRleDecoder(D.readVarUint8Array(t)),r.clientDecoder=new D.UintOptRleDecoder(D.readVarUint8Array(t)),r.leftClockDecoder=new D.IntDiffOptRleDecoder(D.readVarUint8Array(t)),r.rightClockDecoder=new D.IntDiffOptRleDecoder(D.readVarUint8Array(t)),r.infoDecoder=new D.RleDecoder(D.readVarUint8Array(t),D.readUint8),r.stringDecoder=new D.StringDecoder(D.readVarUint8Array(t)),r.parentInfoDecoder=new D.RleDecoder(D.readVarUint8Array(t),D.readUint8),r.typeRefDecoder=new D.UintOptRleDecoder(D.readVarUint8Array(t)),r.lenDecoder=new D.UintOptRleDecoder(D.readVarUint8Array(t)),r}return(0,c.default)(n,[{key:"readLeftID",value:function(){return new pt(this.clientDecoder.read(),this.leftClockDecoder.read())}},{key:"readRightID",value:function(){return new pt(this.clientDecoder.read(),this.rightClockDecoder.read())}},{key:"readClient",value:function(){return this.clientDecoder.read()}},{key:"readInfo",value:function(){return this.infoDecoder.read()}},{key:"readString",value:function(){return this.stringDecoder.read()}},{key:"readParentInfo",value:function(){return 1===this.parentInfoDecoder.read()}},{key:"readTypeRef",value:function(){return this.typeRefDecoder.read()}},{key:"readLen",value:function(){return this.lenDecoder.read()}},{key:"readAny",value:function(){return D.readAny(this.restDecoder)}},{key:"readBuf",value:function(){return D.readVarUint8Array(this.restDecoder)}},{key:"readJSON",value:function(){return D.readAny(this.restDecoder)}},{key:"readKey",value:function(){var t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];var e=this.stringDecoder.read();return this.keys.push(e),e}}]),n}(Z),Y=function(){"use strict";function t(){(0,u.default)(this,t),this.restEncoder=_.createEncoder()}return(0,c.default)(t,[{key:"toUint8Array",value:function(){return _.toUint8Array(this.restEncoder)}},{key:"resetDsCurVal",value:function(){}},{key:"writeDsClock",value:function(t){_.writeVarUint(this.restEncoder,t)}},{key:"writeDsLen",value:function(t){_.writeVarUint(this.restEncoder,t)}}]),t}(),$=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(){return(0,u.default)(this,n),e.apply(this,arguments)}return(0,c.default)(n,[{key:"writeLeftID",value:function(t){_.writeVarUint(this.restEncoder,t.client),_.writeVarUint(this.restEncoder,t.clock)}},{key:"writeRightID",value:function(t){_.writeVarUint(this.restEncoder,t.client),_.writeVarUint(this.restEncoder,t.clock)}},{key:"writeClient",value:function(t){_.writeVarUint(this.restEncoder,t)}},{key:"writeInfo",value:function(t){_.writeUint8(this.restEncoder,t)}},{key:"writeString",value:function(t){_.writeVarString(this.restEncoder,t)}},{key:"writeParentInfo",value:function(t){_.writeVarUint(this.restEncoder,t?1:0)}},{key:"writeTypeRef",value:function(t){_.writeVarUint(this.restEncoder,t)}},{key:"writeLen",value:function(t){_.writeVarUint(this.restEncoder,t)}},{key:"writeAny",value:function(t){_.writeAny(this.restEncoder,t)}},{key:"writeBuf",value:function(t){_.writeVarUint8Array(this.restEncoder,t)}},{key:"writeJSON",value:function(t){_.writeVarString(this.restEncoder,JSON.stringify(t))}},{key:"writeKey",value:function(t){_.writeVarString(this.restEncoder,t)}}]),n}(Y),tt=function(){"use strict";function t(){(0,u.default)(this,t),this.restEncoder=_.createEncoder(),this.dsCurrVal=0}return(0,c.default)(t,[{key:"toUint8Array",value:function(){return _.toUint8Array(this.restEncoder)}},{key:"resetDsCurVal",value:function(){this.dsCurrVal=0}},{key:"writeDsClock",value:function(t){var e=t-this.dsCurrVal;this.dsCurrVal=t,_.writeVarUint(this.restEncoder,e)}},{key:"writeDsLen",value:function(t){0===t&&C.unexpectedCase(),_.writeVarUint(this.restEncoder,t-1),this.dsCurrVal+=t}}]),t}(),et=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(){var t;return(0,u.default)(this,n),(t=e.call(this)).keyMap=new Map,t.keyClock=0,t.keyClockEncoder=new _.IntDiffOptRleEncoder,t.clientEncoder=new _.UintOptRleEncoder,t.leftClockEncoder=new _.IntDiffOptRleEncoder,t.rightClockEncoder=new _.IntDiffOptRleEncoder,t.infoEncoder=new _.RleEncoder(_.writeUint8),t.stringEncoder=new _.StringEncoder,t.parentInfoEncoder=new _.RleEncoder(_.writeUint8),t.typeRefEncoder=new _.UintOptRleEncoder,t.lenEncoder=new _.UintOptRleEncoder,t}return(0,c.default)(n,[{key:"toUint8Array",value:function(){var t=_.createEncoder();return _.writeVarUint(t,0),_.writeVarUint8Array(t,this.keyClockEncoder.toUint8Array()),_.writeVarUint8Array(t,this.clientEncoder.toUint8Array()),_.writeVarUint8Array(t,this.leftClockEncoder.toUint8Array()),_.writeVarUint8Array(t,this.rightClockEncoder.toUint8Array()),_.writeVarUint8Array(t,_.toUint8Array(this.infoEncoder)),_.writeVarUint8Array(t,this.stringEncoder.toUint8Array()),_.writeVarUint8Array(t,_.toUint8Array(this.parentInfoEncoder)),_.writeVarUint8Array(t,this.typeRefEncoder.toUint8Array()),_.writeVarUint8Array(t,this.lenEncoder.toUint8Array()),_.writeUint8Array(t,_.toUint8Array(this.restEncoder)),_.toUint8Array(t)}},{key:"writeLeftID",value:function(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}},{key:"writeRightID",value:function(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}},{key:"writeClient",value:function(t){this.clientEncoder.write(t)}},{key:"writeInfo",value:function(t){this.infoEncoder.write(t)}},{key:"writeString",value:function(t){this.stringEncoder.write(t)}},{key:"writeParentInfo",value:function(t){this.parentInfoEncoder.write(t?1:0)}},{key:"writeTypeRef",value:function(t){this.typeRefEncoder.write(t)}},{key:"writeLen",value:function(t){this.lenEncoder.write(t)}},{key:"writeAny",value:function(t){_.writeAny(this.restEncoder,t)}},{key:"writeBuf",value:function(t){_.writeVarUint8Array(this.restEncoder,t)}},{key:"writeJSON",value:function(t){_.writeAny(this.restEncoder,t)}},{key:"writeKey",value:function(t){var e=this.keyMap.get(t);void 0===e?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(e)}}]),n}(tt),nt=function(t,e,n){var r=new Map;n.forEach((function(t,n){St(e,n)>t&&r.set(n,t)})),Dt(e).forEach((function(t,e){n.has(e)||r.set(e,0)})),_.writeVarUint(t.restEncoder,r.size),Array.from(r.entries()).sort((function(t,e){return e[0]-t[0]})).forEach((function(n){var r=(0,v.default)(n,2),i=r[0],o=r[1];!function(t,e,n,r){r=m.max(r,e[0].id.clock);var i=Et(e,r);_.writeVarUint(t.restEncoder,e.length-i),t.writeClient(n),_.writeVarUint(t.restEncoder,r);var o=e[i];o.write(t,r-o.id.clock);for(var u=i+1;u<e.length;u++)e[u].write(t,0)}(t,e.clients.get(i),i,o)}))},rt=function(t,e){for(var n=b.create(),r=D.readVarUint(t.restDecoder),i=0;i<r;i++){var o=D.readVarUint(t.restDecoder),u=new Array(o),c=t.readClient(),a=D.readVarUint(t.restDecoder);n.set(c,{i:0,refs:u});for(var s=0;s<o;s++){var l=t.readInfo();switch(A.BITS5&l){case 0:var f=t.readLen();u[s]=new We(kt(c,a),f),a+=f;break;case 10:var d=D.readVarUint(t.restDecoder);u[s]=new vn(kt(c,a),d),a+=d;break;default:var h=0==(l&(A.BIT7|A.BIT8)),v=new fn(kt(c,a),null,(l&A.BIT8)===A.BIT8?t.readLeftID():null,null,(l&A.BIT7)===A.BIT7?t.readRightID():null,h?t.readParentInfo()?e.get(t.readString()):t.readLeftID():null,h&&(l&A.BIT6)===A.BIT6?t.readString():null,dn(t,l));u[s]=v,a+=v.length}}}return n},it=function(t,e,n){var r=[],i=Array.from(n.keys()).sort((function(t,e){return t-e}));if(0===i.length)return null;var o=function(){if(0===i.length)return null;for(var t=n.get(i[i.length-1]);t.refs.length===t.i;){if(i.pop(),!(i.length>0))return null;t=n.get(i[i.length-1])}return t},u=o();if(null===u&&0===r.length)return null;for(var c=new _t,a=new Map,s=function(t,e){var n=a.get(t);(null==n||n>e)&&a.set(t,e)},l=u.refs[u.i++],f=new Map,d=function(){var t=!0,e=!1,o=void 0;try{for(var u,a=function(){var t=u.value,e=t.id.client,r=n.get(e);r?(r.i--,c.clients.set(e,r.refs.slice(r.i)),n.delete(e),r.i=0,r.refs=[]):c.clients.set(e,[t]),i=i.filter((function(t){return t!==e}))},s=r[Symbol.iterator]();!(t=(u=s.next()).done);t=!0)a()}catch(t){e=!0,o=t}finally{try{t||null==s.return||s.return()}finally{if(e)throw o}}r.length=0};;){if(l.constructor!==vn){var h=b.setIfUndefined(f,l.id.client,(function(){return St(e,l.id.client)}))-l.id.clock;if(h<0)r.push(l),s(l.id.client,l.id.clock-1),d();else{var v=l.getMissing(t,e);if(null!==v){r.push(l);var g=n.get(v)||{refs:[],i:0};if(g.refs.length!==g.i){l=g.refs[g.i++];continue}s(v,St(e,v)),d()}else(0===h||h<l.length)&&(l.integrate(t,h),f.set(l.id.client,l.id.clock+l.length))}}if(r.length>0)l=r.pop();else if(null!==u&&u.i<u.refs.length)l=u.refs[u.i++];else{if(null===(u=o()))break;l=u.refs[u.i++]}}if(c.clients.size>0){var p=new et;return nt(p,c,new Map),_.writeVarUint(p.restEncoder,0),{missing:a,update:p.toUint8Array()}}return null},ot=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new X(t);return Lt(e,(function(t){t.local=!1;var e=!1,n=t.doc,i=n.store,o=rt(r,n),u=it(t,i,o),c=i.pendingStructs;if(c){var a=!0,s=!1,l=void 0;try{for(var f,d=c.missing[Symbol.iterator]();!(a=(f=d.next()).done);a=!0){var h=(0,v.default)(f.value,2),g=h[0];if(h[1]<St(i,g)){e=!0;break}}}catch(t){s=!0,l=t}finally{try{a||null==d.return||d.return()}finally{if(s)throw l}}if(u){var p=!0,y=!1,k=void 0;try{for(var w,m=u.missing[Symbol.iterator]();!(p=(w=m.next()).done);p=!0){var b=(0,v.default)(w.value,2),_=b[0],S=b[1],x=c.missing.get(_);(null==x||x>S)&&c.missing.set(_,S)}}catch(t){y=!0,k=t}finally{try{p||null==m.return||m.return()}finally{if(y)throw k}}c.update=Ft([c.update,u.update])}}else i.pendingStructs=u;var E=q(r,t,i);if(i.pendingDs){var C=new X(D.createDecoder(i.pendingDs));D.readVarUint(C.restDecoder);var A=q(C,t,i);i.pendingDs=E&&A?Ft([E,A]):E||A}else i.pendingDs=E;if(e){var U=i.pendingStructs.update;i.pendingStructs=null,ut(t.doc,U)}}),n,!1)},ut=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:X,i=D.createDecoder(e);ot(i,t,n,new r(i))},ct=function(t,e,n){return ut(t,e,n,K)},at=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map;nt(t,e.store,n),F(t,z(e.store))},st=function(t,e){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint8Array([0]),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new et,r=lt(e);at(n,t,r);var i=[n.toUint8Array()];if(t.store.pendingDs&&i.push(t.store.pendingDs),t.store.pendingStructs&&i.push(Wt(t.store.pendingStructs.update,e)),i.length>1){if(n.constructor===$)return Pt(i.map((function(t,e){return 0===e?t:Ht(t)})));if(n.constructor===et)return Ft(i)}return i[0]}(t,e,new $)},lt=function(t){return function(t){for(var e=new Map,n=D.readVarUint(t.restDecoder),r=0;r<n;r++){var i=D.readVarUint(t.restDecoder),o=D.readVarUint(t.restDecoder);e.set(i,o)}return e}(new H(D.createDecoder(t)))},ft=function t(){"use strict";(0,u.default)(this,t),this.l=[]},dt=function(){return new ft},ht=function(t,e){return t.l.push(e)},vt=function(t,e){var n=t.l,r=n.length;t.l=n.filter((function(t){return e!==t})),r===t.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},gt=function(t,e,n){return U.callAll(t.l,[e,n])},pt=function t(e,n){"use strict";(0,u.default)(this,t),this.client=e,this.clock=n},yt=function(t,e){return t===e||null!==t&&null!==e&&t.client===e.client&&t.clock===e.clock},kt=function(t,e){return new pt(t,e)},wt=function t(e,n){"use strict";(0,u.default)(this,t),this.ds=e,this.sv=n},mt=(function(t,e){new wt(t,e)}(P(),new Map),function(t,e){return void 0===e?!t.deleted:e.sv.has(t.id.client)&&(e.sv.get(t.id.client)||0)>t.id.clock&&!R(e.ds,t.id)}),bt=function(t,e){var n=b.setIfUndefined(t.meta,bt,I.create),r=t.doc.store;n.has(e)||(e.sv.forEach((function(e,n){e<St(r,n)&&Ut(t,kt(n,e))})),B(t,e.ds,(function(t){})),n.add(e))},_t=function t(){"use strict";(0,u.default)(this,t),this.clients=new Map,this.pendingStructs=null,this.pendingDs=null},Dt=function(t){var e=new Map;return t.clients.forEach((function(t,n){var r=t[t.length-1];e.set(n,r.id.clock+r.length)})),e},St=function(t,e){var n=t.clients.get(e);if(void 0===n)return 0;var r=n[n.length-1];return r.id.clock+r.length},xt=function(t,e){var n=t.clients.get(e.id.client);if(void 0===n)n=[],t.clients.set(e.id.client,n);else{var r=n[n.length-1];if(r.id.clock+r.length!==e.id.clock)throw C.unexpectedCase()}n.push(e)},Et=function(t,e){var n=0,r=t.length-1,i=t[r],o=i.id.clock;if(o===e)return r;for(var u=m.floor(e/(o+i.length-1)*r);n<=r;){if((o=(i=t[u]).id.clock)<=e){if(e<o+i.length)return u;n=u+1}else r=u-1;u=m.floor((n+r)/2)}throw C.unexpectedCase()},Ct=function(t,e){var n=t.clients.get(e.client);return n[Et(n,e.clock)]},At=function(t,e,n){var r=Et(e,n),i=e[r];return i.id.clock<n&&i instanceof fn?(e.splice(r+1,0,ln(t,i,n-i.id.clock)),r+1):r},Ut=function(t,e){var n=t.doc.store.clients.get(e.client);return n[At(t,n,e.clock)]},It=function(t,e,n){var r=e.clients.get(n.client),i=Et(r,n.clock),o=r[i];return n.clock!==o.id.clock+o.length-1&&o.constructor!==We&&r.splice(i+1,0,ln(t,o,n.clock-o.id.clock+1)),o},Tt=function(t,e,n,r,i){if(0!==r){var o,u=n+r,c=At(t,e,n);do{u<(o=e[c++]).id.clock+o.length&&At(t,e,u),i(o)}while(c<e.length&&e[c].id.clock<u)}},Ot=function t(e,n,r){"use strict";(0,u.default)(this,t),this.doc=e,this.deleteSet=new N,this.beforeState=Dt(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set},Mt=function(t,e){return!(0===e.deleteSet.clients.size&&!b.any(e.afterState,(function(t,n){return e.beforeState.get(n)!==t}))||(L(e.deleteSet),function(t,e){nt(t,e.doc.store,e.beforeState)}(t,e),F(t,e.deleteSet),0))},Vt=function(t,e,n){var r=e._item;(null===r||r.id.clock<(t.beforeState.get(r.id.client)||0)&&!r.deleted)&&b.setIfUndefined(t.changed,e,I.create).add(n)},Nt=function(t,e){var n=t[e-1],r=t[e];n.deleted===r.deleted&&n.constructor===r.constructor&&n.mergeWith(r)&&(t.splice(e,1),r instanceof fn&&null!==r.parentSub&&r.parent._map.get(r.parentSub)===r&&r.parent._map.set(r.parentSub,n))},Bt=function(t,e,n){var r=!0,i=!1,o=void 0;try{for(var u,c=t.clients.entries()[Symbol.iterator]();!(r=(u=c.next()).done);r=!0)for(var a=(0,v.default)(u.value,2),s=a[0],l=a[1],f=e.clients.get(s),d=l.length-1;d>=0;d--)for(var h=l[d],g=h.clock+h.len,p=Et(f,h.clock),y=f[p];p<f.length&&y.id.clock<g;y=f[++p]){var k=f[p];if(h.clock+h.len<=k.id.clock)break;k instanceof fn&&k.deleted&&!k.keep&&n(k)&&k.gc(e,!1)}}catch(t){i=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}},Rt=function(t,e){if(e<t.length){var n=t[e],r=n.doc,i=r.store,o=n.deleteSet,u=n._mergeStructs;try{L(o),n.afterState=Dt(n.doc.store),r.emit("beforeObserverCalls",[n,r]);var c=[];n.changed.forEach((function(t,e){return c.push((function(){null!==e._item&&e._item.deleted||e._callObserver(n,t)}))})),c.push((function(){n.changedParentTypes.forEach((function(t,e){return c.push((function(){null!==e._item&&e._item.deleted||((t=t.filter((function(t){return null===t.target._item||!t.target._item.deleted}))).forEach((function(t){t.currentTarget=e})),t.sort((function(t,e){return t.path.length-e.path.length})),gt(e._dEH,t,n))}))})),c.push((function(){return r.emit("afterTransaction",[n,r])}))})),(0,U.callAll)(c,[])}finally{r.gc&&Bt(o,i,r.gcFilter),function(t,e){t.clients.forEach((function(t,n){for(var r=e.clients.get(n),i=t.length-1;i>=0;i--)for(var o=t[i],u=m.min(r.length-1,1+Et(r,o.clock+o.len-1)),c=r[u];u>0&&c.id.clock>=o.clock;c=r[--u])Nt(r,u)}))}(o,i),n.afterState.forEach((function(t,e){var r=n.beforeState.get(e)||0;if(r!==t)for(var o=i.clients.get(e),u=m.max(Et(o,r),1),c=o.length-1;c>=u;c--)Nt(o,c)}));for(var a=0;a<u.length;a++){var s=u[a].id,l=s.client,f=s.clock,d=i.clients.get(l),h=Et(d,f);h+1<d.length&&Nt(d,h+1),h>0&&Nt(d,h)}if(n.local||n.afterState.get(r.clientID)===n.beforeState.get(r.clientID)||(T.print(T.ORANGE,T.BOLD,"[yjs] ",T.UNBOLD,T.RED,"Changed the client-id because another client seems to be using it."),r.clientID=Q()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){var v=new $;Mt(v,n)&&r.emit("update",[v.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){var g=new et;Mt(g,n)&&r.emit("updateV2",[g.toUint8Array(),n.origin,r,n])}var p=n.subdocsAdded,y=n.subdocsLoaded,k=n.subdocsRemoved;(p.size>0||k.size>0||y.size>0)&&(p.forEach((function(t){t.clientID=r.clientID,null==t.collectionid&&(t.collectionid=r.collectionid),r.subdocs.add(t)})),k.forEach((function(t){return r.subdocs.delete(t)})),r.emit("subdocs",[{loaded:y,added:p,removed:k},r,n]),k.forEach((function(t){return t.destroy()}))),t.length<=e+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,t])):Rt(t,e+1)}}},Lt=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=t._transactionCleanups,o=!1;null===t._transaction&&(o=!0,t._transaction=new Ot(t,n,r),i.push(t._transaction),1===i.length&&t.emit("beforeAllTransactions",[t]),t.emit("beforeTransaction",[t._transaction,t]));try{e(t._transaction)}finally{if(o){var u=t._transaction===i[0];t._transaction=null,u&&Rt(i,0)}}};k.Observable;var jt=function(){"use strict";function t(e,n){(0,u.default)(this,t),this.gen=function(t){var e,n,r,i,o,u,c,a,s,l,f;return(0,y.__generator)(this,(function(d){switch(d.label){case 0:e=D.readVarUint(t.restDecoder),n=0,d.label=1;case 1:if(!(n<e))return[3,10];r=D.readVarUint(t.restDecoder),i=t.readClient(),o=D.readVarUint(t.restDecoder),u=0,d.label=2;case 2:return u<r?10!==(c=t.readInfo())?[3,4]:(a=D.readVarUint(t.restDecoder),[4,new vn(kt(i,o),a)]):[3,9];case 3:return d.sent(),o+=a,[3,8];case 4:return 0==(A.BITS5&c)?[3,6]:(s=0==(c&(A.BIT7|A.BIT8)),[4,l=new fn(kt(i,o),null,(c&A.BIT8)===A.BIT8?t.readLeftID():null,null,(c&A.BIT7)===A.BIT7?t.readRightID():null,s?t.readParentInfo()?t.readString():t.readLeftID():null,s&&(c&A.BIT6)===A.BIT6?t.readString():null,dn(t,c))]);case 5:return d.sent(),o+=l.length,[3,8];case 6:return f=t.readLen(),[4,new We(kt(i,o),f)];case 7:d.sent(),o+=f,d.label=8;case 8:return u++,[3,2];case 9:return n++,[3,1];case 10:return[2]}}))}(e),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}return(0,c.default)(t,[{key:"next",value:function(){do{this.curr=this.gen.next().value||null}while(this.filterSkips&&null!==this.curr&&this.curr.constructor===vn);return this.curr}}]),t}(),Jt=function t(e){"use strict";(0,u.default)(this,t),this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]},Pt=function(t){return Ft(t,K,$)},zt=function(t,e){if(t.constructor===We){var n=t.id,r=n.client,i=n.clock;return new We(kt(r,i+e),t.length-e)}if(t.constructor===vn){var o=t.id,u=o.client,c=o.clock;return new vn(kt(u,c+e),t.length-e)}var a=t,s=a.id,l=s.client,f=s.clock;return new fn(kt(l,f+e),null,kt(l,f+e-1),null,a.rightOrigin,a.parent,a.parentSub,a.content.splice(e))},Ft=function(t){var e=function(){if((o=o.filter((function(t){return null!==t.curr}))).sort((function(t,e){if(t.curr.id.client===e.curr.id.client){var n=t.curr.id.clock-e.curr.id.clock;return 0===n?t.curr.constructor===e.curr.constructor?0:t.curr.constructor===vn?1:-1:n}return e.curr.id.client-t.curr.id.client})),0===o.length)return"break";var t=o[0],e=t.curr.id.client;if(null!==u){for(var n=t.curr,r=!1;null!==n&&n.id.clock+n.length<=u.struct.id.clock+u.struct.length&&n.id.client>=u.struct.id.client;)n=t.next(),r=!0;if(null===n||n.id.client!==e||r&&n.id.clock>u.struct.id.clock+u.struct.length)return"continue";if(e!==u.struct.id.client)Qt(a,u.struct,u.offset),u={struct:n,offset:0},t.next();else if(u.struct.id.clock+u.struct.length<n.id.clock)if(u.struct.constructor===vn)u.struct.length=n.id.clock+n.length-u.struct.id.clock;else{Qt(a,u.struct,u.offset);var i=n.id.clock-u.struct.id.clock-u.struct.length,c=new vn(kt(e,u.struct.id.clock+u.struct.length),i);u={struct:c,offset:0}}else{var s=u.struct.id.clock+u.struct.length-n.id.clock;s>0&&(u.struct.constructor===vn?u.struct.length-=s:n=zt(n,s)),u.struct.mergeWith(n)||(Qt(a,u.struct,u.offset),u={struct:n,offset:0},t.next())}}else u={struct:t.curr,offset:0},t.next();for(var l=t.curr;null!==l&&l.id.client===e&&l.id.clock===u.struct.id.clock+u.struct.length&&l.constructor!==vn;l=t.next())Qt(a,u.struct,u.offset),u={struct:l,offset:0}},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:X,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:et;if(1===t.length)return t[0];for(var i=t.map((function(t){return new n(D.createDecoder(t))})),o=i.map((function(t){return new jt(t,!0)})),u=null,c=new r,a=new Jt(c);;){if("break"===e())break}null!==u&&(Qt(a,u.struct,u.offset),u=null),Gt(a);var s=i.map((function(t){return W(t)})),l=j(s);return F(c,l),c.toUint8Array()},Wt=function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:X,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:et,i=lt(e),o=new r,u=new Jt(o),c=new n(D.createDecoder(t)),a=new jt(c,!1);a.curr;){var s=a.curr,l=s.id.client,f=i.get(l)||0;if(a.curr.constructor!==vn)if(s.id.clock+s.length>f)for(Qt(u,s,m.max(f-s.id.clock,0)),a.next();a.curr&&a.curr.id.client===l;)Qt(u,a.curr,0),a.next();else for(;a.curr&&a.curr.id.client===l&&a.curr.id.clock+a.curr.length<=f;)a.next();else a.next()}Gt(u);var d=W(c);return F(o,d),o.toUint8Array()},qt=function(t){t.written>0&&(t.clientStructs.push({written:t.written,restEncoder:_.toUint8Array(t.encoder.restEncoder)}),t.encoder.restEncoder=_.createEncoder(),t.written=0)},Qt=function(t,e,n){t.written>0&&t.currClient!==e.id.client&&qt(t),0===t.written&&(t.currClient=e.id.client,t.encoder.writeClient(e.id.client),_.writeVarUint(t.encoder.restEncoder,e.id.clock+n)),e.write(t.encoder,n),t.written++},Gt=function(t){qt(t);var e=t.encoder.restEncoder;_.writeVarUint(e,t.clientStructs.length);for(var n=0;n<t.clientStructs.length;n++){var r=t.clientStructs[n];_.writeVarUint(e,r.written),_.writeUint8Array(e,r.restEncoder)}},Ht=function(t){return function(t,e,n){for(var r=new e(D.createDecoder(t)),i=new jt(r,!1),o=new n,u=new Jt(o),c=i.curr;null!==c;c=i.next())Qt(u,c,0);Gt(u);var a=W(r);return F(o,a),o.toUint8Array()}(t,X,$)},Kt=function(){"use strict";function t(e,n){(0,u.default)(this,t),this.target=e,this.currentTarget=e,this.transaction=n,this._changes=null,this._keys=null,this._delta=null}return(0,c.default)(t,[{key:"path",get:function(){return Zt(this.currentTarget,this.target)}},{key:"deletes",value:function(t){return R(this.transaction.deleteSet,t.id)}},{key:"keys",get:function(){var t=this;if(null===this._keys){var e=new Map,n=this.target;this.transaction.changed.get(n).forEach((function(r){if(null!==r){var i,o,u=n._map.get(r);if(t.adds(u)){for(var c=u.left;null!==c&&t.adds(c);)c=c.left;if(t.deletes(u)){if(null===c||!t.deletes(c))return;i="delete",o=w.last(c.content.getContent())}else null!==c&&t.deletes(c)?(i="update",o=w.last(c.content.getContent())):(i="add",o=void 0)}else{if(!t.deletes(u))return;i="delete",o=w.last(u.content.getContent())}e.set(r,{action:i,oldValue:o})}})),this._keys=e}return this._keys}},{key:"delta",get:function(){return this.changes.delta}},{key:"adds",value:function(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}},{key:"changes",get:function(){var t=this._changes;if(null===t){var e=this.target,n=I.create(),r=I.create(),i=[];if(t={added:n,deleted:r,delta:i,keys:this.keys},this.transaction.changed.get(e).has(null)){for(var o=null,u=function(){o&&i.push(o)},c=e._start;null!==c;c=c.right)c.deleted?this.deletes(c)&&!this.adds(c)&&(null!==o&&void 0!==o.delete||(u(),o={delete:0}),o.delete+=c.length,r.add(c)):this.adds(c)?(null!==o&&void 0!==o.insert||(u(),o={insert:[]}),o.insert=o.insert.concat(c.content.getContent()),n.add(c)):(null!==o&&void 0!==o.retain||(u(),o={retain:0}),o.retain+=c.length);null!==o&&void 0===o.retain&&u()}this._changes=t}return t}}]),t}(),Zt=function(t,e){for(var n=[];null!==e._item&&e!==t;){if(null!==e._item.parentSub)n.unshift(e._item.parentSub);else{for(var r=0,i=e._item.parent._start;i!==e._item&&null!==i;)i.deleted||r++,i=i.right;n.unshift(r)}e=e._item.parent}return n},Xt=0,Yt=function t(e,n){"use strict";(0,u.default)(this,t),e.marker=!0,this.p=e,this.index=n,this.timestamp=Xt++},$t=function(t,e,n){t.p.marker=!1,t.p=e,e.marker=!0,t.index=n,t.timestamp=Xt++},te=function(t,e){if(null===t._start||0===e||null===t._searchMarker)return null;var n=0===t._searchMarker.length?null:t._searchMarker.reduce((function(t,n){return m.abs(e-t.index)<m.abs(e-n.index)?t:n})),r=t._start,i=0;for(null!==n&&(r=n.p,i=n.index,function(t){t.timestamp=Xt++}(n));null!==r.right&&i<e;){if(!r.deleted&&r.countable){if(e<i+r.length)break;i+=r.length}r=r.right}for(;null!==r.left&&i>e;)!(r=r.left).deleted&&r.countable&&(i-=r.length);for(;null!==r.left&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)!(r=r.left).deleted&&r.countable&&(i-=r.length);return null!==n&&m.abs(n.index-i)<r.parent.length/80?($t(n,r,i),n):function(t,e,n){if(t.length>=80){var r=t.reduce((function(t,e){return t.timestamp<e.timestamp?t:e}));return $t(r,e,n),r}var i=new Yt(e,n);return t.push(i),i}(t._searchMarker,r,i)},ee=function(t,e,n){for(var r=t.length-1;r>=0;r--){var i=t[r];if(n>0){var o=i.p;for(o.marker=!1;o&&(o.deleted||!o.countable);)(o=o.left)&&!o.deleted&&o.countable&&(i.index-=o.length);if(null===o||!0===o.marker){t.splice(r,1);continue}i.p=o,o.marker=!0}(e<i.index||n>0&&e===i.index)&&(i.index=m.max(e,i.index+n))}},ne=function(t,e,n){for(var r=t,i=e.changedParentTypes;b.setIfUndefined(i,t,(function(){return[]})).push(n),null!==t._item;)t=t._item.parent;gt(r._eH,n,e)},re=function(){"use strict";function t(){(0,u.default)(this,t),this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=dt(),this._dEH=dt(),this._searchMarker=null}return(0,c.default)(t,[{key:"parent",get:function(){return this._item?this._item.parent:null}},{key:"_integrate",value:function(t,e){this.doc=t,this._item=e}},{key:"_copy",value:function(){throw C.methodUnimplemented()}},{key:"clone",value:function(){throw C.methodUnimplemented()}},{key:"_write",value:function(t){}},{key:"_first",get:function(){for(var t=this._start;null!==t&&t.deleted;)t=t.right;return t}},{key:"_callObserver",value:function(t,e){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}},{key:"observe",value:function(t){ht(this._eH,t)}},{key:"observeDeep",value:function(t){ht(this._dEH,t)}},{key:"unobserve",value:function(t){vt(this._eH,t)}},{key:"unobserveDeep",value:function(t){vt(this._dEH,t)}},{key:"toJSON",value:function(){}}]),t}(),ie=function(t,e,n){e<0&&(e=t._length+e),n<0&&(n=t._length+n);for(var r=n-e,i=[],o=t._start;null!==o&&r>0;){if(o.countable&&!o.deleted){var u=o.content.getContent();if(u.length<=e)e-=u.length;else{for(var c=e;c<u.length&&r>0;c++)i.push(u[c]),r--;e=0}}o=o.right}return i},oe=function(t){for(var e=[],n=t._start;null!==n;){if(n.countable&&!n.deleted)for(var r=n.content.getContent(),i=0;i<r.length;i++)e.push(r[i]);n=n.right}return e},ue=function(t,e){for(var n=0,r=t._start;null!==r;){if(r.countable&&!r.deleted)for(var i=r.content.getContent(),o=0;o<i.length;o++)e(i[o],n++,t);r=r.right}},ce=function(t,e){var n=[];return ue(t,(function(r,i){n.push(e(r,i,t))})),n},ae=function(t,e){var n=te(t,e),r=t._start;for(null!==n&&(r=n.p,e-=n.index);null!==r;r=r.right)if(!r.deleted&&r.countable){if(e<r.length)return r.content.getContent()[e];e-=r.length}},se=function(t,e,n,r){var i=n,o=t.doc,u=o.clientID,c=o.store,a=null===n?e._start:n.right,s=[],l=function(){s.length>0&&((i=new fn(kt(u,St(c,u)),i,i&&i.lastId,a,a&&a.id,e,null,new Ye(s))).integrate(t,0),s=[])};r.forEach((function(n){if(null===n)s.push(n);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:s.push(n);break;default:switch(l(),n.constructor){case Uint8Array:case ArrayBuffer:(i=new fn(kt(u,St(c,u)),i,i&&i.lastId,a,a&&a.id,e,null,new qe(new Uint8Array(n)))).integrate(t,0);break;case G:(i=new fn(kt(u,St(c,u)),i,i&&i.lastId,a,a&&a.id,e,null,new He(n))).integrate(t,0);break;default:if(!(n instanceof re))throw new Error("Unexpected content type in insert operation");(i=new fn(kt(u,St(c,u)),i,i&&i.lastId,a,a&&a.id,e,null,new sn(n))).integrate(t,0)}}})),l()},le=C.create("Length exceeded!"),fe=function(t,e,n,r){if(n>e._length)throw le;if(0===n)return e._searchMarker&&ee(e._searchMarker,n,r.length),se(t,e,null,r);var i=n,o=te(e,n),u=e._start;for(null!==o&&(u=o.p,0==(n-=o.index)&&(n+=(u=u.prev)&&u.countable&&!u.deleted?u.length:0));null!==u;u=u.right)if(!u.deleted&&u.countable){if(n<=u.length){n<u.length&&Ut(t,kt(u.id.client,u.id.clock+n));break}n-=u.length}return e._searchMarker&&ee(e._searchMarker,i,r.length),se(t,e,u,r)},de=function(t,e,n,r){if(0!==r){var i=n,o=r,u=te(e,n),c=e._start;for(null!==u&&(c=u.p,n-=u.index);null!==c&&n>0;c=c.right)!c.deleted&&c.countable&&(n<c.length&&Ut(t,kt(c.id.client,c.id.clock+n)),n-=c.length);for(;r>0&&null!==c;)c.deleted||(r<c.length&&Ut(t,kt(c.id.client,c.id.clock+r)),c.delete(t),r-=c.length),c=c.right;if(r>0)throw le;e._searchMarker&&ee(e._searchMarker,i,-o+r)}},he=function(t,e,n){var r=e._map.get(n);void 0!==r&&r.delete(t)},ve=function(t,e,n,r){var i,o=e._map.get(n)||null,u=t.doc,c=u.clientID;if(null==r)i=new Ye([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:i=new Ye([r]);break;case Uint8Array:i=new qe(r);break;case G:i=new He(r);break;default:if(!(r instanceof re))throw new Error("Unexpected content type");i=new sn(r)}new fn(kt(c,St(u.store,c)),o,o&&o.lastId,null,null,e,n,i).integrate(t,0)},ge=function(t,e){var n=t._map.get(e);return void 0===n||n.deleted?void 0:n.content.getContent()[n.length-1]},pe=function(t){var e={};return t._map.forEach((function(t,n){t.deleted||(e[n]=t.content.getContent()[t.length-1])})),e},ye=function(t,e){var n=t._map.get(e);return void 0!==n&&!n.deleted},ke=function(t){return O.iteratorFilter(t.entries(),(function(t){return!t[1].deleted}))},we=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(t,r){var i;return(0,u.default)(this,n),(i=e.call(this,t,r))._transaction=r,i}return n}(Kt),me=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(){var t;return(0,u.default)(this,n),(t=e.call(this))._prelimContent=[],t._searchMarker=[],t}return(0,c.default)(n,[{key:"_integrate",value:function(t,e){(0,s.default)((0,l.default)(n.prototype),"_integrate",this).call(this,t,e),this.insert(0,this._prelimContent),this._prelimContent=null}},{key:"_copy",value:function(){return new n}},{key:"clone",value:function(){var t=new n;return t.insert(0,this.toArray().map((function(t){return t instanceof re?t.clone():t}))),t}},{key:"length",get:function(){return null===this._prelimContent?this._length:this._prelimContent.length}},{key:"_callObserver",value:function(t,e){(0,s.default)((0,l.default)(n.prototype),"_callObserver",this).call(this,t,e),ne(this,t,new we(this,t))}},{key:"insert",value:function(t,e){var n,r=this;null!==this.doc?Lt(this.doc,(function(n){fe(n,r,t,e)})):(n=this._prelimContent).splice.apply(n,[t,0].concat((0,g.default)(e)))}},{key:"push",value:function(t){var e,n=this;null!==this.doc?Lt(this.doc,(function(e){!function(t,e,n){var r=(e._searchMarker||[]).reduce((function(t,e){return e.index>t.index?e:t}),{index:0,p:e._start}).p;if(r)for(;r.right;)r=r.right;se(t,e,r,n)}(e,n,t)})):(e=this._prelimContent).push.apply(e,(0,g.default)(t))}},{key:"unshift",value:function(t){this.insert(0,t)}},{key:"delete",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this;null!==this.doc?Lt(this.doc,(function(r){de(r,n,t,e)})):this._prelimContent.splice(t,e)}},{key:"get",value:function(t){return ae(this,t)}},{key:"toArray",value:function(){return oe(this)}},{key:"slice",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;return ie(this,t,e)}},{key:"toJSON",value:function(){return this.map((function(t){return t instanceof re?t.toJSON():t}))}},{key:"map",value:function(t){return ce(this,t)}},{key:"forEach",value:function(t){ue(this,t)}},{key:Symbol.iterator,value:function(){return e=this._start,n=null,r=0,t={},(0,a.default)(t,Symbol.iterator,(function(){return this})),(0,a.default)(t,"next",(function(){if(null===n){for(;null!==e&&e.deleted;)e=e.right;if(null===e)return{done:!0,value:void 0};n=e.content.getContent(),r=0,e=e.right}var t=n[r++];return n.length<=r&&(n=null),{done:!1,value:t}})),t;var t,e,n,r}},{key:"_write",value:function(t){t.writeTypeRef(en)}}],[{key:"from",value:function(t){var e=new n;return e.push(t),e}}]),n}(re),be=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(t,r,i){var o;return(0,u.default)(this,n),(o=e.call(this,t,r)).keysChanged=i,o}return n}(Kt),_e=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(t){var r;return(0,u.default)(this,n),(r=e.call(this))._prelimContent=null,r._prelimContent=void 0===t?new Map:new Map(t),r}return(0,c.default)(n,[{key:"_integrate",value:function(t,e){var r=this;(0,s.default)((0,l.default)(n.prototype),"_integrate",this).call(this,t,e),this._prelimContent.forEach((function(t,e){r.set(e,t)})),this._prelimContent=null}},{key:"_copy",value:function(){return new n}},{key:"clone",value:function(){var t=new n;return this.forEach((function(e,n){t.set(n,e instanceof re?e.clone():e)})),t}},{key:"_callObserver",value:function(t,e){ne(this,t,new be(this,t,e))}},{key:"toJSON",value:function(){var t={};return this._map.forEach((function(e,n){if(!e.deleted){var r=e.content.getContent()[e.length-1];t[n]=r instanceof re?r.toJSON():r}})),t}},{key:"size",get:function(){return(0,g.default)(ke(this._map)).length}},{key:"keys",value:function(){return O.iteratorMap(ke(this._map),(function(t){return t[0]}))}},{key:"values",value:function(){return O.iteratorMap(ke(this._map),(function(t){return t[1].content.getContent()[t[1].length-1]}))}},{key:"entries",value:function(){return O.iteratorMap(ke(this._map),(function(t){return[t[0],t[1].content.getContent()[t[1].length-1]]}))}},{key:"forEach",value:function(t){var e=this;this._map.forEach((function(n,r){n.deleted||t(n.content.getContent()[n.length-1],r,e)}))}},{key:Symbol.iterator,value:function(){return this.entries()}},{key:"delete",value:function(t){var e=this;null!==this.doc?Lt(this.doc,(function(n){he(n,e,t)})):this._prelimContent.delete(t)}},{key:"set",value:function(t,e){var n=this;return null!==this.doc?Lt(this.doc,(function(r){ve(r,n,t,e)})):this._prelimContent.set(t,e),e}},{key:"get",value:function(t){return ge(this,t)}},{key:"has",value:function(t){return ye(this,t)}},{key:"clear",value:function(){var t=this;null!==this.doc?Lt(this.doc,(function(e){t.forEach((function(t,n,r){he(e,r,n)}))})):this._prelimContent.clear()}},{key:"_write",value:function(t){t.writeTypeRef(nn)}}]),n}(re),De=function(t,e){return t===e||"object"==typeof t&&"object"==typeof e&&t&&e&&M.equalFlat(t,e)},Se=function(){"use strict";function t(e,n,r,i){(0,u.default)(this,t),this.left=e,this.right=n,this.index=r,this.currentAttributes=i}return(0,c.default)(t,[{key:"forward",value:function(){null===this.right&&C.unexpectedCase(),this.right.content.constructor===Ze?this.right.deleted||Ae(this.currentAttributes,this.right.content):this.right.deleted||(this.index+=this.right.length),this.left=this.right,this.right=this.right.right}}]),t}(),xe=function(t,e,n){for(;null!==e.right&&n>0;)e.right.content.constructor===Ze?e.right.deleted||Ae(e.currentAttributes,e.right.content):e.right.deleted||(n<e.right.length&&Ut(t,kt(e.right.id.client,e.right.id.clock+n)),e.index+=e.right.length,n-=e.right.length),e.left=e.right,e.right=e.right.right;return e},Ee=function(t,e,n){var r=new Map,i=te(e,n);if(i){var o=new Se(i.p.left,i.p,i.index,r);return xe(t,o,n-i.index)}var u=new Se(null,e._start,0,r);return xe(t,u,n)},Ce=function(t,e,n,r){for(;null!==n.right&&(!0===n.right.deleted||n.right.content.constructor===Ze&&De(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();var i=t.doc,o=i.clientID;r.forEach((function(r,u){var c=n.left,a=n.right,s=new fn(kt(o,St(i.store,o)),c,c&&c.lastId,a,a&&a.id,e,null,new Ze(u,r));s.integrate(t,0),n.right=s,n.forward()}))},Ae=function(t,e){var n=e.key,r=e.value;null===r?t.delete(n):t.set(n,r)},Ue=function(t,e){for(;null!==t.right&&(t.right.deleted||t.right.content.constructor===Ze&&De(e[t.right.content.key]||null,t.right.content.value));)t.forward()},Ie=function(t,e,n,r){var i=t.doc,o=i.clientID,u=new Map;for(var c in r){var a=r[c],s=n.currentAttributes.get(c)||null;if(!De(s,a)){u.set(c,s);var l=n.left,f=n.right;n.right=new fn(kt(o,St(i.store,o)),l,l&&l.lastId,f,f&&f.id,e,null,new Ze(c,a)),n.right.integrate(t,0),n.forward()}}return u},Te=function(t,e,n,r,i){n.currentAttributes.forEach((function(t,e){void 0===i[e]&&(i[e]=null)}));var o=t.doc,u=o.clientID;Ue(n,i);var c=Ie(t,e,n,i),a=r.constructor===String?new $e(r):r instanceof re?new sn(r):new Ke(r),s=n.left,l=n.right,f=n.index;e._searchMarker&&ee(e._searchMarker,n.index,a.getLength()),(l=new fn(kt(u,St(o.store,u)),s,s&&s.lastId,l,l&&l.id,e,null,a)).integrate(t,0),n.right=l,n.index=f,n.forward(),Ce(t,e,n,c)},Oe=function(t,e,n,r,i){var o=t.doc,u=o.clientID;Ue(n,i);var c=Ie(t,e,n,i);t:for(;null!==n.right&&(r>0||c.size>0&&(n.right.deleted||n.right.content.constructor===Ze));){if(!n.right.deleted)if(n.right.content.constructor===Ze){var a=n.right.content,s=a.key,l=a.value,f=i[s];if(void 0!==f){if(De(f,l))c.delete(s);else{if(0===r)break t;c.set(s,l)}n.right.delete(t)}else n.currentAttributes.set(s,l)}else r<n.right.length&&Ut(t,kt(n.right.id.client,n.right.id.clock+r)),r-=n.right.length;n.forward()}if(r>0){for(var d="";r>0;r--)d+="\n";n.right=new fn(kt(u,St(o.store,u)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,e,null,new $e(d)),n.right.integrate(t,0),n.forward()}Ce(t,e,n,c)},Me=function(t,e,n,r,i){for(var o=n,u=b.copy(i);o&&(!o.countable||o.deleted);)o.deleted||o.content.constructor!==Ze||Ae(u,o.content),o=o.right;for(var c=0,a=!1;e!==o;){if(n===e&&(a=!0),!e.deleted){var s=e.content;if(s.constructor===Ze){var l=s.key,f=s.value;(u.get(l)||null)===f&&(r.get(l)||null)!==f||(e.delete(t),c++,a||(i.get(l)||null)!==f||(r.get(l)||null)===f||i.delete(l))}}e=e.right}return c},Ve=function(t,e,n){for(var r=n,i=b.copy(e.currentAttributes),o=e.right;n>0&&null!==e.right;){if(!1===e.right.deleted)switch(e.right.content.constructor){case sn:case Ke:case $e:n<e.right.length&&Ut(t,kt(e.right.id.client,e.right.id.clock+n)),n-=e.right.length,e.right.delete(t)}e.forward()}o&&Me(t,o,e.right,i,e.currentAttributes);var u=(e.left||e.right).parent;return u._searchMarker&&ee(u._searchMarker,e.index,-r+n),e},Ne=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(t,r,i){var o;return(0,u.default)(this,n),(o=e.call(this,t,r)).childListChanged=!1,o.keysChanged=new Set,i.forEach((function(t){null===t?o.childListChanged=!0:o.keysChanged.add(t)})),o}return(0,c.default)(n,[{key:"changes",get:function(){if(null===this._changes){var t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}},{key:"delta",get:function(){var t=this;if(null===this._delta){var e=this.target.doc,n=[];Lt(e,(function(e){for(var r=new Map,i=new Map,o=t.target._start,u=null,c={},a="",s=0,l=0,f=function(){if(null!==u){var t;switch(u){case"delete":t={delete:l},l=0;break;case"insert":t={insert:a},r.size>0&&(t.attributes={},r.forEach((function(e,n){null!==e&&(t.attributes[n]=e)}))),a="";break;case"retain":if(t={retain:s},Object.keys(c).length>0)for(var e in t.attributes={},c)t.attributes[e]=c[e];s=0}n.push(t),u=null}};null!==o;){switch(o.content.constructor){case sn:case Ke:t.adds(o)?t.deletes(o)||(f(),u="insert",a=o.content.getContent()[0],f()):t.deletes(o)?("delete"!==u&&(f(),u="delete"),l+=1):o.deleted||("retain"!==u&&(f(),u="retain"),s+=1);break;case $e:t.adds(o)?t.deletes(o)||("insert"!==u&&(f(),u="insert"),a+=o.content.str):t.deletes(o)?("delete"!==u&&(f(),u="delete"),l+=o.length):o.deleted||("retain"!==u&&(f(),u="retain"),s+=o.length);break;case Ze:var d=o.content,h=d.key,v=d.value;if(t.adds(o)){if(!t.deletes(o)){var g=r.get(h)||null;De(g,v)?null!==v&&o.delete(e):("retain"===u&&f(),De(v,i.get(h)||null)?delete c[h]:c[h]=v)}}else if(t.deletes(o)){i.set(h,v);var p=r.get(h)||null;De(p,v)||("retain"===u&&f(),c[h]=p)}else if(!o.deleted){i.set(h,v);var y=c[h];void 0!==y&&(De(y,v)?null!==y&&o.delete(e):("retain"===u&&f(),null===v?delete c[h]:c[h]=v))}o.deleted||("insert"===u&&f(),Ae(r,o.content))}o=o.right}for(f();n.length>0;){var k=n[n.length-1];if(void 0===k.retain||void 0!==k.attributes)break;n.pop()}})),this._delta=n}return this._delta}}]),n}(Kt),Be=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(t){var r;return(0,u.default)(this,n),(r=e.call(this))._pending=void 0!==t?[function(){return r.insert(0,t)}]:[],r._searchMarker=[],r}return(0,c.default)(n,[{key:"length",get:function(){return this._length}},{key:"_integrate",value:function(t,e){(0,s.default)((0,l.default)(n.prototype),"_integrate",this).call(this,t,e);try{this._pending.forEach((function(t){return t()}))}catch(t){console.error(t)}this._pending=null}},{key:"_copy",value:function(){return new n}},{key:"clone",value:function(){var t=new n;return t.applyDelta(this.toDelta()),t}},{key:"_callObserver",value:function(t,e){var r=this;(0,s.default)((0,l.default)(n.prototype),"_callObserver",this).call(this,t,e);var i=new Ne(this,t,e),o=t.doc;if(ne(this,t,i),!t.local){var u=!1,c=!0,a=!1,f=void 0;try{for(var d,h=t.afterState.entries()[Symbol.iterator]();!(c=(d=h.next()).done);c=!0){var g=(0,v.default)(d.value,2),p=g[0],y=g[1],k=t.beforeState.get(p)||0;if(y!==k&&(Tt(t,o.store.clients.get(p),k,y,(function(t){t.deleted||t.content.constructor!==Ze||(u=!0)})),u))break}}catch(t){a=!0,f=t}finally{try{c||null==h.return||h.return()}finally{if(a)throw f}}u||B(t,t.deleteSet,(function(t){t instanceof We||u||t.parent===r&&t.content.constructor===Ze&&(u=!0)})),Lt(o,(function(t){var e;u?Lt((e=r).doc,(function(t){for(var n=e._start,r=e._start,i=b.create(),o=b.copy(i);r;)!1===r.deleted&&(r.content.constructor===Ze?Ae(o,r.content):(Me(t,n,r,i,o),i=b.copy(o),n=r)),r=r.right})):B(t,t.deleteSet,(function(e){e instanceof We||e.parent===r&&function(t,e){for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;for(var n=new Set;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===Ze){var r=e.content.key;n.has(r)?e.delete(t):n.add(r)}e=e.left}}(t,e)}))}))}}},{key:"toString",value:function(){for(var t="",e=this._start;null!==e;)!e.deleted&&e.countable&&e.content.constructor===$e&&(t+=e.content.str),e=e.right;return t}},{key:"toJSON",value:function(){return this.toString()}},{key:"applyDelta",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).sanitize,n=void 0===e||e,r=this;null!==this.doc?Lt(this.doc,(function(e){for(var i=new Se(null,r._start,0,new Map),o=0;o<t.length;o++){var u=t[o];if(void 0!==u.insert){var c=n||"string"!=typeof u.insert||o!==t.length-1||null!==i.right||"\n"!==u.insert.slice(-1)?u.insert:u.insert.slice(0,-1);("string"!=typeof c||c.length>0)&&Te(e,r,i,c,u.attributes||{})}else void 0!==u.retain?Oe(e,r,i,u.retain,u.attributes||{}):void 0!==u.delete&&Ve(e,i,u.delete)}})):this._pending.push((function(){return r.applyDelta(t)}))}},{key:"toDelta",value:function(t,e,n){var r=function(){if(c.length>0){var t={},e=!1;o.forEach((function(n,r){e=!0,t[r]=n}));var n={insert:c};e&&(n.attributes=t),i.push(n),c=""}},i=[],o=new Map,u=this.doc,c="",a=this._start;return Lt(u,(function(u){var s=function(){if(mt(a,t)||void 0!==e&&mt(a,e))switch(a.content.constructor){case $e:var u=o.get("ychange");void 0===t||mt(a,t)?void 0===e||mt(a,e)?void 0!==u&&(r(),o.delete("ychange")):void 0!==u&&u.user===a.id.client&&"added"===u.type||(r(),o.set("ychange",n?n("added",a.id):{type:"added"})):void 0!==u&&u.user===a.id.client&&"removed"===u.type||(r(),o.set("ychange",n?n("removed",a.id):{type:"removed"})),c+=a.content.str;break;case sn:case Ke:r();var s={insert:a.content.getContent()[0]};if(o.size>0){var l={};s.attributes=l,o.forEach((function(t,e){l[e]=t}))}i.push(s);break;case Ze:mt(a,t)&&(r(),Ae(o,a.content))}a=a.right};for(t&&bt(u,t),e&&bt(u,e);null!==a;)s();r()}),"cleanup"),i}},{key:"insert",value:function(t,e,n){var r=this;if(!(e.length<=0)){var i=this.doc;null!==i?Lt(i,(function(i){var o=Ee(i,r,t);n||(n={},o.currentAttributes.forEach((function(t,e){n[e]=t}))),Te(i,r,o,e,n)})):this._pending.push((function(){return r.insert(t,e,n)}))}}},{key:"insertEmbed",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this,i=this.doc;null!==i?Lt(i,(function(i){var o=Ee(i,r,t);Te(i,r,o,e,n)})):this._pending.push((function(){return r.insertEmbed(t,e,n)}))}},{key:"delete",value:function(t,e){var n=this;if(0!==e){var r=this.doc;null!==r?Lt(r,(function(r){Ve(r,Ee(r,n,t),e)})):this._pending.push((function(){return n.delete(t,e)}))}}},{key:"format",value:function(t,e,n){var r=this;if(0!==e){var i=this.doc;null!==i?Lt(i,(function(i){var o=Ee(i,r,t);null!==o.right&&Oe(i,r,o,e,n)})):this._pending.push((function(){return r.format(t,e,n)}))}}},{key:"removeAttribute",value:function(t){var e=this;null!==this.doc?Lt(this.doc,(function(n){he(n,e,t)})):this._pending.push((function(){return e.removeAttribute(t)}))}},{key:"setAttribute",value:function(t,e){var n=this;null!==this.doc?Lt(this.doc,(function(r){ve(r,n,t,e)})):this._pending.push((function(){return n.setAttribute(t,e)}))}},{key:"getAttribute",value:function(t){return ge(this,t)}},{key:"getAttributes",value:function(t){return pe(this)}},{key:"_write",value:function(t){t.writeTypeRef(rn)}}]),n}(re),Re=function(){"use strict";function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};(0,u.default)(this,t),this._filter=n,this._root=e,this._currentNode=e._start,this._firstCall=!0}return(0,c.default)(t,[{key:Symbol.iterator,value:function(){return this}},{key:"next",value:function(){var t=this._currentNode,e=t&&t.content&&t.content.type;if(null!==t&&(!this._firstCall||t.deleted||!this._filter(e)))do{if(e=t.content.type,t.deleted||e.constructor!==je&&e.constructor!==Le||null===e._start)for(;null!==t;){if(null!==t.right){t=t.right;break}t=t.parent===this._root?null:t.parent._item}else t=e._start}while(null!==t&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,null===t?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}]),t}(),Le=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(){var t;return(0,u.default)(this,n),(t=e.call(this))._prelimContent=[],t}return(0,c.default)(n,[{key:"firstChild",get:function(){var t=this._first;return t?t.content.getContent()[0]:null}},{key:"_integrate",value:function(t,e){(0,s.default)((0,l.default)(n.prototype),"_integrate",this).call(this,t,e),this.insert(0,this._prelimContent),this._prelimContent=null}},{key:"_copy",value:function(){return new n}},{key:"clone",value:function(){var t=new n;return t.insert(0,this.toArray().map((function(t){return t instanceof re?t.clone():t}))),t}},{key:"length",get:function(){return null===this._prelimContent?this._length:this._prelimContent.length}},{key:"createTreeWalker",value:function(t){return new Re(this,t)}},{key:"querySelector",value:function(t){t=t.toUpperCase();var e=new Re(this,(function(e){return e.nodeName&&e.nodeName.toUpperCase()===t})).next();return e.done?null:e.value}},{key:"querySelectorAll",value:function(t){return t=t.toUpperCase(),Array.from(new Re(this,(function(e){return e.nodeName&&e.nodeName.toUpperCase()===t})))}},{key:"_callObserver",value:function(t,e){ne(this,t,new Je(this,e,t))}},{key:"toString",value:function(){return ce(this,(function(t){return t.toString()})).join("")}},{key:"toJSON",value:function(){return this.toString()}},{key:"toDOM",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=t.createDocumentFragment();return void 0!==n&&n._createAssociation(r,this),ue(this,(function(i){r.insertBefore(i.toDOM(t,e,n),null)})),r}},{key:"insert",value:function(t,e){var n,r=this;null!==this.doc?Lt(this.doc,(function(n){fe(n,r,t,e)})):(n=this._prelimContent).splice.apply(n,[t,0].concat((0,g.default)(e)))}},{key:"insertAfter",value:function(t,e){var n=this;if(null!==this.doc)Lt(this.doc,(function(r){var i=t&&t instanceof re?t._item:t;se(r,n,i,e)}));else{var r,i=this._prelimContent,o=null===t?0:i.findIndex((function(e){return e===t}))+1;if(0===o&&null!==t)throw C.create("Reference item not found");(r=i).splice.apply(r,[o,0].concat((0,g.default)(e)))}}},{key:"delete",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this;null!==this.doc?Lt(this.doc,(function(r){de(r,n,t,e)})):this._prelimContent.splice(t,e)}},{key:"toArray",value:function(){return oe(this)}},{key:"push",value:function(t){this.insert(this.length,t)}},{key:"unshift",value:function(t){this.insert(0,t)}},{key:"get",value:function(t){return ae(this,t)}},{key:"slice",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;return ie(this,t,e)}},{key:"forEach",value:function(t){ue(this,t)}},{key:"_write",value:function(t){t.writeTypeRef(un)}}]),n}(re),je=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"UNDEFINED";return(0,u.default)(this,n),(t=e.call(this)).nodeName=r,t._prelimAttrs=new Map,t}return(0,c.default)(n,[{key:"nextSibling",get:function(){var t=this._item?this._item.next:null;return t?t.content.type:null}},{key:"prevSibling",get:function(){var t=this._item?this._item.prev:null;return t?t.content.type:null}},{key:"_integrate",value:function(t,e){var r=this;(0,s.default)((0,l.default)(n.prototype),"_integrate",this).call(this,t,e),this._prelimAttrs.forEach((function(t,e){r.setAttribute(e,t)})),this._prelimAttrs=null}},{key:"_copy",value:function(){return new n(this.nodeName)}},{key:"clone",value:function(){var t=new n(this.nodeName),e=this.getAttributes();for(var r in e)t.setAttribute(r,e[r]);return t.insert(0,this.toArray().map((function(t){return t instanceof re?t.clone():t}))),t}},{key:"toString",value:function(){var t=this.getAttributes(),e=[],r=[];for(var i in t)r.push(i);r.sort();for(var o=r.length,u=0;u<o;u++){var c=r[u];e.push(c+'="'+t[c]+'"')}var a=this.nodeName.toLocaleLowerCase(),f=e.length>0?" "+e.join(" "):"";return"<".concat(a).concat(f,">").concat((0,s.default)((0,l.default)(n.prototype),"toString",this).call(this),"</").concat(a,">")}},{key:"removeAttribute",value:function(t){var e=this;null!==this.doc?Lt(this.doc,(function(n){he(n,e,t)})):this._prelimAttrs.delete(t)}},{key:"setAttribute",value:function(t,e){var n=this;null!==this.doc?Lt(this.doc,(function(r){ve(r,n,t,e)})):this._prelimAttrs.set(t,e)}},{key:"getAttribute",value:function(t){return ge(this,t)}},{key:"hasAttribute",value:function(t){return ye(this,t)}},{key:"getAttributes",value:function(){return pe(this)}},{key:"toDOM",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=t.createElement(this.nodeName),i=this.getAttributes();for(var o in i)r.setAttribute(o,i[o]);return ue(this,(function(i){r.appendChild(i.toDOM(t,e,n))})),void 0!==n&&n._createAssociation(r,this),r}},{key:"_write",value:function(t){t.writeTypeRef(on),t.writeKey(this.nodeName)}}]),n}(Le),Je=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(t,r,i){var o;return(0,u.default)(this,n),(o=e.call(this,t,i)).childListChanged=!1,o.attributesChanged=new Set,r.forEach((function(t){null===t?o.childListChanged=!0:o.attributesChanged.add(t)})),o}return n}(Kt),Pe=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(t){var r;return(0,u.default)(this,n),(r=e.call(this)).hookName=t,r}return(0,c.default)(n,[{key:"_copy",value:function(){return new n(this.hookName)}},{key:"clone",value:function(){var t=new n(this.hookName);return this.forEach((function(e,n){t.set(n,e)})),t}},{key:"toDOM",value:function(){arguments.length>0&&void 0!==arguments[0]||document;var t,e=arguments.length>2?arguments[2]:void 0,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})[this.hookName];return(t=void 0!==n?n.createDom(this):document.createElement(this.hookName)).setAttribute("data-yjs-hook",this.hookName),void 0!==e&&e._createAssociation(t,this),t}},{key:"_write",value:function(t){t.writeTypeRef(cn),t.writeKey(this.hookName)}}]),n}(_e),ze=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(){return(0,u.default)(this,n),e.apply(this,arguments)}return(0,c.default)(n,[{key:"nextSibling",get:function(){var t=this._item?this._item.next:null;return t?t.content.type:null}},{key:"prevSibling",get:function(){var t=this._item?this._item.prev:null;return t?t.content.type:null}},{key:"_copy",value:function(){return new n}},{key:"clone",value:function(){var t=new n;return t.applyDelta(this.toDelta()),t}},{key:"toDOM",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=arguments.length>2?arguments[2]:void 0,n=t.createTextNode(this.toString());return void 0!==e&&e._createAssociation(n,this),n}},{key:"toString",value:function(){return this.toDelta().map((function(t){var e=function(e){var r=[];for(var i in t.attributes[e])r.push({key:i,value:t.attributes[e][i]});r.sort((function(t,e){return t.key<e.key?-1:1})),n.push({nodeName:e,attrs:r})},n=[];for(var r in t.attributes)e(r);n.sort((function(t,e){return t.nodeName<e.nodeName?-1:1}));for(var i="",o=0;o<n.length;o++){var u=n[o];i+="<".concat(u.nodeName);for(var c=0;c<u.attrs.length;c++){var a=u.attrs[c];i+=" ".concat(a.key,'="').concat(a.value,'"')}i+=">"}i+=t.insert;for(var s=n.length-1;s>=0;s--)i+="</".concat(n[s].nodeName,">");return i})).join("")}},{key:"toJSON",value:function(){return this.toString()}},{key:"_write",value:function(t){t.writeTypeRef(an)}}]),n}(Be),Fe=function(){"use strict";function t(e,n){(0,u.default)(this,t),this.id=e,this.length=n}return(0,c.default)(t,[{key:"deleted",get:function(){throw C.methodUnimplemented()}},{key:"mergeWith",value:function(t){return!1}},{key:"write",value:function(t,e,n){throw C.methodUnimplemented()}},{key:"integrate",value:function(t,e){throw C.methodUnimplemented()}}]),t}(),We=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(){return(0,u.default)(this,n),e.apply(this,arguments)}return(0,c.default)(n,[{key:"deleted",get:function(){return!0}},{key:"delete",value:function(){}},{key:"mergeWith",value:function(t){return this.constructor===t.constructor&&(this.length+=t.length,!0)}},{key:"integrate",value:function(t,e){e>0&&(this.id.clock+=e,this.length-=e),xt(t.doc.store,this)}},{key:"write",value:function(t,e){t.writeInfo(0),t.writeLen(this.length-e)}},{key:"getMissing",value:function(t,e){return null}}]),n}(Fe),qe=function(){"use strict";function t(e){(0,u.default)(this,t),this.content=e}return(0,c.default)(t,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[this.content]}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new t(this.content)}},{key:"splice",value:function(t){throw C.methodUnimplemented()}},{key:"mergeWith",value:function(t){return!1}},{key:"integrate",value:function(t,e){}},{key:"delete",value:function(t){}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){t.writeBuf(this.content)}},{key:"getRef",value:function(){return 3}}]),t}(),Qe=function(){"use strict";function t(e){(0,u.default)(this,t),this.len=e}return(0,c.default)(t,[{key:"getLength",value:function(){return this.len}},{key:"getContent",value:function(){return[]}},{key:"isCountable",value:function(){return!1}},{key:"copy",value:function(){return new t(this.len)}},{key:"splice",value:function(e){var n=new t(this.len-e);return this.len=e,n}},{key:"mergeWith",value:function(t){return this.len+=t.len,!0}},{key:"integrate",value:function(t,e){J(t.deleteSet,e.id.client,e.id.clock,this.len),e.markDeleted()}},{key:"delete",value:function(t){}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){t.writeLen(this.len-e)}},{key:"getRef",value:function(){return 1}}]),t}(),Ge=function(t,e){return new G((0,h.default)((0,d.default)({guid:t},e),{shouldLoad:e.shouldLoad||e.autoLoad||!1}))},He=function(){"use strict";function t(e){(0,u.default)(this,t),e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;var n={};this.opts=n,e.gc||(n.gc=!1),e.autoLoad&&(n.autoLoad=!0),null!==e.meta&&(n.meta=e.meta)}return(0,c.default)(t,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[this.doc]}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new t(Ge(this.doc.guid,this.opts))}},{key:"splice",value:function(t){throw C.methodUnimplemented()}},{key:"mergeWith",value:function(t){return!1}},{key:"integrate",value:function(t,e){this.doc._item=e,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}},{key:"delete",value:function(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){t.writeString(this.doc.guid),t.writeAny(this.opts)}},{key:"getRef",value:function(){return 9}}]),t}(),Ke=function(){"use strict";function t(e){(0,u.default)(this,t),this.embed=e}return(0,c.default)(t,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[this.embed]}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new t(this.embed)}},{key:"splice",value:function(t){throw C.methodUnimplemented()}},{key:"mergeWith",value:function(t){return!1}},{key:"integrate",value:function(t,e){}},{key:"delete",value:function(t){}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){t.writeJSON(this.embed)}},{key:"getRef",value:function(){return 5}}]),t}(),Ze=function(){"use strict";function t(e,n){(0,u.default)(this,t),this.key=e,this.value=n}return(0,c.default)(t,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[]}},{key:"isCountable",value:function(){return!1}},{key:"copy",value:function(){return new t(this.key,this.value)}},{key:"splice",value:function(t){throw C.methodUnimplemented()}},{key:"mergeWith",value:function(t){return!1}},{key:"integrate",value:function(t,e){e.parent._searchMarker=null}},{key:"delete",value:function(t){}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){t.writeKey(this.key),t.writeJSON(this.value)}},{key:"getRef",value:function(){return 6}}]),t}(),Xe=function(){"use strict";function t(e){(0,u.default)(this,t),this.arr=e}return(0,c.default)(t,[{key:"getLength",value:function(){return this.arr.length}},{key:"getContent",value:function(){return this.arr}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new t(this.arr)}},{key:"splice",value:function(e){var n=new t(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}},{key:"mergeWith",value:function(t){return this.arr=this.arr.concat(t.arr),!0}},{key:"integrate",value:function(t,e){}},{key:"delete",value:function(t){}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){var n=this.arr.length;t.writeLen(n-e);for(var r=e;r<n;r++){var i=this.arr[r];t.writeString(void 0===i?"undefined":JSON.stringify(i))}}},{key:"getRef",value:function(){return 2}}]),t}(),Ye=function(){"use strict";function t(e){(0,u.default)(this,t),this.arr=e}return(0,c.default)(t,[{key:"getLength",value:function(){return this.arr.length}},{key:"getContent",value:function(){return this.arr}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new t(this.arr)}},{key:"splice",value:function(e){var n=new t(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}},{key:"mergeWith",value:function(t){return this.arr=this.arr.concat(t.arr),!0}},{key:"integrate",value:function(t,e){}},{key:"delete",value:function(t){}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){var n=this.arr.length;t.writeLen(n-e);for(var r=e;r<n;r++){var i=this.arr[r];t.writeAny(i)}}},{key:"getRef",value:function(){return 8}}]),t}(),$e=function(){"use strict";function t(e){(0,u.default)(this,t),this.str=e}return(0,c.default)(t,[{key:"getLength",value:function(){return this.str.length}},{key:"getContent",value:function(){return this.str.split("")}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new t(this.str)}},{key:"splice",value:function(e){var n=new t(this.str.slice(e));this.str=this.str.slice(0,e);var r=this.str.charCodeAt(e-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,e-1)+"",n.str=""+n.str.slice(1)),n}},{key:"mergeWith",value:function(t){return this.str+=t.str,!0}},{key:"integrate",value:function(t,e){}},{key:"delete",value:function(t){}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){t.writeString(0===e?this.str:this.str.slice(e))}},{key:"getRef",value:function(){return 4}}]),t}(),tn=[function(t){return new me},function(t){return new _e},function(t){return new Be},function(t){return new je(t.readKey())},function(t){return new Le},function(t){return new Pe(t.readKey())},function(t){return new ze}],en=0,nn=1,rn=2,on=3,un=4,cn=5,an=6,sn=function(){"use strict";function t(e){(0,u.default)(this,t),this.type=e}return(0,c.default)(t,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[this.type]}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new t(this.type._copy())}},{key:"splice",value:function(t){throw C.methodUnimplemented()}},{key:"mergeWith",value:function(t){return!1}},{key:"integrate",value:function(t,e){this.type._integrate(t.doc,e)}},{key:"delete",value:function(t){for(var e=this.type._start;null!==e;)e.deleted?t._mergeStructs.push(e):e.delete(t),e=e.right;this.type._map.forEach((function(e){e.deleted?t._mergeStructs.push(e):e.delete(t)})),t.changed.delete(this.type)}},{key:"gc",value:function(t){for(var e=this.type._start;null!==e;)e.gc(t,!0),e=e.right;this.type._start=null,this.type._map.forEach((function(e){for(;null!==e;)e.gc(t,!0),e=e.left})),this.type._map=new Map}},{key:"write",value:function(t,e){this.type._write(t)}},{key:"getRef",value:function(){return 7}}]),t}(),ln=function(t,e,n){var r=e.id,i=r.client,o=r.clock,u=new fn(kt(i,o+n),e,kt(i,o+n-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(n));return e.deleted&&u.markDeleted(),e.keep&&(u.keep=!0),null!==e.redone&&(u.redone=kt(e.redone.client,e.redone.clock+n)),e.right=u,null!==u.right&&(u.right.left=u),t._mergeStructs.push(u),null!==u.parentSub&&null===u.right&&u.parent._map.set(u.parentSub,u),e.length=n,u},fn=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(t,r,i,o,c,a,s,l){var f;return(0,u.default)(this,n),(f=e.call(this,t,l.getLength())).origin=i,f.left=r,f.right=o,f.rightOrigin=c,f.parent=a,f.parentSub=s,f.redone=null,f.content=l,f.info=f.content.isCountable()?A.BIT2:0,f}return(0,c.default)(n,[{key:"marker",get:function(){return(this.info&A.BIT4)>0},set:function(t){(this.info&A.BIT4)>0!==t&&(this.info^=A.BIT4)}},{key:"keep",get:function(){return(this.info&A.BIT1)>0},set:function(t){this.keep!==t&&(this.info^=A.BIT1)}},{key:"countable",get:function(){return(this.info&A.BIT2)>0}},{key:"deleted",get:function(){return(this.info&A.BIT3)>0},set:function(t){this.deleted!==t&&(this.info^=A.BIT3)}},{key:"markDeleted",value:function(){this.info|=A.BIT3}},{key:"getMissing",value:function(t,e){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=St(e,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=St(e,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===pt&&this.id.client!==this.parent.client&&this.parent.clock>=St(e,this.parent.client))return this.parent.client;if(this.origin&&(this.left=It(t,e,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=Ut(t,this.rightOrigin),this.rightOrigin=this.right.id),(this.left&&this.left.constructor===We||this.right&&this.right.constructor===We)&&(this.parent=null),this.parent){if(this.parent.constructor===pt){var r=Ct(e,this.parent);r.constructor===We?this.parent=null:this.parent=r.content.type}}else this.left&&this.left.constructor===n&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===n&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);return null}},{key:"integrate",value:function(t,e){if(e>0&&(this.id.clock+=e,this.left=It(t,t.doc.store,kt(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(e),this.length-=e),this.parent){if(!this.left&&(!this.right||null!==this.right.left)||this.left&&this.left.right!==this.right){var n,r=this.left;if(null!==r)n=r.right;else if(null!==this.parentSub)for(n=this.parent._map.get(this.parentSub)||null;null!==n&&null!==n.left;)n=n.left;else n=this.parent._start;for(var i=new Set,o=new Set;null!==n&&n!==this.right;){if(o.add(n),i.add(n),yt(this.origin,n.origin)){if(n.id.client<this.id.client)r=n,i.clear();else if(yt(this.rightOrigin,n.rightOrigin))break}else{if(null===n.origin||!o.has(Ct(t.doc.store,n.origin)))break;i.has(Ct(t.doc.store,n.origin))||(r=n,i.clear())}n=n.right}this.left=r}if(null!==this.left){var u=this.left.right;this.right=u,this.left.right=this}else{var c;if(null!==this.parentSub)for(c=this.parent._map.get(this.parentSub)||null;null!==c&&null!==c.left;)c=c.left;else c=this.parent._start,this.parent._start=this;this.right=c}null!==this.right?this.right.left=this:null!==this.parentSub&&(this.parent._map.set(this.parentSub,this),null!==this.left&&this.left.delete(t)),null===this.parentSub&&this.countable&&!this.deleted&&(this.parent._length+=this.length),xt(t.doc.store,this),this.content.integrate(t,this),Vt(t,this.parent,this.parentSub),(null!==this.parent._item&&this.parent._item.deleted||null!==this.parentSub&&null!==this.right)&&this.delete(t)}else new We(this.id,this.length).integrate(t,0)}},{key:"next",get:function(){for(var t=this.right;null!==t&&t.deleted;)t=t.right;return t}},{key:"prev",get:function(){for(var t=this.left;null!==t&&t.deleted;)t=t.left;return t}},{key:"lastId",get:function(){return 1===this.length?this.id:kt(this.id.client,this.id.clock+this.length-1)}},{key:"mergeWith",value:function(t){var e=this;if(this.constructor===t.constructor&&yt(t.origin,this.lastId)&&this.right===t&&yt(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&null===this.redone&&null===t.redone&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){var n=this.parent._searchMarker;return n&&n.forEach((function(n){n.p===t&&(n.p=e,!e.deleted&&e.countable&&(n.index-=e.length))})),t.keep&&(this.keep=!0),this.right=t.right,null!==this.right&&(this.right.left=this),this.length+=t.length,!0}return!1}},{key:"delete",value:function(t){if(!this.deleted){var e=this.parent;this.countable&&null===this.parentSub&&(e._length-=this.length),this.markDeleted(),J(t.deleteSet,this.id.client,this.id.clock,this.length),Vt(t,e,this.parentSub),this.content.delete(t)}}},{key:"gc",value:function(t,e){if(!this.deleted)throw C.unexpectedCase();this.content.gc(t),e?function(t,e,n){var r=t.clients.get(e.id.client);r[Et(r,e.id.clock)]=n}(t,this,new We(this.id,this.length)):this.content=new Qe(this.length)}},{key:"write",value:function(t,e){var n=e>0?kt(this.id.client,this.id.clock+e-1):this.origin,r=this.rightOrigin,i=this.parentSub,o=this.content.getRef()&A.BITS5|(null===n?0:A.BIT8)|(null===r?0:A.BIT7)|(null===i?0:A.BIT6);if(t.writeInfo(o),null!==n&&t.writeLeftID(n),null!==r&&t.writeRightID(r),null===n&&null===r){var u=this.parent;if(void 0!==u._item){var c=u._item;if(null===c){var a=function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=t.doc.share.entries()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var u=(0,v.default)(i.value,2),c=u[0];if(u[1]===t)return c}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}throw C.unexpectedCase()}(u);t.writeParentInfo(!0),t.writeString(a)}else t.writeParentInfo(!1),t.writeLeftID(c.id)}else u.constructor===String?(t.writeParentInfo(!0),t.writeString(u)):u.constructor===pt?(t.writeParentInfo(!1),t.writeLeftID(u)):C.unexpectedCase();null!==i&&t.writeString(i)}this.content.write(t,e)}}]),n}(Fe),dn=function(t,e){return hn[e&A.BITS5](t)},hn=[function(){C.unexpectedCase()},function(t){return new Qe(t.readLen())},function(t){for(var e=t.readLen(),n=[],r=0;r<e;r++){var i=t.readString();"undefined"===i?n.push(void 0):n.push(JSON.parse(i))}return new Xe(n)},function(t){return new qe(t.readBuf())},function(t){return new $e(t.readString())},function(t){return new Ke(t.readJSON())},function(t){return new Ze(t.readKey(),t.readJSON())},function(t){return new sn(tn[t.readTypeRef()](t))},function(t){for(var e=t.readLen(),n=[],r=0;r<e;r++)n.push(t.readAny());return new Ye(n)},function(t){return new He(Ge(t.readString(),t.readAny()))},function(){C.unexpectedCase()}],vn=function(t){"use strict";(0,f.default)(n,t);var e=(0,p.default)(n);function n(){return(0,u.default)(this,n),e.apply(this,arguments)}return(0,c.default)(n,[{key:"deleted",get:function(){return!0}},{key:"delete",value:function(){}},{key:"mergeWith",value:function(t){return this.constructor===t.constructor&&(this.length+=t.length,!0)}},{key:"integrate",value:function(t,e){C.unexpectedCase()}},{key:"write",value:function(t,e){t.writeInfo(10),_.writeVarUint(t.restEncoder,this.length-e)}},{key:"getMissing",value:function(t,e){return null}}]),n}(Fe),gn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:{};!0===gn["__ $YJS$ __"]&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),gn["__ $YJS$ __"]=!0})),n.register("iFdjt",(function(e,n){function r(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n.push.apply(n,r)}return n}(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})),t}t(e.exports,"default",(function(){return r}))})),n.register("l6A6q",(function(e,r){t(e.exports,"Observable",(function(){return l}));var i=n("kxanC"),o=n("hWDD9"),u=n("9oGi2"),c=n("8lrtM"),a=n("i4ULi"),s=n("gJ9ip"),l=function(){"use strict";function t(){(0,i.default)(this,t),this._observers=c.create()}return(0,o.default)(t,[{key:"on",value:function(t,e){c.setIfUndefined(this._observers,t,a.create).add(e)}},{key:"once",value:function(t,e){var n=this,r=function(){for(var i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];n.off(t,r),e.apply(void 0,(0,u.default)(o))};this.on(t,r)}},{key:"off",value:function(t,e){var n=this._observers.get(t);void 0!==n&&(n.delete(e),0===n.size&&this._observers.delete(t))}},{key:"emit",value:function(t,e){return s.from((this._observers.get(t)||c.create()).values()).forEach((function(t){return t.apply(void 0,(0,u.default)(e))}))}},{key:"destroy",value:function(){this._observers=c.create()}}]),t}()})),n.register("8lrtM",(function(e,r){t(e.exports,"create",(function(){return o})),t(e.exports,"copy",(function(){return u})),t(e.exports,"setIfUndefined",(function(){return c})),t(e.exports,"map",(function(){return a})),t(e.exports,"any",(function(){return s}));var i=n("mBz5n"),o=function(){return new Map},u=function(t){var e=o();return t.forEach((function(t,n){e.set(n,t)})),e},c=function(t,e,n){var r=t.get(e);return void 0===r&&t.set(e,r=n()),r},a=function(t,e){var n=[],r=!0,o=!1,u=void 0;try{for(var c,a=t[Symbol.iterator]();!(r=(c=a.next()).done);r=!0){var s=(0,i.default)(c.value,2),l=s[0],f=s[1];n.push(e(f,l))}}catch(t){o=!0,u=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw u}}return n},s=function(t,e){var n=!0,r=!1,o=void 0;try{for(var u,c=t[Symbol.iterator]();!(n=(u=c.next()).done);n=!0){var a=(0,i.default)(u.value,2),s=a[0];if(e(a[1],s))return!0}}catch(t){r=!0,o=t}finally{try{n||null==c.return||c.return()}finally{if(r)throw o}}return!1}})),n.register("i4ULi",(function(e,n){t(e.exports,"create",(function(){return r}));var r=function(){return new Set}})),n.register("gJ9ip",(function(e,n){t(e.exports,"last",(function(){return r})),t(e.exports,"appendTo",(function(){return i})),t(e.exports,"from",(function(){return o})),t(e.exports,"equalFlat",(function(){return u})),t(e.exports,"isArray",(function(){return c}));var r=function(t){return t[t.length-1]},i=function(t,e){for(var n=0;n<e.length;n++)t.push(e[n])},o=Array.from,u=function(t,e){return t.length===e.length&&(n=function(t,n){return t===e[n]},t.every(n));var n},c=Array.isArray})),n.register("j4QyJ",(function(e,n){t(e.exports,"floor",(function(){return r})),t(e.exports,"abs",(function(){return i})),t(e.exports,"round",(function(){return o})),t(e.exports,"log10",(function(){return u})),t(e.exports,"min",(function(){return c})),t(e.exports,"max",(function(){return a})),t(e.exports,"exp10",(function(){return s})),t(e.exports,"isNegativeZero",(function(){return l}));var r=Math.floor,i=(Math.ceil,Math.abs),o=(Math.imul,Math.round),u=Math.log10,c=(Math.log2,Math.log,Math.sqrt,function(t,e){return t<e?t:e}),a=function(t,e){return t>e?t:e},s=(Number.isNaN,Math.pow,function(t){return Math.pow(10,t)}),l=(Math.sign,function(t){return 0!==t?t<0:1/t<0})})),n.register("5oPGD",(function(e,r){t(e.exports,"createEncoder",(function(){return g})),t(e.exports,"toUint8Array",(function(){return p})),t(e.exports,"writeUint8",(function(){return k})),t(e.exports,"writeVarUint",(function(){return w})),t(e.exports,"writeVarInt",(function(){return m})),t(e.exports,"writeVarUint8Array",(function(){return E})),t(e.exports,"writeVarString",(function(){return D})),t(e.exports,"writeBinaryEncoder",(function(){return S})),t(e.exports,"writeUint8Array",(function(){return x})),t(e.exports,"writeAny",(function(){return U})),t(e.exports,"RleEncoder",(function(){return I})),t(e.exports,"UintOptRleEncoder",(function(){return O})),t(e.exports,"IntDiffOptRleEncoder",(function(){return V})),t(e.exports,"StringEncoder",(function(){return N}));var i=n("kxanC"),o=n("hWDD9"),u=n("cksMj"),c=n("aojpe"),a=n("giCK6"),s=n("1xlRH"),l=n("j4QyJ"),f=n("8D4M3"),d=n("1rtpa"),h=n("akQJc"),v=function t(){"use strict";(0,i.default)(this,t),this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]},g=function(){return new v},p=function(t){for(var e=new Uint8Array(function(t){for(var e=t.cpos,n=0;n<t.bufs.length;n++)e+=t.bufs[n].length;return e}(t)),n=0,r=0;r<t.bufs.length;r++){var i=t.bufs[r];e.set(i,n),n+=i.length}return e.set(s.createUint8ArrayViewFromArrayBuffer(t.cbuf.buffer,0,t.cpos),n),e},y=function(t,e){var n=t.cbuf.length;t.cpos===n&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(2*n),t.cpos=0),t.cbuf[t.cpos++]=e},k=y,w=function(t,e){for(;e>d.BITS7;)y(t,d.BIT8|d.BITS7&e),e=l.floor(e/128);y(t,d.BITS7&e)},m=function(t,e){var n=l.isNegativeZero(e);for(n&&(e=-e),y(t,(e>d.BITS6?d.BIT8:0)|(n?d.BIT7:0)|d.BITS6&e),e=l.floor(e/64);e>0;)y(t,(e>d.BITS7?d.BIT8:0)|d.BITS7&e),e=l.floor(e/128)},b=new Uint8Array(3e4),_=b.length/3,D=h.utf8TextEncoder&&h.utf8TextEncoder.encodeInto?function(t,e){if(e.length<_){var n=h.utf8TextEncoder.encodeInto(e,b).written||0;w(t,n);for(var r=0;r<n;r++)y(t,b[r])}else E(t,h.encodeUtf8(e))}:function(t,e){var n=unescape(encodeURIComponent(e)),r=n.length;w(t,r);for(var i=0;i<r;i++)y(t,n.codePointAt(i))},S=function(t,e){return x(t,p(e))},x=function(t,e){var n=t.cbuf.length,r=t.cpos,i=l.min(n-r,e.length),o=e.length-i;t.cbuf.set(e.subarray(0,i),r),t.cpos+=i,o>0&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(l.max(2*n,o)),t.cbuf.set(e.subarray(i)),t.cpos=o)},E=function(t,e){w(t,e.byteLength),x(t,e)},C=function(t,e){!function(t,e){var n=t.cbuf.length;n-t.cpos<e&&(t.bufs.push(s.createUint8ArrayViewFromArrayBuffer(t.cbuf.buffer,0,t.cpos)),t.cbuf=new Uint8Array(2*l.max(n,e)),t.cpos=0)}(t,e);var n=new DataView(t.cbuf.buffer,t.cpos,e);return t.cpos+=e,n},A=new DataView(new ArrayBuffer(4)),U=function(t,e){switch(void 0===e?"undefined":(0,c.default)(e)){case"string":y(t,119),D(t,e);break;case"number":f.isInteger(e)&&l.abs(e)<=d.BITS31?(y(t,125),m(t,e)):(u=e,A.setFloat32(0,u),A.getFloat32(0)===u?(y(t,124),function(t,e){C(t,4).setFloat32(0,e,!1)}(t,e)):(y(t,123),function(t,e){C(t,8).setFloat64(0,e,!1)}(t,e)));break;case"bigint":y(t,122),function(t,e){C(t,8).setBigInt64(0,e,!1)}(t,e);break;case"object":if(null===e)y(t,126);else if(e instanceof Array){y(t,117),w(t,e.length);for(var n=0;n<e.length;n++)U(t,e[n])}else if(e instanceof Uint8Array)y(t,116),E(t,e);else{y(t,118);var r=Object.keys(e);w(t,r.length);for(var i=0;i<r.length;i++){var o=r[i];D(t,o),U(t,e[o])}}break;case"boolean":y(t,e?120:121);break;default:y(t,127)}var u},I=function(t){"use strict";(0,u.default)(n,t);var e=(0,a.default)(n);function n(t){var r;return(0,i.default)(this,n),(r=e.call(this)).w=t,r.s=null,r.count=0,r}return(0,o.default)(n,[{key:"write",value:function(t){this.s===t?this.count++:(this.count>0&&w(this,this.count-1),this.count=1,this.w(this,t),this.s=t)}}]),n}(v),T=function(t){t.count>0&&(m(t.encoder,1===t.count?t.s:-t.s),t.count>1&&w(t.encoder,t.count-2))},O=function(){"use strict";function t(){(0,i.default)(this,t),this.encoder=new v,this.s=0,this.count=0}return(0,o.default)(t,[{key:"write",value:function(t){this.s===t?this.count++:(T(this),this.count=1,this.s=t)}},{key:"toUint8Array",value:function(){return T(this),p(this.encoder)}}]),t}(),M=function(t){if(t.count>0){var e=2*t.diff+(1===t.count?0:1);m(t.encoder,e),t.count>1&&w(t.encoder,t.count-2)}},V=function(){"use strict";function t(){(0,i.default)(this,t),this.encoder=new v,this.s=0,this.count=0,this.diff=0}return(0,o.default)(t,[{key:"write",value:function(t){this.diff===t-this.s?(this.s=t,this.count++):(M(this),this.count=1,this.diff=t-this.s,this.s=t)}},{key:"toUint8Array",value:function(){return M(this),p(this.encoder)}}]),t}(),N=function(){"use strict";function t(){(0,i.default)(this,t),this.sarr=[],this.s="",this.lensE=new O}return(0,o.default)(t,[{key:"write",value:function(t){this.s+=t,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(t.length)}},{key:"toUint8Array",value:function(){var t=new v;return this.sarr.push(this.s),this.s="",D(t,this.sarr.join("")),x(t,this.lensE.toUint8Array()),p(t)}}]),t}()})),n.register("1xlRH",(function(e,r){t(e.exports,"createUint8ArrayViewFromArrayBuffer",(function(){return o})),t(e.exports,"copyUint8Array",(function(){return u}));n("akQJc");var i=n("dlAZc"),o=(n("5oPGD"),n("d9ERd"),n("1irm0").Buffer,function(t,e,n){return new Uint8Array(t,e,n)}),u=(i.isBrowser,i.isBrowser,function(t){var e=function(t){return new Uint8Array(t)}(t.byteLength);return e.set(t),e})})),n.register("akQJc",(function(e,n){t(e.exports,"fromCharCode",(function(){return r})),t(e.exports,"fromCamelCase",(function(){return u})),t(e.exports,"utf8TextEncoder",(function(){return c})),t(e.exports,"encodeUtf8",(function(){return a})),t(e.exports,"utf8TextDecoder",(function(){return s}));var r=String.fromCharCode,i=(String.fromCodePoint,/^\s*/g),o=/([A-Z])/g,u=function(t,e){return function(t){return t.replace(i,"")}(t.replace(o,(function(t){return"".concat(e).concat(function(t){return t.toLowerCase()}(t))})))},c="undefined"!=typeof TextEncoder?new TextEncoder:null,a=c?function(t){return c.encode(t)}:function(t){for(var e=unescape(encodeURIComponent(t)),n=e.length,r=new Uint8Array(n),i=0;i<n;i++)r[i]=e.codePointAt(i);return r},s="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});s&&1===s.decode(new Uint8Array).length&&(s=null)})),n.register("dlAZc",(function(e,r){t(e.exports,"isNode",(function(){return d})),t(e.exports,"isBrowser",(function(){return h})),t(e.exports,"getVariable",(function(){return p})),t(e.exports,"supportsColor",(function(){return k}));var i,o=n("mBz5n"),u=n("8lrtM"),c=n("akQJc"),a=n("7PMNM"),s=n("2lilO"),l=n("3ODE7"),f=n("b758v"),d=void 0!==f&&f.release&&/node|io\.js/.test(f.release.name),h="undefined"!=typeof window&&!d,v=("undefined"!=typeof navigator&&/Mac/.test(navigator.platform),[]),g=function(t){return function(){if(void 0===i)if(d){i=u.create();for(var t=f.argv,e=null,n=0;n<t.length;n++){var r=t[n];"-"===r[0]?(null!==e&&i.set(e,""),e=r):null!==e?(i.set(e,r),e=null):v.push(r)}null!==e&&i.set(e,"")}else"object"==typeof location?(i=u.create(),(location.search||"?").slice(1).split("&").forEach((function(t){if(0!==t.length){var e=(0,o.default)(t.split("="),2),n=e[0],r=e[1];i.set("--".concat(c.fromCamelCase(n,"-")),r),i.set("-".concat(c.fromCamelCase(n,"-")),r)}}))):i=u.create();return i}().has(t)},p=function(t){return d?a.undefinedToNull(f.env[t.toUpperCase()]):a.undefinedToNull(s.varStorage.getItem(t))},y=(g("--"+"production")||p("production"),d&&l.isOneOf(void 0,["true","1","2"])),k=!g("no-colors")&&(!d||f.stdout.isTTY||y)&&(!d||g("color")||y||null!==p("COLORTERM")||(p("TERM")||"").includes("color"))})),n.register("7PMNM",(function(e,n){t(e.exports,"undefinedToNull",(function(){return r}));var r=function(t){return void 0===t?null:t}})),n.register("2lilO",(function(e,r){t(e.exports,"varStorage",(function(){return c}));var i=n("kxanC"),o=n("hWDD9"),u=new(function(){"use strict";function t(){(0,i.default)(this,t),this.map=new Map}return(0,o.default)(t,[{key:"setItem",value:function(t,e){this.map.set(t,e)}},{key:"getItem",value:function(t){return this.map.get(t)}}]),t}());try{"undefined"!=typeof localStorage&&(u=localStorage)}catch(t){}var c=u})),n.register("3ODE7",(function(e,r){t(e.exports,"callAll",(function(){return o})),t(e.exports,"nop",(function(){return u})),t(e.exports,"isOneOf",(function(){return c}));var i=n("9oGi2"),o=(n("gJ9ip"),n("6J7QR"),function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;try{for(var r;n<t.length;n++)(r=t)[n].apply(r,(0,i.default)(e))}finally{n<t.length&&o(t,e,n+1)}}),u=function(){},c=function(t,e){return e.includes(t)}})),n.register("6J7QR",(function(e,n){t(e.exports,"length",(function(){return i})),t(e.exports,"hasProperty",(function(){return o})),t(e.exports,"equalFlat",(function(){return u})),Object.assign;var r=Object.keys,i=function(t){return r(t).length},o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},u=function(t,e){return t===e||i(t)===i(e)&&function(t,e){for(var n in t)if(!e(t[n],n))return!1;return!0}(t,(function(t,n){return(void 0!==t||o(e,n))&&e[n]===t}))}})),n.register("b758v",(function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function c(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(t){r=u}}();var a,s=[],l=!1,f=-1;function d(){l&&a&&(l=!1,a.length?s=a.concat(s):f=-1,s.length&&h())}function h(){if(!l){var t=c(d);l=!0;for(var e=s.length;e;){for(a=s,s=[];++f<e;)a&&a[f].run();f=-1,e=s.length}a=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function v(t,e){this.fun=t,this.array=e}function g(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new v(t,e)),1!==s.length||l||c(h)},v.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}})),n.register("d9ERd",(function(e,r){t(e.exports,"createDecoder",(function(){return y})),t(e.exports,"hasContent",(function(){return k})),t(e.exports,"readVarUint8Array",(function(){return w})),t(e.exports,"readVarUint",(function(){return b})),t(e.exports,"readUint8",(function(){return m})),t(e.exports,"readVarInt",(function(){return _})),t(e.exports,"readVarString",(function(){return D})),t(e.exports,"readAny",(function(){return E})),t(e.exports,"RleDecoder",(function(){return C})),t(e.exports,"UintOptRleDecoder",(function(){return A})),t(e.exports,"IntDiffOptRleDecoder",(function(){return U})),t(e.exports,"StringDecoder",(function(){return I}));var i=n("kxanC"),o=n("hWDD9"),u=n("cksMj"),c=n("giCK6"),a=n("1xlRH"),s=n("1rtpa"),l=n("j4QyJ"),f=n("8D4M3"),d=n("akQJc"),h=n("4ehDZ"),v=h.create("Unexpected end of array"),g=h.create("Integer out of Range"),p=function t(e){"use strict";(0,i.default)(this,t),this.arr=e,this.pos=0},y=function(t){return new p(t)},k=function(t){return t.pos!==t.arr.length},w=function(t){return function(t,e){var n=a.createUint8ArrayViewFromArrayBuffer(t.arr.buffer,t.pos+t.arr.byteOffset,e);return t.pos+=e,n}(t,b(t))},m=function(t){return t.arr[t.pos++]},b=function(t){for(var e=0,n=1,r=t.arr.length;t.pos<r;){var i=t.arr[t.pos++];if(e+=(i&s.BITS7)*n,n*=128,i<s.BIT8)return e;if(e>f.MAX_SAFE_INTEGER)throw g}throw v},_=function(t){var e=t.arr[t.pos++],n=e&s.BITS6,r=64,i=(e&s.BIT7)>0?-1:1;if(0==(e&s.BIT8))return i*n;for(var o=t.arr.length;t.pos<o;){if(n+=((e=t.arr[t.pos++])&s.BITS7)*r,r*=128,e<s.BIT8)return i*n;if(n>f.MAX_SAFE_INTEGER)throw g}throw v},D=d.utf8TextDecoder?function(t){return d.utf8TextDecoder.decode(w(t))}:function(t){var e=b(t);if(0===e)return"";var n=String.fromCodePoint(m(t));if(--e<100)for(;e--;)n+=String.fromCodePoint(m(t));else for(;e>0;){var r=e<1e4?e:1e4,i=t.arr.subarray(t.pos,t.pos+r);t.pos+=r,n+=String.fromCodePoint.apply(null,i),e-=r}return decodeURIComponent(escape(n))},S=function(t,e){var n=new DataView(t.arr.buffer,t.arr.byteOffset+t.pos,e);return t.pos+=e,n},x=[function(t){},function(t){return null},_,function(t){return S(t,4).getFloat32(0,!1)},function(t){return S(t,8).getFloat64(0,!1)},function(t){return S(t,8).getBigInt64(0,!1)},function(t){return!1},function(t){return!0},D,function(t){for(var e=b(t),n={},r=0;r<e;r++)n[D(t)]=E(t);return n},function(t){for(var e=b(t),n=[],r=0;r<e;r++)n.push(E(t));return n},w],E=function(t){return x[127-m(t)](t)},C=function(t){"use strict";(0,u.default)(n,t);var e=(0,c.default)(n);function n(t,r){var o;return(0,i.default)(this,n),(o=e.call(this,t)).reader=r,o.s=null,o.count=0,o}return(0,o.default)(n,[{key:"read",value:function(){return 0===this.count&&(this.s=this.reader(this),k(this)?this.count=b(this)+1:this.count=-1),this.count--,this.s}}]),n}(p),A=function(t){"use strict";(0,u.default)(n,t);var e=(0,c.default)(n);function n(t){var r;return(0,i.default)(this,n),(r=e.call(this,t)).s=0,r.count=0,r}return(0,o.default)(n,[{key:"read",value:function(){if(0===this.count){this.s=_(this);var t=l.isNegativeZero(this.s);this.count=1,t&&(this.s=-this.s,this.count=b(this)+2)}return this.count--,this.s}}]),n}(p),U=function(t){"use strict";(0,u.default)(n,t);var e=(0,c.default)(n);function n(t){var r;return(0,i.default)(this,n),(r=e.call(this,t)).s=0,r.count=0,r.diff=0,r}return(0,o.default)(n,[{key:"read",value:function(){if(0===this.count){var t=_(this),e=1&t;this.diff=l.floor(t/2),this.count=1,e&&(this.count=b(this)+2)}return this.s+=this.diff,this.count--,this.s}}]),n}(p),I=function(){"use strict";function t(e){(0,i.default)(this,t),this.decoder=new A(e),this.str=D(this.decoder),this.spos=0}return(0,o.default)(t,[{key:"read",value:function(){var t=this.spos+this.decoder.read(),e=this.str.slice(this.spos,t);return this.spos=t,e}}]),t}()})),n.register("1rtpa",(function(e,n){t(e.exports,"BIT1",(function(){return r})),t(e.exports,"BIT2",(function(){return i})),t(e.exports,"BIT3",(function(){return o})),t(e.exports,"BIT4",(function(){return u})),t(e.exports,"BIT6",(function(){return c})),t(e.exports,"BIT7",(function(){return a})),t(e.exports,"BIT8",(function(){return s})),t(e.exports,"BITS5",(function(){return l})),t(e.exports,"BITS6",(function(){return f})),t(e.exports,"BITS7",(function(){return d})),t(e.exports,"BITS8",(function(){return h})),t(e.exports,"BITS21",(function(){return v})),t(e.exports,"BITS31",(function(){return g})),t(e.exports,"BITS32",(function(){return p}));var r=1,i=2,o=4,u=8,c=32,a=64,s=128,l=31,f=63,d=127,h=255,v=2097151,g=2147483647,p=4294967295})),n.register("8D4M3",(function(e,r){t(e.exports,"MAX_SAFE_INTEGER",(function(){return u})),t(e.exports,"isInteger",(function(){return c}));var i=n("j4QyJ"),o=n("1rtpa"),u=Number.MAX_SAFE_INTEGER,c=(Number.MIN_SAFE_INTEGER,o.BITS31,Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&i.floor(t)===t});Number.isNaN,Number.parseInt})),n.register("4ehDZ",(function(e,n){t(e.exports,"create",(function(){return r})),t(e.exports,"methodUnimplemented",(function(){return i})),t(e.exports,"unexpectedCase",(function(){return o}));var r=function(t){return new Error(t)},i=function(){throw r("Method unimplemented")},o=function(){throw r("Unexpected case")}})),n.register("cTGdB",(function(e,r){t(e.exports,"uint32",(function(){return o})),t(e.exports,"uuidv4",(function(){return u})),n("j4QyJ"),n("1rtpa");var i=n("cJxfh"),o=(Math.random,function(){return new Uint32Array((0,i.cryptoRandomBuffer)(4))[0]}),u=function(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(function(t){return(t^o()&15>>t/4).toString(16)}))}})),n.register("cJxfh",(function(e,n){t(e.exports,"cryptoRandomBuffer",(function(){return i})),"undefined"==typeof window||void 0!==window.performance&&window.performance;var r="undefined"==typeof crypto?null:crypto,i=null!==r?function(t){var e=new ArrayBuffer(t),n=new Uint8Array(e);return r.getRandomValues(n),e}:function(t){for(var e=new ArrayBuffer(t),n=new Uint8Array(e),r=0;r<t;r++)n[r]=Math.ceil(4294967295*Math.random()>>>0);return e}})),n.register("fBBhS",(function(e,r){t(e.exports,"create",(function(){return i})),n("bNyGR");var i=function(t){return new Promise(t)}})),n.register("bNyGR",(function(e,r){t(e.exports,"getUnixTime",(function(){return i})),n("bUkDk"),n("j4QyJ");var i=Date.now})),n.register("bUkDk",(function(e,r){t(e.exports,"prefix",(function(){return c}));var i=n("j4QyJ"),o=["","k","M","G","T","P","E","Z","Y"],u=["","m","","n","p","f","a","z","y"],c=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0===t?0:i.log10(t),r=0;n<3*r&&e>-8;)e--,r--;for(;n>=3+3*r&&e<8;)e++,r++;var c=e<0?u[-e]:o[e];return{n:i.round(1e12*(r>0?t/i.exp10(3*r):t*i.exp10(-3*r)))/1e12,prefix:c}}})),n.register("ey6DQ",(function(e,r){t(e.exports,"BOLD",(function(){return v})),t(e.exports,"UNBOLD",(function(){return g})),t(e.exports,"RED",(function(){return w})),t(e.exports,"ORANGE",(function(){return b})),t(e.exports,"print",(function(){return E})),n("kxanC"),n("hWDD9");var i,o,u=n("dLRop"),c=n("9oGi2"),a=(n("aojpe"),n("dlAZc")),s=n("cP9lR"),l=n("hHEjN"),f=n("5mYDv"),d=(n("gUOip"),n("8lrtM")),h=(n("38Bib"),n("j4QyJ"),n("bNyGR")),v=(n("3ODE7"),s.create()),g=s.create(),p=s.create(),y=s.create(),k=s.create(),w=s.create(),m=s.create(),b=s.create(),_=s.create(),D=(i={},(0,u.default)(i,v,l.create("font-weight","bold")),(0,u.default)(i,g,l.create("font-weight","normal")),(0,u.default)(i,p,l.create("color","blue")),(0,u.default)(i,k,l.create("color","green")),(0,u.default)(i,y,l.create("color","grey")),(0,u.default)(i,w,l.create("color","red")),(0,u.default)(i,m,l.create("color","purple")),(0,u.default)(i,b,l.create("color","orange")),(0,u.default)(i,_,l.create("color","black")),i),S=(o={},(0,u.default)(o,v,"[1m"),(0,u.default)(o,g,"[2m"),(0,u.default)(o,p,"[34m"),(0,u.default)(o,k,"[32m"),(0,u.default)(o,y,"[37m"),(0,u.default)(o,w,"[31m"),(0,u.default)(o,m,"[35m"),(0,u.default)(o,b,"[38;5;208m"),(0,u.default)(o,_,"[0m"),o),x=a.supportsColor?a.isNode?function(t){for(var e=[],n=[],r=0;r<t.length;r++){var i=t[r],o=S[i];if(void 0!==o)e.push(o);else{if(i.constructor!==String&&i.constructor!==Number)break;e.push(i)}}for(r>0&&(e.push("[0m"),n.push(e.join("")));r<t.length;r++){var u=t[r];u instanceof Symbol||n.push(u)}return n}:function(t){for(var e=[],n=[],r=d.create(),i=[],o=0;o<t.length;o++){var u=t[o],c=D[u];if(void 0!==c)r.set(c.left,c.right);else{if(u.constructor!==String&&u.constructor!==Number)break;var a=f.mapToStyleString(r);o>0||a.length>0?(e.push("%c"+u),n.push(a)):e.push(u)}}for(o>0&&(i=n).unshift(e.join(""));o<t.length;o++){var s=t[o];s instanceof Symbol||i.push(s)}return i}:function(t){for(var e=[],n=[],r=0;r<t.length;r++){var i=t[r];if(void 0===S[i]){if(i.constructor!==String&&i.constructor!==Number)break;e.push(i)}}for(r>0&&n.push(e.join(""));r<t.length;r++){var o=t[r];o instanceof Symbol||(o.constructor===Object?n.push(JSON.stringify(o)):n.push(o))}return n},E=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r;(r=console).log.apply(r,(0,c.default)(x(e))),C.forEach((function(t){return t.print(e)}))},C=new Set;h.getUnixTime()})),n.register("cP9lR",(function(e,r){t(e.exports,"create",(function(){return i})),n("aojpe");var i=Symbol})),n.register("hHEjN",(function(e,r){t(e.exports,"create",(function(){return u})),t(e.exports,"forEach",(function(){return c}));var i=n("kxanC"),o=function t(e,n){"use strict";(0,i.default)(this,t),this.left=e,this.right=n},u=function(t,e){return new o(t,e)},c=function(t,e){return t.forEach((function(t){return e(t.left,t.right)}))}})),n.register("5mYDv",(function(e,r){t(e.exports,"append",(function(){return s})),t(e.exports,"addEventListener",(function(){return l})),t(e.exports,"element",(function(){return f})),t(e.exports,"text",(function(){return d})),t(e.exports,"mapToStyleString",(function(){return h}));var i=n("hHEjN"),o=n("8lrtM"),u="undefined"!=typeof document?document:{},c=function(t){return u.createElement(t)},a=("undefined"!=typeof DOMParser&&new DOMParser,function(t,e){return i.forEach(e,(function(e,n){!1===n?t.removeAttribute(e):!0===n?t.setAttribute(e,""):t.setAttribute(e,n)})),t}),s=function(t,e){return v(t,function(t){for(var e=u.createDocumentFragment(),n=0;n<t.length;n++)v(e,t[n]);return e}(e)),t},l=function(t,e,n){return t.addEventListener(e,n)},f=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return s(a(c(t),e),n)},d=function(t){return u.createTextNode(t)},h=function(t){return o.map(t,(function(t,e){return"".concat(e,":").concat(t,";")})).join("")},v=function(t,e){return t.appendChild(e)};u.ELEMENT_NODE,u.TEXT_NODE,u.CDATA_SECTION_NODE,u.COMMENT_NODE,u.DOCUMENT_NODE,u.DOCUMENT_TYPE_NODE,u.DOCUMENT_FRAGMENT_NODE})),n.register("gUOip",(function(e,n){t(e.exports,"stringify",(function(){return r}));var r=JSON.stringify;JSON.parse})),n.register("38Bib",(function(e,r){t(e.exports,"enqueue",(function(){return a}));var i=n("kxanC"),o=n("hWDD9"),u=[],c=function(){for(var t=0;t<u.length;t++)u[t]();u=[]},a=function(t){u.push(t),1===u.length&&setTimeout(c,0)},s=function(t){return function(){"use strict";function e(t){(0,i.default)(this,e),this._=t}return(0,o.default)(e,[{key:"destroy",value:function(){t(this._)}}]),e}()};s(clearTimeout),s(clearInterval),s((function(t){return"undefined"!=typeof requestAnimationFrame&&cancelAnimationFrame(t)})),s((function(t){return"undefined"!=typeof cancelIdleCallback&&cancelIdleCallback(t)}))})),n.register("jZVBM",(function(e,r){t(e.exports,"iteratorFilter",(function(){return u})),t(e.exports,"iteratorMap",(function(){return c}));var i=n("dLRop"),o=function(t){var e;return e={},(0,i.default)(e,Symbol.iterator,(function(){return this})),(0,i.default)(e,"next",t),e},u=function(t,e){return o((function(){var n;do{n=t.next()}while(!n.done&&!e(n.value));return n}))},c=function(t,e){return o((function(){var n=t.next(),r=n.done,i=n.value;return{done:r,value:r?void 0:e(i)}}))}})),n.register("bF0bi",(function(e,n){t(e.exports,"encode",(function(){return i})),t(e.exports,"decode",(function(){return u}));var r=String.fromCharCode,i=function(t){for(var e=[],n=0,i=t.length;n<i;n++)e.push(r(t[n]));return btoa(e.join(""))},o=function(t){return t.charCodeAt(0)},u=function(t){return Uint8Array.from(atob(t),o)}}))}();
