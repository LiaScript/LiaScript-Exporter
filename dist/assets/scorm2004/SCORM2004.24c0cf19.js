function t(t,i,e,s){Object.defineProperty(t,i,{get:e,set:s,enumerable:!0,configurable:!0})}var i=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire55a5;i.register("1jVc2",(function(e,s){t(e.exports,"Connector",(function(){return a}));var n=i("2Xs1f"),r=i("jXXgq"),o=i("ayIBF"),c=i("5aa3i");class a extends r.Connector{scanForAPI(t){let i=0;try{for(;null==t.API_1484_11&&null!=t.parent&&t.parent!=t;){if(i++,i>500)return null;t=t.parent}return t.API_1484_11}catch(t){h("scanForAPI =>",null==t?void 0:t.message)}return null}getAPI(t){let i=null;return null!=t.parent&&t.parent!=t&&(i=this.scanForAPI(t.parent)),null==i&&null!=t.opener&&(i=this.scanForAPI(t.opener)),i}initSettings(t,i=!1){return o.Settings.init(t,!1,this.setSettings)}getSettings(){let t="";try{var i;t=(null===(i=this.scorm)||void 0===i?void 0:i.GetValue("cmi.suspend_data"))||null}catch(t){h("cannot read settings from cmi.suspend_data")}let e=null;if("string"==typeof t&&""!==t)try{e=JSON.parse(t)}catch(t){h("getSettings =>",t)}return e||(e=o.Settings.data),window.innerWidth<=768&&(e.table_of_contents=!1),e}isoDuration(t){const i=t/1e3;return`PT${Math.floor(i/3600)}H${Math.floor(i%3600/60)}M${(i%60).toFixed(2)}S`}commit(){if(this.scorm&&this.inited&&"false"===this.scorm.Commit("")){const t=this.scorm.GetLastError();h("Commit error",t,this.scorm.GetErrorString(t),this.scorm.GetDiagnostic(t))}}write(t,i,e=!1){if(this.scorm&&this.active)if(l("write: ",t,i),this.lastValues[t]!==i){if(this.lastValues[t]=i,"false"===this.scorm.SetValue(t,i)){h("error occurred for",t,i);const e=this.scorm.GetLastError();h("GetLastError:",e),e?(h("GetErrorString:",this.scorm.GetErrorString(e)),h("GetDiagnostic:",this.scorm.GetDiagnostic(e))):h("GetDiagnostic:",this.scorm.GetDiagnostic(""))}e?this.commit():(this.pendingCommit&&clearTimeout(this.pendingCommit),this.pendingCommit=window.setTimeout((()=>{this.pendingCommit=null,this.commit()}),750))}else e&&this.commit()}writeThrottled(t,i,e=300){const s=Date.now();(s-(this.lastWriteAt.get(t)||0)>=e||this.lastValues[t]!==i)&&(this.lastWriteAt.set(t,s),this.write(t,i))}init(){if(!this.scorm)return;const t=this.scorm.Initialize("");if(this.inited="true"===t,l("Initialize",t),!this.inited)return void h("Initialize failed");this.startMs=Date.now();const i=this.scorm.GetValue("cmi.mode")||"",e=this.scorm.GetValue("cmi.credit")||"";this.active="normal"===i&&"credit"===e,h(`Running in "${i}" mode, credit=${e}. Results will ${this.active?"":"NOT "}be stored!`),this.active&&(this.scaled_passing_score=c.jsonParse(this.scorm.GetValue("cmi.scaled_passing_score")),this.scaled_passing_score||(this.scaled_passing_score=window.MASTERY_SCORE||null),this.scorm.GetValue("cmi.completion_status")||this.write("cmi.completion_status","incomplete"),this.write("cmi.score.min","0"),this.write("cmi.score.max",JSON.stringify(this.totalScore)),l("cmi.entry =",this.scorm.GetValue("cmi.entry")),this.location=c.jsonParse(this.scorm.GetValue("cmi.location")),l("open location ...",this.location)),null!==this.location&&void 0!==this.location||this.slide(0);const s=this.countInteractions();if(this.active&&0===s){let t=0;t=this.initFirst("quiz",t),t=this.initFirst("survey",t),t=this.initFirst("task",t)}else{let t=0;t=this.initSecond("quiz",t),t=this.initSecond("survey",t),t=this.initSecond("task",t)}window.SCORE=0,this.score(),this.commitTimer=window.setInterval((()=>this.commit()),45e3),window.addEventListener("pagehide",(()=>this.finish(!0))),document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState&&this.commit()}))}finish(t){if(!this.scorm||!this.inited)return;const i=this.isoDuration(Date.now()-this.startMs);this.scorm.SetValue("cmi.session_time",i),this.scorm.SetValue("cmi.exit",t?"suspend":""),this.pendingCommit&&(clearTimeout(this.pendingCommit),this.pendingCommit=null),this.commit();const e=this.scorm.Terminate("");this.inited=!1,this.commitTimer&&(clearInterval(this.commitTimer),this.commitTimer=null),h("Terminate:",e)}initFirst(t,i){for(let e=0;e<this.db[t].length;e++){this.id[t].push([]);for(let s=0;s<this.db[t][e].length;s++)this.setInteraction(i,`${t}:${e}-${s}`),this.id[t][e].push(i),i++}return i}countInteractions(){if(!this.scorm)return 0;const t=this.scorm.GetValue("cmi.interactions._count"),i=parseInt(t||"0",10);return Number.isFinite(i)?i:0}initSecond(t,i){for(let e=0;e<this.db[t].length;e++){this.id[t].push([]);for(let s=0;s<this.db[t][e].length;s++){const n=this.getInteraction(i);n&&(this.db[t][e][s]=n),this.id[t][e].push(i),i++}}return i}open(t,i,e){if(null!==this.location&&void 0!==this.location){const t=this.location;setTimeout((function(){window.LIA.goto(t)}),500)}}load(t){switch(t.table){case"quiz":case"survey":case"task":return l("loading ",t.table,t.id,this.db[t.table][t.id]),this.db[t.table][t.id]}}store(t){switch(t.table){case"quiz":case"survey":this.storeHelper(t),this.score();break;case"task":this.storeHelper(t)}}storeHelper(t){const i=t.table;for(let e=0;e<this.db[i][t.id].length;e++)c.neq(t.data[e],this.db[i][t.id][e])&&(this.updateInteraction(this.id[i][t.id][e],t.data[e]),this.db[i][t.id][e]=t.data[e],"quiz"===i&&this.updateQuiz(this.id[i][t.id][e],t.data[e]))}score(){let t=0,i=0,e=0;for(let s=0;s<this.db.quiz.length;s++)for(let n=0;n<this.db.quiz[s].length;n++)switch(e=this.db.quiz[s][n].score,this.db.quiz[s][n].solved){case 1:t+=e;break;case-1:i+=e}let s=0,n=0;for(let t=0;t<this.db.survey.length;t++)for(let i=0;i<this.db.survey[t].length;i++)s+=1,this.db.survey[t][i].submitted&&(n+=1);const r=0===this.totalScore?0:t/this.totalScore,o=0===this.totalScore?0:(t+i)/this.totalScore,c=0===s||s===n;if(window.SCORE=r,l("SCORE updated =>",r,"progress =>",o,"surveys =>",`${n}/${s}`),!this.scorm||!this.active)return;const a=t=>Math.round(1e4*t)/1e4;this.write("cmi.score.scaled",JSON.stringify(a(r))),this.write("cmi.score.raw",JSON.stringify(t)),this.write("cmi.progress_measure",JSON.stringify(a(o))),null!=this.scaled_passing_score?(r>=this.scaled_passing_score||0===this.totalScore)&&c?(this.write("cmi.success_status","passed"),this.write("cmi.completion_status","completed")):i+t===this.totalScore&&this.totalScore>0&&c?(this.write("cmi.success_status","failed"),this.write("cmi.completion_status","completed")):(this.write("cmi.success_status","unknown"),this.write("cmi.completion_status","incomplete")):(this.write("cmi.success_status","unknown"),i+t===this.totalScore&&this.totalScore>0&&c||0===this.totalScore&&c&&s>0?this.write("cmi.completion_status","completed"):this.write("cmi.completion_status","incomplete"))}slide(t){this.location=t,this.write("cmi.location",JSON.stringify(t))}setInteraction(t,i){this.write(`cmi.interactions.${t}.id`,i),this.write(`cmi.interactions.${t}.type`,"long-fill-in")}updateQuiz(t,i){if(this.active)switch(i.solved){case 0:i.trial>0&&this.write(`cmi.interactions.${t}.result`,"incorrect");break;case 1:this.write(`cmi.interactions.${t}.result`,"correct");break;case-1:this.write(`cmi.interactions.${t}.result`,"neutral")}}updateInteraction(t,i){var e;if(this.writeThrottled(`cmi.interactions.${t}.learner_response`,c.encodeJSON(i),300),i.score&&this.write(`cmi.interactions.${t}.weighting`,JSON.stringify(i.score)),i.submitted&&this.write(`cmi.interactions.${t}.result`,"neutral"),!(null===(e=this.scorm)||void 0===e?void 0:e.GetValue(`cmi.interactions.${t}.timestamp`))){var s=new Date,n=new Date(s.getTime()-6e4*s.getTimezoneOffset()).toISOString().slice(0,-5);this.write(`cmi.interactions.${t}.timestamp`,n)}const r=Date.now();if(r-(this.lastLatencyAt.get(t)||0)>5e3||0!==i.solved||i.submitted){const i=this.isoDuration(r-this.startMs);this.write(`cmi.interactions.${t}.latency`,i),this.lastLatencyAt.set(t,r)}}getInteraction(t){try{if(this.scorm){const i=this.scorm.GetValue(`cmi.interactions.${t}.learner_response`);if(""!==i)return c.decodeJSON(i)}}catch(t){h("getInteraction => ",t)}return null}constructor(){super(),(0,n.default)(this,"location",null),(0,n.default)(this,"inited",!1),(0,n.default)(this,"startMs",0),(0,n.default)(this,"commitTimer",null),(0,n.default)(this,"totalScore",0),(0,n.default)(this,"pendingCommit",null),(0,n.default)(this,"lastValues",{}),(0,n.default)(this,"lastLatencyAt",new Map),(0,n.default)(this,"lastWriteAt",new Map),(0,n.default)(this,"setSettings",(t=>{this.active&&this.scorm?this.write("cmi.suspend_data",JSON.stringify(t)):h('cannot write to "cmi.suspend_data"')})),this.active=!1,this.scaled_passing_score=null,this.db={quiz:[],survey:[],task:[]},this.id={quiz:[],survey:[],task:[]};const t=this.getAPI(window);if(t){l("successfully opened API"),this.scorm=t,l("loading quizzes ...");try{this.db.quiz=window.config_.quiz||[[]],l(" ... done");for(let t=0;t<this.db.quiz.length;t++)for(let i=0;i<this.db.quiz[t].length;i++)this.totalScore+=this.db.quiz[t][i].score}catch(t){h("... failed",t)}l("loading surveys ...");try{this.db.survey=window.config_.survey||[[]],l(" ... done")}catch(t){h("... failed",t)}l("loading tasks ...");try{this.db.task=window.config_.task||[[]],l(" ... done")}catch(t){h("... failed",t)}this.init()}else h("Could not find API")}}function l(...t){window.LIA.debug&&console.log("SCORM2004: ",...t)}function h(...t){window.LIA.debug&&console.log("SCORM2004: ",...t)}})),i.register("jXXgq",(function(e,s){t(e.exports,"Connector",(function(){return o}));var n=i("3MPaZ"),r=i("ayIBF");class o{hasIndex(){return!1}storage(){return new n.LiaStorage}initSettings(t,i=!1){return r.Settings.init(t,i,this.setSettings)}setSettings(t){r.Settings.update(t)}getSettings(){let t="";try{t=localStorage.getItem(r.Settings.PORT)}catch(t){console.warn("cannot write to localStorage")}let i=null;if("string"==typeof t){try{i=JSON.parse(t)}catch(t){console.warn("getSettings =>",t)}i||(i=r.Settings.data),window.innerWidth<=768&&(i.table_of_contents=!1)}return i}open(t,i,e){}load(t){}store(t){}update(t,i){}slide(t){}getIndex(){}deleteFromIndex(t){}async storeToIndex(t){}restoreFromIndex(t,i){}reset(t,i){this.initSettings(null,!0)}async getFromIndex(t){return null}async addMisc(t,i,e,s){console.log("addMisc not implemented")}async getMisc(t,i,e){console.log("getMisc not implemented")}constructor(){}}})),i.register("3MPaZ",(function(i,e){t(i.exports,"LiaStorage",(function(){return s}));class s{getItems(t=[]){"string"==typeof t&&(t=[t]);let i={};for(let e=0;e<t.length;e++){let s=localStorage.getItem(t[e]);i[t[e]]=s?JSON.parse(s):s}return i}setItems(t){this._setLocal(t)}_setLocal(t){if("object"==typeof t)for(const[i,e]of Object.entries(t))localStorage.setItem(i,JSON.stringify(e))}constructor(){}}})),i.register("5aa3i",(function(i,e){t(i.exports,"encodeJSON",(function(){return o})),t(i.exports,"decodeJSON",(function(){return c})),t(i.exports,"jsonParse",(function(){return a})),t(i.exports,"neq",(function(){return l}));const s={SingleChoice:"sc",MultipleChoice:"mc",Text:"tx",Select:"st",Matrix:"mx",Generic:"gn",error_msg:"err"},n=Object.entries(s).reduce(((t,[i,e])=>(t[e]=i,t)),{});function r(t,i){if("object"!=typeof t||null===t)return t;if(Array.isArray(t))return t.map((t=>r(t,i)));const e={};for(const[s,n]of Object.entries(t))e[i[s]||s]=r(n,i);return e}function o(t){return JSON.stringify(r(t,s))}function c(t){return r(JSON.parse(t),n)}function a(t){try{return JSON.parse(t)}catch(t){}return null}function l(t,i){return JSON.stringify(t)!=JSON.stringify(i)}}));
